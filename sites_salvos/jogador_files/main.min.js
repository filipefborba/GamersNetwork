function getPlayerReputation(e){return e+" "+(100-e)}function getReputationColor(e){return e=parseInt(e),e<51?"#550404":e<66?"#FF0300":e<71?"#EFA000":e<86?"#EBD200":"#92AA00"}function tzDate(e,a,t){var n,r;return"undefined"==typeof a&&(a=SYSTEM_DATE_PARSE),"undefined"==typeof t&&(t=SYSTEM_DATE_PARSE),"function"==typeof moment?(n="ts"==t?moment.unix(e):moment(e,t),n.isValid()?"undefined"==typeof DEFAULT_TIMEZONE?(console.error("system timezone not defined"),e):("undefined"==typeof MEMBER_TIMEZONE?(console.info("member timezone not defined, using timezone from browser"),r=60*(new Date).getTimezoneOffset()):r=MEMBER_TIMEZONE,r!=DEFAULT_TIMEZONE&&(0==DEFAULT_TIMEZONE?r>0?n=n.add(r,"seconds"):r<0&&(n=n.subtract(r*-1,"seconds")):DEFAULT_TIMEZONE>r?n=n.subtract((r-DEFAULT_TIMEZONE)*-1,"seconds"):DEFAULT_TIMEZONE<r&&(n=n.add(r-DEFAULT_TIMEZONE,"seconds"))),n.format(a)):(console.error("invalid date format"),e)):(console.error("momentjs library not loaded"),e)}function tzDateTimestamp(e,a){return tzDate(e,a,"ts")}function gcDate(e,a){document.write(tzDate(e,a))}function gcDateTimestamp(e,a){document.write(tzDate(e,a))}function applyTzDateInString(e,a){"undefined"==typeof a&&(a="%DD/%MM/%YYYY %HH:%mm:%ss");for(var t=[["DD","([0-9]{2})"],["D","([0-9]{1})"],["MM","([0-9]{2})"],["M","([0-9]{1})"],["YYYY","([0-9]{4})"],["YY","([0-9]{2})"],["HH","([0-9]{2})"],["H","([0-9]{1})"],["mm","([0-9]{2})"],["m","([0-9]{1})"],["ss","([0-9]{2})"],["s","([0-9]{1})"]],n=a,r=0;r<t.length;r++)n=n.replace("%"+t[r][0],t[r][1]);var o=e.match(new RegExp(n,"g"));if(a=a.replace(/%/g,""),o)for(var s=0;s<o.length;s++)e=e.replace(o[s],tzDate(o[s],a,a));return e}function insertDecimal(e){return(1*e).toFixed(2)}function payFriend(e,a,t){$(".close-button").click();var n=new PagarMeCheckout.Checkout({encryption_key:"ek_live_srfbBrRo8RPqRVNKDLy6haHdiR8KDh",success:function(a){a.tkn=e,a.plano=t,$.post("/assinatura/pagarAmigoAPI",a,function(e,a,t){if(e.success){"boleto"==e.forma_pagamento?($("#modal-feedback-pagamento .msg").hide(),$("#modal-feedback-pagamento .msg.amigos-boleto").show(),common.modal.abrirModal("modal-feedback-pagamento"),$(".btn-boleto").html('<a href="'+e.boleto_url+'" target="_blank" class="btn btn-primary">Imprimir boleto</a>'),$(".codigo-barras").html(e.boleto_codigo)):($("#modal-feedback-pagamento .msg").hide(),$("#modal-feedback-pagamento .msg.amigos-cartao").show(),common.modal.abrirModal("modal-feedback-pagamento"));var n={metodo_de_pagamento:e.forma_pagamento,valor:e.total,status:e.message,ip:'<?php echo $_SERVER["REMOTE_ADDR"]; ?>'};Intercom("trackEvent","assinou-premium-amigos",n)}else alert("Ocorreu um erro")},"json")}}),r={amount:a,createToken:"true",paymentMethods:"boleto, credit_card",interestRate:1,postbackUrl:"https://gamersclub.com.br/assinatura/pagarAmigoAPIpb"};n.open(r),$("#pagarme-checkout-container").find("iframe").css("z-index","999")}function addUserPic(e){if(!e.id)return e.text;if(e.avatar){var a=$('<span class="userName" data-user-avatar="'+e.avatar+'" data-user-nick="'+e.text+'" data-user-id="'+e.id+'" ><img src="'+e.avatar+'" class="userPic" /> '+e.text+"</span>");return a}return e.text}function getRandomInt(e,a){return Math.floor(Math.random()*(a-e+1))+e}window.paceOptions={ajax:!1,document:!1,eventLag:!1,restartOnRequestAfter:!1};var NotificationUI={setNotificationFor:function(e,a){0!=parseInt(a)?$(e).show().html(a):($(e).hide().html(""),$(".tournament-notification .menu-dropdown").removeClass("show"),$(".tournament-notification .icon-dropdown").removeClass("active"))},parseNotificationCounters:function(e){var a=parseInt(e.notificacoes),t=parseInt(e.msgs),n=parseInt(e.friends);"object"==typeof window.headerAppTransporter&&(headerAppTransporter.setMessages(t),headerAppTransporter.setNotifications(a)),this.setNotificationFor(".icon[data-target=notifications] .number",a),this.setNotificationFor(".icon[data-target=messages] .number",t),this.setNotificationFor(".icon[data-target=friends] .number",n);var r=a+t+n;0==parseInt(r)||isNaN(r)?0==parseInt(r)&&(document.title=pagetitle):document.title="("+r+") "+pagetitle,0!=a?($(".tournament-notification").css("display","block"),$(".no-notification").hide()):($(".tournament-notification").css("display","none"),$(".tournament-notification .menu-dropdown").removeClass("show"),$(".tournament-notification .icon-dropdown").removeClass("active"),$(".no-notification").show())},resetNotificationList:function(){$(".no-notification").hide(),$("ul.lista-notificacoes").html(""),$(".tournament-notification").css("display","none")},showNotificationSpinner:function(){$('[data-dropdown="notifications"]').find(".loader-spin").show()},hideNotificationSpinner:function(){$('[data-dropdown="notifications"]').find(".loader-spin").hide()},renderNotificationList:function(e){if(this.resetNotificationList(),this.showNotificationSpinner(),e.success){if($("li.notification-item, li.sem-notificacoes").remove(),$(".no-notification").hide(),$(".notificacoes-clearall").remove(),"0"==e.html.length)return $(".tournament-notification").css("display","none"),$(".tournament-notification .menu-dropdown").removeClass("show"),$(".tournament-notification .icon-dropdown").removeClass("active"),$(".no-notification").show(),this.hideNotificationSpinner(),!1;$.each(e.html,function(e,a){$("ul.lista-notificacoes").append(a)}),$(".notificacoes-clearall").show(),$(".tournament-notification").css("display","block")}this.hideNotificationSpinner()}},NotificationAjaxService={counters:function(){NotificationUI.parseNotificationCounters({notificacoes:"0",msgs:"0",friends:"0",total:"0"})},notifications:function(){$.getJSON("/notificacoes/detalhes",function(e,a){NotificationUI.renderNotificationList(e)})}},NotificationPollings={initCounters:function(){NotificationAjaxService.counters()}},Notifications={init:function(){pagetitle=document.title,NotificationPollings.initCounters(),$(".icon[data-target=notifications]").on("click",function(){NotificationAjaxService.notifications()})}};$(document).ready(function(){Notifications.init()}),buildDonutChart=function(e,a){var t=$(e).data("percent"),n=$(e).data("border-size")?$(e).data("border-size"):3,r=$(e).data("size");if(a){$(e).radialIndicator({barColor:{0:"#FF0300",30:"#FF0300",40:"#FF0300",50:"#F1A000",60:"#F1A000",70:"#F1A000",80:"#EBD200",100:"#92AA00"},barBgColor:"#1E2033",barWidth:n,initValue:0,radius:r,frameNum:100,frameTime:5,displayNumber:!1});var o=$(e).data("radialIndicator");void 0!=o&&o.animate(t),o=null}else $(e).radialIndicator({barColor:{0:"#FF0300",30:"#FF0300",40:"#FF0300",50:"#F1A000",60:"#F1A000",70:"#F1A000",80:"#EBD200",100:"#92AA00"},barBgColor:"#1E2033",barWidth:n,initValue:t,radius:r,frameNum:100,frameTime:5,displayNumber:!1})},initCharts=function(){$("[donut-chart]").each(function(e,a){buildDonutChart(a,$(a).data("donut-static"))})},initCharts();var createLobbyCharts=function(e){$(e).find("[donut-chart]").each(function(e,a){startLobbyChart(a)})},startLobbyChart=function(e){$(e).data("border-size")?$(e).data("border-size"):3;$(e).radialIndicator({barColor:{0:"#FF0300",30:"#FF0300",40:"#FF0300",50:"#F1A000",60:"#F1A000",70:"#F1A000",80:"#EBD200",100:"#92AA00"},barBgColor:"#1E2033",barWidth:3,initValue:$(e).data("percent"),radius:$(e).data("size"),frameNum:100,frameTime:5,displayNumber:!1})},dynamicToolTipEvents={spanTitle:!1,mouseenter:function(e){var a=this.getAttribute("title");null!=a&&""!==$.trim(a)&&dynamicToolTipEvents.spanTitle!==!1&&(a=a.split(",").join("\n"),this.setAttribute("data-tip-text",a),this.setAttribute("title",""),dynamicToolTipEvents.spanTitle.innerText=a,e.pageX>window.innerWidth-window.innerWidth/5?(dynamicToolTipEvents.spanTitle.style.right=window.innerWidth-e.pageX+"px",dynamicToolTipEvents.spanTitle.style.top=e.pageY+10+"px",dynamicToolTipEvents.spanTitle.style.left="auto"):(dynamicToolTipEvents.spanTitle.style.top=e.pageY+10+"px",dynamicToolTipEvents.spanTitle.style.left=e.pageX+20+"px",dynamicToolTipEvents.spanTitle.style.right="auto"),e.pageY>window.innerHeight-50?(dynamicToolTipEvents.spanTitle.style.top="auto",dynamicToolTipEvents.spanTitle.style.bottom=window.innerHeight-e.pageY+"px"):(dynamicToolTipEvents.spanTitle.style.bottom="auto",dynamicToolTipEvents.spanTitle.style.top=e.pageY+10+"px"),dynamicToolTipEvents.spanTitle.style.display="block")},mousemove:function(e){dynamicToolTipEvents.spanTitle!==!1&&(e.pageX>window.innerWidth-window.innerWidth/5?(dynamicToolTipEvents.spanTitle.style.right=window.innerWidth-e.pageX+"px",dynamicToolTipEvents.spanTitle.style.top=e.pageY+10+"px",dynamicToolTipEvents.spanTitle.style.left="auto"):(dynamicToolTipEvents.spanTitle.style.top=e.pageY+10+"px",dynamicToolTipEvents.spanTitle.style.left=e.pageX+20+"px",dynamicToolTipEvents.spanTitle.style.right="auto"),e.pageY>window.innerHeight-50?(dynamicToolTipEvents.spanTitle.style.top="auto",dynamicToolTipEvents.spanTitle.style.bottom=window.innerHeight-e.pageY+"px"):(dynamicToolTipEvents.spanTitle.style.bottom="auto",dynamicToolTipEvents.spanTitle.style.top=e.pageY+10+"px"))},mouseleave:function(){var e=this.getAttribute("data-tip-text");null!=e&&this.setAttribute("title",e),dynamicToolTipEvents.spanTitle.style.display="none"},forceclean:function(){var e=document.querySelectorAll(".tooltip-title");e.forEach(function(e){e.style.display="none"})}},bindToolTips=function(){$("body").on("mousemove","a[title], button[title], img[title], i[title], li:not(.select2-selection__choice)[title], abbr[title], span[title], th[title], td[title], video[title], div:not(.no-custom-tooltip)[title]",dynamicToolTipEvents.mousemove),$("body").on("mouseleave","a[title], button[title], img[title], i[title], li:not(.select2-selection__choice)[title], abbr[title], span[title], th[title], td[title], video[title], div:not(.no-custom-tooltip)[title]",dynamicToolTipEvents.mouseleave),$("body").on("click","a[title], button[title], img[title], i[title], li:not(.select2-selection__choice)[title], abbr[title], span[title], th[title], td[title], video[title], div:not(.no-custom-tooltip)[title]",dynamicToolTipEvents.mouseleave),$("body").on("mouseenter","a[title], button[title], img[title], i[title], li:not(.select2-selection__choice)[title], abbr[title], span[title], th[title], td[title], video[title], div:not(.no-custom-tooltip)[title]",dynamicToolTipEvents.mouseenter)},bindToolTipsToContainer=function(e){containers=[],Array.isArray(e)?containers=e:containers.push(e),containers.forEach(function(e){$(e).find("[title]").on(dynamicToolTipEvents)})},createToolTip=function(){var e=document.createElement("span");e.setAttribute("class","tooltip-title"),e.setAttribute("id","tooltip-span"),e.style.display="none",document.body.appendChild(e),dynamicToolTipEvents.spanTitle=e};if($(document).ready(function(){createToolTip(),bindToolTips()}),Array.prototype.contains=function(e){for(var a=this.length;a--;)if(this[a]===e)return!0;return!1},String.prototype.toSnakeCase=function(){return this?this.toLowerCase().replace(/\s+/g,"_"):""},!amigosArray2)var amigosArray2=[];chosenScript=function(e){$(".chosen").select2({tags:!0,placeholder:"Digite aqui...",width:"100%",data:e,createTag:function(e){var a=$.trim(e.term),t=/^\d+$/.test(a);return""===a||t===!1?null:{id:e.term,text:e.term,isNew:!0}},insertTag:function(e,a){e.push(a)}}).on("select2:select",function(e){var a=e.params.data.id;if($(".select2-selection__choice[title="+a+"]").addClass("user-searching"),e.params.data.isNew)$.ajax({type:"post",url:"/players/find/"+a,success:function(e){amigosArray2.push({id:parseInt(e.player.id),text:e.player.nick,selected:!0}),$(".chosen").select2("destroy"),$(".chosen").off(),$(".chosen").find("option").remove(),chosenScript(amigosArray2)},error:function(e){alert("Usuário inválido"),$(".chosen").select2("destroy"),$(".chosen").off(),$(".chosen").find("option").remove(),chosenScript(amigosArray2)}});else for(var t in amigosArray2)amigosArray2[t].id==a&&(amigosArray2[t].selected=!0)}).on("select2:unselect",function(e){var a=e.params.data.id;for(var t in amigosArray2)amigosArray2[t].id==a&&(amigosArray2[t].selected=!1)}),$(".chosen").on("change",function(){var e,a=$(this).data("plano"),t=$(this).val();e=null!==t?t.length:0,"plus"==a&&(total=insertDecimal(15.9*e),$(".total-plus .valor-total").html(total)),"premium"==a&&(total=insertDecimal(29.9*e),$(".total-premium .valor-total").html(total))})},chosenScript(amigosArray2),$(function(){$('[js-action="slowScrollDown"]').click(function(e){e.preventDefault(),$("html, body").animate({scrollTop:$($.attr(this,"href")).offset().top},500)})});var pagarAmigosOk,pagarAmigosFail;window.assinaturas={pagar:{amigo:function(e){if($("#termos-pagar-amigos-"+e).is(":checked")===!1)return alert("Você precisa concordar com os termos de uso."),!1;var a=$("#presentear-"+e).serialize();$.post("/assinatura/pagarAmigo",a,function(e,a,t){e.success?payFriend(e.token,e.total,e.plano):alert("Aconteceu um problema. Tente novamente.")},"json").fail(function(e){"undefined"==typeof e.responseJSON?(alert("Aconteceu um problema. Tente novamente."),console.error(e)):alert(e.responseJSON.message)})}}},$(function(){function e(){return $(document).scrollTop()<960}function a(){e()?$(".always-visible-toolbar").slideUp():$(".always-visible-toolbar").slideDown()}a(),$(document).scroll(function(){a()})});var mustache_helper={parse:function(e){var a=!1;window[e]&&"object"!=typeof window[e]||!(a=document.getElementById(e))?window[e]||console.error("Não foi possível renderizar",e):(window[e]=a.innerHTML,Mustache.parse(window[e]))},parseMultiple:function(e){for(var a,t=e.length,n=0;n<t;n++)window[e[n]]&&"object"!=typeof window[e[n]]||!(a=document.getElementById(e[n]))?window[e[n]]||console.error("Não foi possível renderizar",e[n]):(window[e[n]]=a.innerHTML,Mustache.parse(window[e[n]]))}};$(function(){var e={encryption_key:"ek_live_srfbBrRo8RPqRVNKDLy6haHdiR8KDh",plan:!1,plans:{1:{plan_id:1,title:"Plus",price:15.9,currency_symbol:"R$"},2:{plan_id:2,title:"Premium",price:29.9,currency_symbol:"R$"}},changing_plan:!1,payment_method:!1,hasPendingPayment:!1,update_on_close:!0,buffer:{},friends:[],saveLocal:function(e,a,t){return t===!1||this.validateForm(e)},saveLocalItem:function(e,a,t){return"card_cvv"!==a&&(this.buffer[e]||(this.buffer[e]={}),this.buffer[e][a]=t,!0)},loadStepData:function(e){"confirm"!==e&&this.buffer[e]&&$.each(this.buffer[e],function(e,a){$('#subscriptionModal [name="'+e+'"]').val(a)})},setPaymentConfig:function(e,a){return"plans"===e&&(e="plan"),this[e]=a,!0},loadUserData:function(){var e=this;this.loadDataFromAjax().done(function(a){if("undefined"!=typeof a&&a.success===!0){if(a.isWaitingPayment&&!t.forFriends)t.goToPendingPayment(a);else if("subscribe"===t.modalMethod){if(a.isActiveSubscription)return t.goToActiveSubscription(),!1;t.processing(!1)}else t.processing(!1);e.buffer=a}})},loadDataFromAjax:function(){return $.getJSON("/assinatura/loadData")},setStepData:function(e,a){switch(e){case"payment_method":case"plans":return this.setPaymentConfig(e,a);case"card_data":switch(t.language){case"pt-br":case"english":return this.pagarMeValidateCardData(e,a)}default:var n=$("#form_"+e).serialize(),r=this.saveLocal(e,n);return r!==!0?{errors:r}:$.ajax({type:"POST",dataType:"json",data:n,url:"/assinatura/saveStep/"+encodeURIComponent(e)})}},validateForm:function(a){var n=document.getElementById("form_"+a);if(!n||!n.classList)return t.logError("Não foi possível validar, formulário inexistente: #form_"+a),!1;if(n.classList.add("has-submited"),!e.validateFormCustom(n,a)){var r=e.validateFormGetErrors(n);return{name:"form",message:r}}return!0},validateFormCustom:function(a,t){switch(t){case"personal_data":case"card_data":var n=a.querySelector('input[name="document_number"]'),r=e.getOnlyNumbers(n.value);return e.validateDocumentNumber(r)?(e.validateHtml5Clear([n]),e.validateHtml5(a)):(n.setCustomValidity("CPF inválido"),!1);case"address":var o=a.querySelector('input[name="zipcode_isvalid"]'),s=a.querySelector('input[name="zipcode"]');return"false"===o.value?(s.setCustomValidity("CEP inválido"),!1):(e.validateHtml5Clear([s]),e.validateHtml5(a));default:return e.validateHtml5(a)}},validateHtml5:function(e){return!!e.checkValidity()},validateHtml5Clear:function(e){e.forEach(function(e,a){e.setCustomValidity("")})},validateDocumentNumber:function(a){return a.length>11?e.validateCnpj(a):e.validateCpf(a)},validateCpf:function(e){var a,t;if(a=0,"00000000000"==e)return!1;for(i=1;i<=9;i++)a+=parseInt(e.substring(i-1,i))*(11-i);if(t=10*a%11,10!=t&&11!=t||(t=0),t!=parseInt(e.substring(9,10)))return!1;for(a=0,i=1;i<=10;i++)a+=parseInt(e.substring(i-1,i))*(12-i);return t=10*a%11,10!=t&&11!=t||(t=0),t==parseInt(e.substring(10,11))},validateCnpj:function(e){if("00000000000000"==e||"11111111111111"==e||"22222222222222"==e||"33333333333333"==e||"44444444444444"==e||"55555555555555"==e||"66666666666666"==e||"77777777777777"==e||"88888888888888"==e||"99999999999999"==e)return!1;for(tamanho=e.length-2,numeros=e.substring(0,tamanho),digitos=e.substring(tamanho),soma=0,pos=tamanho-7,i=tamanho;i>=1;i--)soma+=numeros.charAt(tamanho-i)*pos--,pos<2&&(pos=9);if(resultado=soma%11<2?0:11-soma%11,resultado!=digitos.charAt(0))return!1;for(tamanho+=1,numeros=e.substring(0,tamanho),soma=0,pos=tamanho-7,i=tamanho;i>=1;i--)soma+=numeros.charAt(tamanho-i)*pos--,pos<2&&(pos=9);return resultado=soma%11<2?0:11-soma%11,resultado==digitos.charAt(1)},validateFormGetErrors:function(e){var a=[];return e.querySelectorAll(":invalid").forEach(function(e,t){var n=e.querySelector(".subscription-error-message");null!==n&&a.push({error_element:n,element:n.previousSibling.previousSibling,message:n.textContent})}),a},getOnlyNumbers:function(e){return e.replace(/[^0-9]/g,"")},saveCardDataToDB:function(e,a){t.loader();var n=e.errors;$.ajax({method:"POST",data:{card_holder_name:$("#subscriptionCardData [name=card_holder_name]").val(),document_number:$("#subscriptionCardData [name=document_number]").val(),email:$("#subscriptionCardData [name=email]").val(),ddd:$("#subscriptionCardData [name=ddd]").val(),number:$("#subscriptionCardData [name=number]").val()},url:"/assinatura/saveStep/card_data",fail:function(e){var a=e.responseJSON;n=n.concat(a.errors)},complete:function(){return n&&n.length>0?(t.showFormErrors(n),t.loader(!1),!1):void a.call(this)}})},pagarMeError:function(e){return t.logError("Erro ao validar cartão pagarme.validate sendo: "+e),{errors:[{name:"card_number",message:"Cartão em formato incorreto."}],card:{},promisse:null}},pagarMeValidateCardData:function(){t.loader();var e={};e.card_holder_name=$("#subscriptionModal [name=card_holder_name]").val(),e.card_expiration_date=$("#subscriptionModal [name=card_expiration_date]").val(),e.card_number=$("#subscriptionModal [name=card_number]").val(),e.card_cvv=$("#subscriptionModal [name=card_cvv]").val();var a=[],n={};try{n=pagarme.validate({card:e})}catch(r){return this.pagarMeError(r)}(!n.card.card_holder_name||e.card_holder_name.length<=2)&&a.push({name:"card_holder_name",message:"Nome obrigatório."}),n.card.card_expiration_date||a.push({name:"card_expiration_date",message:"Validade incorreta."}),n.card.card_number||a.push({name:"card_number",message:"Cartão em formato incorreto."}),n.card.card_cvv||a.push({name:"card_cvv",message:"CVV incorreto."}),n.card.brand&&this.saveLocalItem("card_data","card_brand",n.card.brand);var o=this.validateForm("card_data");return o!==!0&&a.push(o),{errors:a,card:e,promisse:pagarme.client.connect({encryption_key:this.encryption_key})}},pagarMeFetchCreditCard:function(a,n){return t.loader(),this.saveCardDataToDB(a,function(){a.promisse.then(function(r){return r.security?void r.security.encrypt(a.card).then(function(a){a?(t.loader(!1),e.saveLocalItem("card_data","card_hash",a),t.renderNextStep(n)||t.logError("Erro ao renderizar  "+n+" partindo de "+t.current_step),t.showStep(n)):(t.loader(!1),t.logError("Não foi possível obter o hash do cartão"))}):(t.loader(!1),t.logError("Erro ao recuperar promessa do Pagar.ME"),!1)})}),!1},postcodeSearch:function(a,n){$("#subscriptionAddress [name=zipcode]").addClass("zipcode-searching"),$("#subscriptionAddress [name=street]").attr("disabled",!0),$("#subscriptionAddress [name=neighborhood]").attr("disabled",!0),$("#subscriptionAddress [name=city]").attr("disabled",!0),$("#subscriptionAddress [name=state]").attr("disabled",!0);var a=void 0!==a?a:null!=e.buffer.address.zipcode?e.buffer.address.zipcode.replace(/-/g,""):"",n=void 0!==n&&n,r=e.postcodeChooseGateway(a,n);$.ajax({url:r.zipGatewayUrl,method:"GET",dataType:"json",timeout:1500}).done(function(t){if(t.erro)return e.postcodeSearch(a,!0),!1;var n={};for(var o in r.zipGatewayFields)n[o]=t[r.zipGatewayFields[o]];$("#subscriptionAddress [name=zipcode_isvalid]").val("true"),e.postcodeComplete(n)}).fail(function(n,o){"error"===o&&"pagarme"!==r.zipGatewayName&&e.postcodeSearch(a,!0),"timeout"===o&&e.postcodeSearch(a),e.postcodeReset(),$("#subscriptionAddress [name=zipcode_isvalid]").val("false"),t.logError("Impossível recuperar dados do CEP fornecido")})},postcodeChooseGateway:function(e,a){var t,n=Math.floor(2*Math.random()+1)-1,r=[{zipGatewayName:"viacep",zipGatewayUrl:"https://viacep.com.br/ws/"+e+"/json/",zipGatewayFields:{street:"logradouro",neighborhood:"bairro",city:"localidade",state:"uf"},run:0},{zipGatewayName:"postmon",zipGatewayUrl:"https://api.postmon.com.br/v1/cep/"+e,zipGatewayFields:{street:"logradouro",neighborhood:"bairro",city:"cidade",state:"estado"},run:0}],o={zipGatewayName:"pagarme",zipGatewayUrl:"https://api.pagar.me/1/zipcodes/"+e,zipGatewayFields:{street:"street",neighborhood:"neighborhood",city:"city",state:"state"},run:0};return a===!0?(t=o,t.run=o.run+1):(t=r[n],t.run=o.run+1),t},postcodeComplete:function(e){e.street&&($("#subscriptionAddress [name=street]").val(e.street),$("#subscriptionAddress [name=street_number]").focus()),e.neighborhood&&$("#subscriptionAddress [name=neighborhood]").val(e.neighborhood),e.city&&$("#subscriptionAddress [name=city]").val(e.city),e.state&&$("#subscriptionAddress [name=state]").val(e.state),$("#subscriptionAddress [name=zipcode]").removeClass("zipcode-searching"),$("#subscriptionAddress [name=street]").attr("disabled",!1).change(),$("#subscriptionAddress [name=neighborhood]").attr("disabled",!1).change(),$("#subscriptionAddress [name=city]").attr("disabled",!1).change(),$("#subscriptionAddress [name=state]").attr("disabled",!1).change()},postcodeReset:function(){$("#subscriptionAddress [name=street]").val(""),$("#subscriptionAddress [name=neighborhood]").val(""),$("#subscriptionAddress [name=city]").val(""),$("#subscriptionAddress [name=state]").val("")},getPlan:function(){var a,t="";return e.plans&&e.plan&&(a=e.plans[e.plan])&&(t=a),t}},a={renderPaymentMethods:function(){var e=Mustache.render(window[t.steps.payment_method],{canBillet:"pt-br"==t.language});return $("#subscriptionPaymentMethod").html(e),!0},renderPersonalData:function(){var e={},a=Mustache.render(window[t.steps.personal_data],e);return $("#subscriptionPersonalData").html(a),t.maskInputs(),!0},renderAddress:function(){var a={};e.payment_method&&(a.isBillet="boleto"===e.payment_method);var n=Mustache.render(window[t.steps.address],a);return $("#subscriptionAddress").html(n),t.maskInputs(),e.postcodeSearch(),!0},renderCardData:function(){var e={},a=Mustache.render(window[t.steps.card_data],e);return $("#subscriptionCardData").html(a),t.maskInputs(),!0},renderConfirm:function(){var a={buffer:e.buffer,friends:e.friends};a.buffer.plan={};var n,r,o,s=e.plan;return n=e.plans[s].price,plan_currency_symbol=e.plans[s].currency_symbol,friends_count=e.friends.length,0==friends_count&&(friends_count=1),r=(friends_count*n).toFixed(2),a.buffer.card_data.card_snippet=e.buffer.card_data.card_number.substr(0,4),a.buffer.plan.price=r,a.buffer.plan.currency_symbol=plan_currency_symbol,o=Mustache.render(window[t.steps.confirm],a),$("#subscriptionConfirm").html(o),$("#finalFriends").scrollbar(),!0},renderChangeConfirm:function(a){if(a?a.isDowngrade="isDowngrade"===a.change:(a={},a.isDowngrade=!!canDowngrade,a.current_plan=isPlus?"plus":"premium",a.new_plan=isPlus?"premium":"plus"),a.isDowngrade){var n=Mustache.render(window[t.steps.change_confirm],a);return $("#subscriptionChangeConfirm").html(n),!0}a.proportionalPrice=e.buffer.change_confirm.proportionalUpgradePrice,a.fullPrice=e.buffer.change_confirm.fullUpgradePrice;var n=Mustache.render(window[t.steps.change_confirm],a);$("#subscriptionChangeConfirm").html(n)},renderChangeSuccess:function(){var a=e.buffer.subscription_change;"upgrade"===a.change&&(a.isUpgrade=!0),t.update_on_close=!0;var n=Mustache.render(window[t.steps.change_success],a);return $("#subscriptionChangeSuccess").html(n),!0},renderBillet:function(){var a=e.getPlan();return t.processing(),e.friends.length>0?(t.generateBilletForFriends(a),!0):($.ajax({url:"/assinatura/generatePayment/billet",method:"post",data:{plan:a.plan_id},success:function(e){e.plan=a;var n=Mustache.render(window[t.steps.billet],e);t.stepTagger("finish"),t.update_on_close=!0,$("#subscriptionBillet").html(n),t.processing(!1)},error:function(e){var a=e.responseJSON;return t.showFatalError("Não foi possível gerar o boleto",a.message),!1}}),!0)},renderFatalError:function(e){var a=Mustache.render(window[t.steps.fatal_error],e);return $("#subscriptionFatalError").html(a),!0},renderRecoverableError:function(e){var a=Mustache.render(window[t.steps.recoverable_error],e);return $("#subscriptionRecoverableError").html(a),!0},renderSuccessCard:function(){var a={};a.plan_name=e.getPlan().title,"Plus"==a.plan_name&&(a.isPlus=!0),a.friends=e.friends,t.update_on_close=!0;var n=Mustache.render(window[t.steps.success],a);return $("#subscriptionSuccess").html(n),$(".subscription-play-now").click(function(e){e.preventDefault(),$(".play-now").click(),t.close()}),!0},renderFriends:function(a){var n={};e.plan=a,window.selectedFriendsPlan=a;var r=Mustache.render(window[t.steps.friends_list],n);return $("#subscriptionFriends").html(r),window.requestAnimationFrame(function(){chosenScript(amigosArray,a)}),!0},renderPlans:function(){var e={plans:[{plan_id:1},{plan_id:2}]};e.language={"pt-br":{plus:{plan_id:1,title:"Plus",canDowngrade:canDowngrade,isCurrentPlan:!!isPlus,canSubscribe:canSubscribe},premium:{plan_id:2,title:"Premium",canUpgrade:canUpgrade,isCurrentPlan:!!isPremium,canSubscribe:canSubscribe}}},e.language.english=e.language["pt-br"];var a=Mustache.render(window[t.steps.plans],e,{btn_plus:Mustache.render(subscriptionPlansBtnTemplate,e.language[t.language].plus),btn_premium:Mustache.render(subscriptionPlansBtnTemplate,e.language[t.language].premium)});return $("#subscriptionPlans").html(a),!0},renderBreadcrumb:function(e,a){var n={plan:{index:1,step:"plans",name:i18n.sub_step_one,isEnabled:!0,isActive:!1},friends_list:{index:1,step:"friends_list",name:i18n.sub_step_one_b,isEnabled:!1,isActive:!1},payment_method:{index:2,step:"payment_method",name:i18n.sub_step_two,isEnabled:!1,isActive:!1},card_data:{index:3,step:"card_data",name:i18n.sub_step_three,isEnabled:!1,isActive:!1},personal_data:{index:3,step:"personal_data",name:i18n.sub_step_three_b,isEnabled:!1,isActive:!1},address:{index:4,step:"address",name:i18n.sub_step_four,isEnabled:!1,isActive:!1},confirm:{index:5,step:"confirm",name:i18n.sub_step_five,isEnabled:!1,isActive:!1}};t.forFriends?delete n.plan:delete n.friends_list,e.isBillet?(delete n.card_data,delete n.confirm):delete n.personal_data;var r=0;n[a]&&(n[a].isActive=!0,r=n[a].index),e.steps=[],$.each(n,function(a,t){t.index<r&&(n[a].isEnabled=!0),e.steps.push(n[a])});var o=Mustache.render(subscriptionModalBreadcrumbTemplate,e);return $("#subscriptionModalBreadcrumb").html(o),!0}},t={language:"pt-br",container:null,current_step:null,update_on_close:!1,modalMethod:"",steps:{plans:"subscriptionPlansTemplate",friends_list:"subscriptionFriendsListTemplate",payment_method:"subscriptionPaymentMethodTemplate",personal_data:"subscriptionPersonalDataTemplate",address:"subscriptionAddressTemplate",card_data:"subscriptionCardDataTemplate",confirm:"subscriptionConfirmTemplate",billet:"subscriptionBilletTemplate",fatal_error:"subscriptionFatalErrorTemplate",recoverable_error:"subscriptionRecoverableErrorTemplate",success:"subscriptionSuccessTemplate",change_confirm:"subscriptionChangeConfirmTemplate",change_success:"subscriptionChangeSuccessTemplate"},templates:["subscriptionPlansTemplate","subscriptionPlansBtnTemplate","subscriptionFriendsListTemplate","subscriptionPaymentMethodTemplate","subscriptionPersonalDataTemplate","subscriptionAddressTemplate","subscriptionCardDataTemplate","subscriptionConfirmTemplate","subscriptionBilletTemplate","subscriptionFatalErrorTemplate","subscriptionRecoverableErrorTemplate","subscriptionSuccessTemplate","subscriptionModalBreadcrumbTemplate","subscriptionChangeConfirmTemplate","subscriptionChangeSuccessTemplate"],init:function(n,r,o,s){var i=this;o?this.forFriends=!0:this.forFriends=!1,$(document).off("click","#subscriptionModal [data-jsaction=gotoStep]").on("click","#subscriptionModal [data-jsaction=gotoStep]",function(e){i.gotoStep($(this).data("target-step"),$(this).data("value"))}),$(document).off("click","#paySubscription").on("click","#paySubscription",function(e){i.paySubscription()}),$(document).off("click","#changeSubscription").on("click","#changeSubscription",function(e){i.changeSubscription()}),$(document).off("keypress","#subscriptionModal [data-jsaction=gotoStep]").on("keypress","#subscriptionModal [data-jsaction=gotoStep]",function(e){0!==e.charCode&&32!==e.keyCode||i.gotoStep($(this).data("target-step"),$(this).data("value"))}),$(document).off("click","#subscriptionModal [data-jsaction=backStep]").on("click","#subscriptionModal [data-jsaction=backStep]",function(e){i.showStep($(this).data("target-step"))}),$(document).off("click","[data-jsaction=subscriptionModalClose]").on("click","[data-jsaction=subscriptionModalClose]",function(){i.close(),t.update_on_close===!0&&window.location.reload()}),$(document).off("keyup","#zipcode").on("keyup","#zipcode",function(){var a=$(this).val().replace(/\D/g,"");8==a.length&&e.postcodeSearch(a),$("#subscriptionAddress [name=zipcode_isvalid]").val("false")}),$(document).off("focusin","#subscriptionCardCvv").on("focusin","#subscriptionCardCvv",function(){$("#subscriptionCardBack").addClass("subscription-card-back-active")}),$(document).off("focusout","#subscriptionCardCvv").on("focusout","#subscriptionCardCvv",function(){return $(this).val().length>0||void $("#subscriptionCardBack").removeClass("subscription-card-back-active")}),$(document).off("keyup","[data-jsaction=bindCardInput]").on("keyup","[data-jsaction=bindCardInput]",function(){var e=$(this).val(),a=$("#subscriptionCardData [data-card-image="+$(this).attr("name")+"]");e.length>0?a.text(e):a.text(a.data("card-placeholder"))}),$(document).off("change","#subscriptionModal input").on("change","#subscriptionModal input",function(){e.saveLocalItem(i.current_step,$(this).attr("name"),$(this).val())}),$(document).off("focusout","#subscriptionModal input").on("focusout","#subscriptionModal input",function(){$(this).val().length>0&&$(this).addClass("has-changed")}),$(document).off("submit","#subscriptionModal form").on("submit","#subscriptionModal form",function(e){return e.preventDefault(),!1}),this.container=$("#subscriptionModal"),this.processing(),mustache_helper.parseMultiple(this.templates),r?this.processing(!1):e.loadUserData(),t.modalMethod=n,a.renderFriends(s),a.renderPlans(),a.renderPaymentMethods()},open:function(a){return this.container.addClass("subscription-modal-active"),this.forFriends?this.showStep("friends_list"):a?(e.setPaymentConfig("plan",a),this.showStep("payment_method")):this.showStep("plans"),e.hasPendingPayment&&!this.forFriends?(this.showFatalError("Assinatura com pagamento pendente","Identificamos que você possúi uma assinatura com pagamento pendente, verifique em seu perfil ou e-mail as instruções para pagamento. Em caso de dúvidas, favor entrar em contato com nosso suporte pelo site."),!1):void $("body").css("overflow","hidden")},
openChangeSubscription:function(t,n,r){e.setPaymentConfig("changing_plan",!0),r.change=t,r.plan_id=n,1===n?(r.current_plan=e.plans[2].title,r.new_plan=e.plans[1].title):(r.current_plan=e.plans[1].title,r.new_plan=e.plans[2].title),a.renderChangeConfirm(r),n?(e.setPaymentConfig("plan",n),this.showStep("change_confirm")):this.showStep("plans"),e.saveLocalItem("subscription_change","current_plan",t),e.saveLocalItem("subscription_change","new_plan",r.new_plan),e.saveLocalItem("subscription_change","change",r.current_plan),$("body").css("overflow","hidden")},close:function(){this.container.removeClass("subscription-modal-active"),$("body").css("overflow","auto"),e.friends=[]},loader:function(e){return e===!1?(this.container.removeClass("subscription-modal-loading"),!0):(this.container.addClass("subscription-modal-loading"),!1)},renderNextStep:function(e){var t;switch(e){case"personal_data":t=a.renderPersonalData();break;case"address":t=a.renderAddress();break;case"card_data":t=a.renderCardData();break;case"confirm":t=a.renderConfirm();break;case"billet":t=a.renderBillet();break;case"success":t=a.renderSuccessCard();break;case"change_confirm":t=a.renderChangeConfirm();break;case"change_success":t=a.renderChangeSuccess();break;case"fatal_error":t=a.renderFatalError();break;case"recoverable_error":t=a.renderRecoverableError();break;case"friends_list":case"plans":case"payment_method":t=!0;break;default:this.logError("Etapa inexistente "+e)}return t?(this.hideStepError(),!0):(this.logError("Não foi possível ir para etapa "+e),!1)},updateBreadcrumb:function(t){var n={isBillet:"boleto"===e.payment_method};a.renderBreadcrumb(n,t)},showStep:function(a,t){this.current_step=a,t!==!0&&e.loadStepData(a),this.container.attr("data-current-step",a),this.updateBreadcrumb(a),$("#subscriptionModal .subscription-modal-step-active").removeClass("subscription-modal-step-active"),setTimeout(function(){$("#subscriptionModal [subscription-step="+a+"]").addClass("subscription-modal-step-active")},200),this.container.scrollTop(0)},showStepError:function(e){var a=document.getElementById("stepErrorMessage");return!("undefined"==typeof a||!a.classList)&&(a.innerHTML=e,a.classList.remove("hidden"),void this.loader(!1))},showFatalError:function(e,t){var n={title:e,message:t,simple:!1};"string"==typeof t&&(n.simple=!0),a.renderFatalError(n),this.showStep("fatal_error"),this.processing(!1)},showRecoverableError:function(e,t,n){var r={title:e,message:t};n&&(r.step=n),a.renderRecoverableError(r),this.showStep("recoverable_error"),this.processing(!1)},hideStepError:function(){document.getElementById("stepErrorMessage").classList.add("hidden")},showFormErrors:function(e){$.each(e,function(e,a){var t=$('#subscriptionModal [name="'+a.name+'"]');t.length>0&&t.siblings(".subscription-error-message").text(a.message).addClass("subscription-error-active")}),this.loader(!1)},processing:function(e){return e===!1?(this.container.removeClass("subscription-modal-process"),!0):(this.container.addClass("subscription-modal-process"),!1)},cardPaymentProcess:function(e){return e?(this.processing(!1),!1):($("#paySubscription").unbind("click"),this.processing(),!0)},paySubscription:function(){var n=this;this.cardPaymentProcess();var r=e.getPlan(),o=e.buffer;return e.friends.length>0?(this.paySubscriptionForFriends(o),!0):void $.ajax({url:"/assinatura/generatePayment/card",method:"post",dataType:"json",data:{plan:r.plan_id,customer:o},success:function(e){a.renderSuccessCard(),t.stepTagger("finish"),n.showStep("success",!0),n.cardPaymentProcess(!0)},error:function(e){var a=e.responseJSON;return n.cardPaymentProcess(!0),a.step?(n.showRecoverableError("Não foi possível processar o pagamento",a.message,a.step),!1):(n.showFatalError("Não foi possível processar o pagamento",a.message),!1)}})},changeSubscription:function(e){var t=this;this.processing(),$.ajax({url:"/assinatura/updateSubscription",method:"post",data:[],success:function(e){if(e.boleto){e.plan={price:e.boleto.valor};var n=Mustache.render(window[t.steps.billet],e);$("#subscriptionBillet").html(n),t.showStep("billet")}else a.renderChangeSuccess(),t.showStep("change_success");t.processing(!1)},error:function(e){var a=e.responseJSON;return t.showFatalError("Não foi possível atualizar sua assinatura",a.message),!1}})},stepTagger:function(a,t){if("undefined"==typeof dataLayer)return!1;switch(a){case"payment_method":"boleto"===t?dataLayer.push({event:"boleto_init"}):dataLayer.push({event:"cartao_init"});break;case"personal_data":case"card_data":"boleto"===e.payment_method?dataLayer.push({event:"boleto_info"}):dataLayer.push({event:"cartao_info"});break;case"address":"boleto"===e.payment_method?dataLayer.push({event:"boleto_address"}):dataLayer.push({event:"cartao_address"});break;case"finish":"boleto"===e.payment_method?dataLayer.push({event:"boleto_finish"}):dataLayer.push({event:"cartao_success"});var n=e.getPlan();1==n.plan_id?dataLayer.push({event:"purchase_plus"}):dataLayer.push({event:"purchase_premium"}),"string"==typeof subscriptionPage&&dataLayer.push({event:subscriptionPage});break;default:return!1}},gotoStep:function(a,r){if(!a&&"undefined"!=typeof a)return this.logError("Etapa não encontrada "+a),!1;this.stepTagger(this.current_step,r),$("#subscriptionModal .subscription-error-active").removeClass("subscription-error-active");var o=e.setStepData(this.current_step,r);if(o.card)return void e.pagarMeFetchCreditCard(o,a);"friends_list"==this.current_step&&(e.friends=[],$(".select2-selection__choice").each(function(a,t){friendData=$(t).find(".userName"),e.friends.push({nick:$(friendData).data("user-nick"),avatar:$(friendData).data("user-avatar"),id:$(friendData).data("user-id")})}));var s=n(o.errors);return s&&s.length>0?(t.showFormErrors(s),!1):"form"===s.name?("friends_list"==t.current_step&&$(".select2").after('<div class="subscription-error-message subscription-error-active">Nenhum amigo selecionado</div>'),!1):void("object"==typeof o&&o.done?(t.loader(),o.done(function(e){var r=n(e.errors);return r&&r.length>0?(t.showFormErrors(r),!1):(t.hideStepError(),t.loader(!1),t.renderNextStep(a)||t.logError("Erro ao renderizar  "+a+" partindo de "+t.current_step),void t.showStep(a))}).fail(function(e){var a=e.responseJSON;if(a.success===!1)return t.showStepError(a.message),!1}),o.error(function(){t.logError("Erro no servidor ao salvar dados "+a)})):o===!0?(t.renderNextStep(a)||t.logError("Erro ao renderizar  "+a+" partindo de "+t.current_step),t.showStep(a)):t.logError("Erro ao trocar etapa "+a))},logError:function(e,a){console.error("[SMODAL] "+e),a&&console.error(a)},maskInputs:function(){$("[name=ddd]").mask("000"),$("[name=number]").mask("000000000"),$("[name=card_cvv]").mask("0000"),$("[name=card_expiration_date]").mask("00/00"),$("[name=card_number]").mask("0000 0000 0000 0000 000");var e={onKeyPress:function(a,t,n,r){var o=["000.000.000-000","00.000.000/0000-00"],s=a.length>14?o[1]:o[0];$("[name=document_number]").mask(s,e)}};$("[name=document_number]").mask("000.000.000-000",e),$("[name=zipcode]").mask("00000-000")},goToPendingPayment:function(a){if(a.boleto){var t={boleto:{boleto_url:a.boleto.boleto_url,boleto_codigo:a.boleto.boleto_codigo,boleto_barcode:a.boleto.boleto_barcode,valor:a.boleto.amount},plan:{price:a.boleto.amount}},n=Mustache.render(window[this.steps.billet],t);return $("#subscriptionBillet").html(n),this.showStep("billet"),this.processing(!1),!0}e.hasPendingPayment=!0,this.showFatalError("Assinatura com pagamento pendente","Identificamos que você possúi uma assinatura com pagamento pendente, verifique em seu perfil ou e-mail as instruções para pagamento. Em caso de dúvidas, favor entrar em contato com nosso suporte pelo site.")},goToActiveSubscription:function(){return this.showFatalError("OPA! VOCÊ JÁ POSSUI UMA ASSINATURA ATIVA :)","Identificamos que você já possui uma assinatura ativa na Gamers Club. Se você não está com a sua medalha de assinante ou precisar de alguma ajuda fale com a nossa equipe.<br><br><button onclick=\"$crisp.push(['do', 'chat:open'])\" class=\"button\">Fale com o suporte</button>"),!1},generateBilletForFriends:function(a){var t=this,n=e.friends;$.ajax({url:"/assinatura/generatePayment/billet",method:"post",data:{plan:a.plan_id,friends:n},success:function(e){e.plan=a;var n=Mustache.render(window[t.steps.billet],e);t.update_on_close=!0,$("#subscriptionBillet").html(n),t.processing(!1)},error:function(e){var a=e.responseJSON;return t.showFatalError("Não foi possível gerar o boleto",a.message),!1}})},paySubscriptionForFriends:function(t){var n=this,r=e.getPlan(),o=e.friends;$.ajax({url:"/assinatura/generatePayment/card",method:"post",dataType:"json",data:{plan:r.plan_id,customer:t,friends:o},success:function(e){a.renderSuccessCard(),n.showStep("success",!0),n.cardPaymentProcess(!0)},error:function(e){var a=e.responseJSON;return n.cardPaymentProcess(!0),a.step?(n.showRecoverableError("Não foi possível processar o pagamento",a.message,a.step),!1):(n.showFatalError("Não foi possível processar o pagamento",a.message),!1)}})}};chosenScript=function(a,t){jQuery("#friends-list").select2({tags:!0,placeholder:i18n.sub_friends_click_to_see_your_friends,width:"100%",data:a,templateResult:this.addUserPic,templateSelection:this.addUserPic,createTag:function(e){var a=$.trim(e.term),t=/^\d+$/.test(a);return""===a||t===!1?null:{id:e.term,text:e.term,isNew:!0}},insertTag:function(e,a){e.push(a)}}).on("select2:select",function(e){$(".subscription-error-message").removeClass("subscription-error-active");var a=e.params.data.id;if($(".select2-selection__choice[title="+a+"]").addClass("user-searching"),e.params.data.isNew)$.ajax({type:"post",url:"/players/find/"+a,success:function(e){var a=amigosArray.filter(function(a){return a.id==e.player.id}).length;if(1==a){var t=amigosArray.map(function(e){return e.id}).indexOf(parseInt(e.player.id));amigosArray[t];amigosArray[t].selected=!0}else amigosArray.push({id:parseInt(e.player.id),text:e.player.nick,avatar:e.player.avatar,selected:!0});$("#friends-list").select2("destroy"),$("#friends-list").off(),$("#friends-list").find("option").remove(),chosenScript(amigosArray)},error:function(e){alert("Usuário inválido"),$("#friends-list").select2("destroy"),$("#friends-list").off(),$("#friends-list").find("option").remove(),chosenScript(amigosArray)}});else for(var t in amigosArray)amigosArray[t].id==a&&(amigosArray[t].selected=!0)}).on("select2:unselect",function(e){var a=e.params.data.id;for(var t in amigosArray)amigosArray[t].id==a&&(amigosArray[t].selected=!1)}),$("#friends-list").on("change",function(a){var t,n=Array.from(new Set($(this).val()));t=null!==n?n.length:0,total_currency_symbol=e.plans[selectedFriendsPlan].currency_symbol,total=(e.plans[selectedFriendsPlan].price*t*1).toFixed(2),$(".amigos-total .valor-moeda").html(total_currency_symbol),$(".amigos-total .valor-total").html(total)})};var n=function(e){if("undefined"==typeof e)return!1;if("object"==typeof e)return e;var a={};try{return a=JSON.parse(e)}catch(n){return t.logError("Impossível fazer parse json ".input),!1}},r=function(a,n,r){return!n&&isModal&&(canDowngrade||canUpgrade)?(n=canDowngrade?"isDowngrade":"isUpgrade",t.open(a),!1):"isDowngrade"===n||"isUpgrade"===n?(e.loadDataFromAjax().done(function(e){return t.container.addClass("subscription-modal-active"),e.isWaitingPayment&&!t.forFriends?(t.goToPendingPayment(e),!1):void t.openChangeSubscription(n,a,e)}),!1):(t.open(a),!0)},o=function(e,a,n,o){t.language=n,$.ajax({method:"get",data:{},url:"/assinatura/modal",success:function(o){$("#modal-assinaturas").html(o),"isDowngrade"===a||"isUpgrade"===a?t.init(a,!1,!1,e):"forFriends"==a?t.init(a,!1,!0,e):t.init(a,!1),r(e,a,n)},error:function(){t.showFatalError("Falha ao carregar modal")},complete:function(){o.attr("disabled",!1)}})},s=function(e){$(this).attr("disabled",!0);var a=e.detail.plano,t=e.detail.plano;o(a,t,"pt-br",$(this))};if(window.location.hash.match(/melhor-com-premium?/)){"undefined"!=typeof dataLayer&&(window.subscriptionPage="hash_melhor_com_premium_finalizado",dataLayer.push({event:"hash_melhor_com_premium"}));var c="premium",l="subscribe",d="pt-br";ISSUBSCRIBER&&!ISPREMIUM&&(l="isUpgrade"),o(c,l,d,$(document.createElement("div")))}$(document).on("click","[data-jsaction=subscribePlanBtn]",function(){if($(this).attr("disabled"))return!1;$(this).attr("disabled",!0);var e=$(this).data("plano"),a=$(this).data("method"),t=$(this).data("language");o(e,a,t,$(this))}),window.document.addEventListener("openSubscriptionModal",s,!1)});var payment_mustache_helper={parse:function(e){var a=!1;window[e]&&"object"!=typeof window[e]||!(a=document.getElementById(e))?window[e]||console.error("Não foi possível renderizar",e):(window[e]=a.innerHTML,Mustache.parse(window[e]))},parseMultiple:function(e){for(var a,t=e.length,n=0;n<t;n++)window[e[n]]&&"object"!=typeof window[e[n]]||!(a=document.getElementById(e[n]))?window[e[n]]||console.error("Não foi possível renderizar",e[n]):(window[e[n]]=a.innerHTML,Mustache.parse(window[e[n]]))}};$(function(){var e={players:[],payment_method:!1,plan:!1,changing_plan:!1,update_on_close:!0,plans:{1:{plan_id:1,title:"Plus",price:15.9},2:{plan_id:2,title:"Premium",price:29.9}},buffer:{},hasPendingPayment:!1,friends:[],team_id:!1,saveLocal:function(a,t,n){return n===!1||e.validateForm(a)},saveLocalItem:function(a,t,n){return"card_cvv"!==t&&(e.buffer[a]||(e.buffer[a]={}),e.buffer[a][t]=n,!0)},loadStepData:function(t){"players"!==t&&"confirm"!==t&&e.buffer[t]&&$.each(e.buffer[t],function(e,a){$('#paymentModal [name="'+e+'"]').val(a)}),"players"==t&&a.renderPlayerList()},savePaymentConfig:function(a,t){return"plans"===a&&(a="plan"),e[a]=t,!0},loadUserData:function(){e.loadDataFromAjax().done(function(a){t.processing(!1),"undefined"!=typeof a&&a.success===!0&&(e.buffer=a)})},loadDataFromAjax:function(){return $.getJSON("/assinatura/loadData")},saveData:function(a,t){switch(a){case"payment_method":case"plans":return e.savePaymentConfig(a,t);case"card_data":return e.validateCardData(a,t);default:var n=e.saveLocal(a,$("#form_"+a).serialize());return n!==!0?{errors:n}:$.ajax({type:"POST",dataType:"json",data:$("#form_"+a).serialize(),url:"/assinatura/saveStep/"+encodeURIComponent(a)})}},validateForm:function(e){var a=document.getElementById("form_"+e);return a&&a.classList?(a.classList.add("has-submited"),!!a.checkValidity()||{name:"form",message:"Erro no html5."}):(t.logError("Formulário para validar inexistente: #form_"+e),!1)},pagarmeError:function(e){return t.logError("Erro ao validar cartão pagarme.validate sendo: "+e),{errors:[{name:"card_number",message:"Cartão em formato incorreto."}],card:{},promisse:null}},validateCardData:function(){t.loader();var a={};a.card_holder_name=$("#paymentModal [name=card_holder_name]").val(),a.card_expiration_date=$("#paymentModal [name=card_expiration_date]").val(),a.card_number=$("#paymentModal [name=card_number]").val(),a.card_cvv=$("#paymentModal [name=card_cvv]").val();var n=[],r={};try{r=pagarme.validate({card:a})}catch(o){return e.pagarmeError(o)}(!r.card.card_holder_name||a.card_holder_name.length<=2)&&n.push({name:"card_holder_name",message:"Nome obrigatório."}),r.card.card_expiration_date||n.push({name:"card_expiration_date",message:"Validade incorreta."}),r.card.card_number||n.push({name:"card_number",message:"Cartão em formato incorreto."}),r.card.card_cvv||n.push({name:"card_cvv",message:"CVV incorreto."}),r.card.brand&&e.saveLocalItem("card_data","card_brand",r.card.brand);var s=e.validateForm("card_data");return s!==!0&&n.push(s),{errors:n,card:a,promisse:pagarme.client.connect({encryption_key:"ek_live_srfbBrRo8RPqRVNKDLy6haHdiR8KDh"})}},postcodeSearch:function(a){$("#paymentAddress [name=zipcode]").addClass("zipcode-searching"),$("#paymentAddress [name=street]").attr("disabled",!0),$("#paymentAddress [name=neighborhood]").attr("disabled",!0),$("#paymentAddress [name=city]").attr("disabled",!0),$("#paymentAddress [name=state]").attr("disabled",!0),$.getJSON("https://api.postmon.com.br/v1/cep/"+a).done(function(a){var t={};a.logradouro&&(t.street=a.logradouro),a.bairro&&(t.neighborhood=a.bairro),a.cidade&&(t.city=a.cidade),a.estado&&(t.state=a.estado),e.postcodeComplete(t)}).fail(function(n){t.logError("Impossível recuperar dados do endereço via postmon, tentando via pagar.me."),$.getJSON("https://api.pagar.me/1/zipcodes/"+a).done(function(a){e.postcodeComplete(a)}).error(function(a){t.logError("Impossível recuperar dados do endereço via postmon"),e.postcodeComplete({})})})},postcodeComplete:function(e){e.street&&($("#paymentAddress [name=street]").val(e.street),$("#paymentAddress [name=street_number]").focus()),e.neighborhood&&$("#paymentAddress [name=neighborhood]").val(e.neighborhood),e.city&&$("#paymentAddress [name=city]").val(e.city),e.state&&$("#paymentAddress [name=state]").val(e.state),$("#paymentAddress [name=zipcode]").removeClass("zipcode-searching"),$("#paymentAddress [name=street]").attr("disabled",!1).change(),$("#paymentAddress [name=neighborhood]").attr("disabled",!1).change(),$("#paymentAddress [name=city]").attr("disabled",!1).change(),$("#paymentAddress [name=state]").attr("disabled",!1).change()},getPlan:function(){var a,t="";return e.plans&&e.plan&&(a=e.plans[e.plan])&&(t=a),t},getUpgradePrice:function(e){return $.ajax({method:"post",dataType:"json",data:{plan_id:e},url:"/assinatura/upgradePrice"})},loadUserTeams:function(){return $.ajax("/tournamentPayment/getUserClans/")},getTeamPlayers:function(a){$.ajax("/tournamentPayment/getClanPlayers/"+a+"/"+t.tournament_id).done(function(a){e.generatePlayerList(a)})},generatePlayerList:function(a){!a||!a.players||a.players.length<=0||(e.players=a.players)},addPlayerToPlayerList:function(t,n){var r=e.players,o=r.filter(function(e,a){return e.id!=t.id});return o.push(t),e.players=o,!n&&void a.renderPlayerList()},changePlayerSelection:function(a,t){e.players.filter(function(n,r){n.id==a&&(e.players[r].selected=t)}),e.calculateTotalPrice()},getSelectedPlayers:function(){var a=e.players.filter(function(e,a){return 1==e.selected});return a},calculateTotalPrice:function(){var a=0;$.each(e.players,function(t,n){return!n.selected||void(a+=n.isSubscriber?Number(e.offer):Number(e.price))});var t=e.currencyFormat(String(a),"R$ ");return $(".unique-payment-friends-total .valor-total").text(t),t},currencyFormat:function(e,a){return a+e.toLocaleString("pt-BR")}},a={renderPaymentMethods:function(){var e={},a=Mustache.render(window[t.steps.payment_method],e);return $("#paymentPaymentMethod").html(a),!0},renderPersonalData:function(){var e={},a=Mustache.render(window[t.steps.personal_data],e);return $("#paymentPersonalData").html(a),t.maskInputs(),!0},renderAddress:function(){var a={};e.payment_method&&(a.isBillet="boleto"===e.payment_method);var n=Mustache.render(window[t.steps.address],a);return $("#paymentAddress").html(n),t.maskInputs(),!0},renderCardData:function(){var e={},a=Mustache.render(window[t.steps.card_data],e);return $("#paymentCardData").html(a),t.maskInputs(),!0},renderConfirm:function(){var a={buffer:e.buffer},n=e.getSelectedPlayers(),r=e.calculateTotalPrice();a.buffer.card_data.card_snippet=e.buffer.card_data.card_number.substr(0,4),a.buffer.price=r,a.players=n;var o=Mustache.render(window[t.steps.confirm],a);return $("#paymentConfirm").html(o),$("#finalFriends").scrollbar(),!0},renderChangeConfirm:function(a){if(a?a.isDowngrade="isDowngrade"===a.change:(a={},a.isDowngrade=!!canDowngrade),a.isDowngrade){var n=Mustache.render(window[t.steps.change_confirm],a);return $("#paymentChangeConfirm").html(n),!0}t.processing(),e.getUpgradePrice(a.plan_id).done(function(e){a.price=e.price;var n=Mustache.render(window[t.steps.change_confirm],a);return $("#paymentChangeConfirm").html(n),t.processing(!1),!0}).fail(function(e){var a=e.responseJSON;t.processing(!1),t.logError("erro ao carregar valor do upgrade"),t.showFatalError("Erro ao recuperar dados do upgrade",a.message)})},renderChangeSuccess:function(){var a=e.buffer.payment_change;"upgrade"===a.change&&(a.isUpgrade=!0),t.update_on_close=!0;var n=Mustache.render(window[t.steps.change_success],a);return $("#paymentChangeSuccess").html(n),!0},renderBillet:function(){t.processing();var a=e.getSelectedPlayers();return $.ajax({url:"/TournamentPayment/generatePayment/billet",method:"post",data:{tournament_id:t.tournament_id,players:a,team_id:e.team_id},success:function(e){e.players=[],a&&(e.players=a);var n=Mustache.render(window[t.steps.billet],e);"undefined"!=typeof dataLayer&&(dataLayer.push({event:"pgtoBoletoCamp"}),"string"==typeof subscriptionPage&&dataLayer.push({event:subscriptionPage})),t.update_on_close=!0,$("#paymentBillet").html(n),t.processing(!1)},error:function(a){if(e.getSelectedPlayers().length<1)return t.showRecoverableError("Impossível gerar boleto","Escolha pelo menos um player para pagar.","players","Selecionar jogadores"),t.processing(!1),!0;var n=a.responseJSON;return t.showFatalError("Não foi possível gerar o boleto",n.message),!1}}),!0},renderFatalError:function(e){var a=Mustache.render(window[t.steps.fatal_error],e);return $("#paymentFatalError").html(a),!0},renderRecoverableError:function(e){var a=Mustache.render(window[t.steps.recoverable_error],e);return $("#paymentRecoverableError").html(a),!0},renderSelectTeam:function(a){a||(a={}),a.hasTournamentMedal=currentPlayerItem.hasTournamentMedal;var n=Mustache.render(window[t.steps.select_team],a);return $("#paymentSelectTeam").html(n),window.requestAnimationFrame(function(){$("#paymentTeamSelect").html(""),e.loadUserTeams().done(function(e){$("#paymentTeamSelect").append("<option>Selecionar time</option>"),e&&e.teams?$.each(e.teams,function(e,a){$("#paymentTeamSelect").append('<option value="'+a.id+'">'+a.name+"</option>")}):alert(e.message)}).fail(function(){alert("Não foi possível buscar times.")})}),!0},renderPlayers:function(e){var n=Mustache.render(window[t.steps.players],e);return $("#paymentPlayers").html(n),window.requestAnimationFrame(function(){a.renderPlayerList(),chosenPaymentScript(amigosArray)}),!0},renderSuccessCard:function(){var a={};a.plan_name=e.getPlan().title,"undefined"!=typeof dataLayer&&(dataLayer.push({event:"pgtoCartaoCamp"}),"string"==typeof subscriptionPage&&dataLayer.push({event:subscriptionPage})),a.players=e.getSelectedPlayers(),a.tournamentID=tournamentID,t.update_on_close=!0;var n=Mustache.render(window[t.steps.success],a);return $("#paymentSuccess").html(n),!0},renderBreadcrumb:function(e,a){var n={select_team:{index:1,step:"select_team",name:"Time",isEnabled:!0,isActive:!1},players:{index:2,step:"players",name:"Jogadores",isEnabled:!1,isActive:!1},payment_method:{index:3,step:"payment_method",name:"Método de pagamento",isEnabled:!1,isActive:!1},card_data:{index:4,step:"card_data",name:"Dados do cartão",isEnabled:!1,isActive:!1},personal_data:{index:5,step:"personal_data",name:"Dados pessoais",isEnabled:!1,isActive:!1},address:{index:6,step:"address",name:"Endereço",isEnabled:!1,isActive:!1},confirm:{index:7,step:"confirm",name:"Resumo",isEnabled:!1,isActive:!1}};e.isBillet?(delete n.card_data,delete n.confirm):delete n.personal_data,"undefined"!=typeof paymentModalModifiers.exclude_steps&&(n=t.filterSteps(paymentModalModifiers.exclude_steps,n));var r=0;n[a]&&(n[a].isActive=!0,r=n[a].index),e.steps=[],$.each(n,function(a,t){t.index<r&&(n[a].isEnabled=!0),e.steps.push(n[a])});var o=Mustache.render(paymentModalBreadcrumbTemplate,e);return $("#paymentModalBreadcrumb").html(o),!0},renderStaticItens:function(){a.renderPaymentMethods(),a.renderSelectTeam(),a.renderPlayers()},renderPlayerList:function(){payment_mustache_helper.parse("paymentPlayerTemplate"),$("#paymentUserList").html(""),!e.players||e.players.length<1?(players=[],0==currentPlayerItem.hasTournamentMedal&&(players=[currentPlayerItem]),e.players=players):players=e.players,$.each(players,function(e,a){0==a.isSubscriber&&(a.isSubscriber=!1),0==a.hasTournamentMedal&&(a.hasTournamentMedal=!1);var t=Mustache.render(paymentPlayerTemplate,a);$("#paymentUserList").append(t)}),e.calculateTotalPrice()}},t={container:null,current_step:null,update_on_close:!0,steps:{payment_method:"paymentPaymentMethodTemplate",personal_data:"paymentPersonalDataTemplate",address:"paymentAddressTemplate",card_data:"paymentCardDataTemplate",confirm:"paymentConfirmTemplate",billet:"paymentBilletTemplate",fatal_error:"paymentFatalErrorTemplate",recoverable_error:"paymentRecoverableErrorTemplate",success:"paymentSuccessTemplate",change_confirm:"paymentChangeConfirmTemplate",change_success:"paymentChangeSuccessTemplate",select_team:"paymentSelectTeamTemplate",players:"paymentPlayersTemplate"},templates:["paymentPaymentMethodTemplate","paymentPersonalDataTemplate","paymentAddressTemplate","paymentCardDataTemplate","paymentConfirmTemplate","paymentBilletTemplate","paymentFatalErrorTemplate","paymentRecoverableErrorTemplate","paymentSuccessTemplate","paymentModalBreadcrumbTemplate","paymentChangeConfirmTemplate","paymentChangeSuccessTemplate","paymentSelectTeamTemplate","paymentPlayersTemplate"],init:function(){$(document).off("click","#paymentModal [data-jsaction=gotoStep]").on("click","#paymentModal [data-jsaction=gotoStep]",function(e){t.gotoStep($(this).data("target-step"),$(this).data("value"))}),$(document).off("click","#paypayment").on("click","#paypayment",function(e){t.paypayment()}),$(document).off("click","#changepayment").on("click","#changepayment",function(e){t.changepayment()}),$(document).off("keypress","#paymentModal [data-jsaction=gotoStep]").on("keypress","#paymentModal [data-jsaction=gotoStep]",function(e){0!==e.charCode&&32!==e.keyCode||t.gotoStep($(this).data("target-step"),$(this).data("value"))}),$(document).off("click","#paymentModal [data-jsaction=backStep]").on("click","#paymentModal [data-jsaction=backStep]",function(e){t.showStep($(this).data("target-step"))}),$(document).off("click","[data-jsaction=paymentModalClose]").on("click","[data-jsaction=paymentModalClose]",function(){t.close(),t.update_on_close===!0&&window.location.reload()}),$(document).off("change","#zipcode").on("change","#zipcode",function(){var a=$(this).val().replace(/\D/g,"");8==a.length&&e.postcodeSearch(a)}),$(document).off("focusin","#paymentCardCvv").on("focusin","#paymentCardCvv",function(){$("#paymentCardBack").addClass("subscription-card-back-active")}),$(document).off("focusout","#paymentCardCvv").on("focusout","#paymentCardCvv",function(){return $(this).val().length>0||void $("#paymentCardBack").removeClass("subscription-card-back-active")}),$(document).off("keyup","[data-jsaction=bindCardInput]").on("keyup","[data-jsaction=bindCardInput]",function(){var e=$(this).val(),a=$("#paymentCardData [data-card-image="+$(this).attr("name")+"]");e.length>0?a.text(e):a.text(a.data("card-placeholder"))}),$(document).off("change","#paymentModal input").on("change","#paymentModal input",function(){e.saveLocalItem(t.current_step,$(this).attr("name"),$(this).val())}),$(document).off("focusout","#paymentModal input").on("focusout","#paymentModal input",function(){$(this).val().length>0&&$(this).addClass("has-changed")}),$(document).off("submit","#paymentModal form").on("submit","#paymentModal form",function(e){return e.preventDefault(),!1}),$(document).off("change","#paymentTeamSelect").on("change","#paymentTeamSelect",function(a){var t=$(this).val();return t>0&&(e.getTeamPlayers(t),e.team_id=t),!1}),$(document).off("click","[data-jsaction=paymentModalType]").on("click","[data-jsaction=paymentModalType]",function(e){$(this).data("modal-type");$("#paymentModalMethodSelector").removeClass("payment-method-item-active"),$("#paymentModalTeamSelector").addClass("payment-method-item-active")}),$(document).off("change",'[name="player[]"]').on("change",'[name="player[]"]',function(){e.changePlayerSelection($(this).val(),$(this).prop("checked"))}),t.container=$("#paymentModal"),t.tournament_id=tournamentID,e.price=tournamentPrice,e.offer=tournamentOffer,t.processing(),payment_mustache_helper.parseMultiple(t.templates),a.renderStaticItens(),e.loadUserData()},filterSteps:function(e,a){if(e.length<1)return a;t.processing();for(var n=Object.keys(e).length,r=0;r<n;r++){var o=e[r];delete a[o]}t.processing(!1)},open:function(a,n){if(t.container.addClass("subscription-modal-active"),!n)var n="select_team";return t.showStep(n),e.hasPendingPayment&&!t.forFriends?(t.showFatalError("Assinatura com pagamento pendente","Identificamos que você possúi uma assinatura com pagamento pendente, verifique em seu perfil ou e-mail as instruções para pagamento. Em caso de dúvidas, favor entrar em contato com nosso suporte pelo site."),!1):void $("body").css("overflow","hidden")},openChangepayment:function(n,r,o){e.savePaymentConfig("changing_plan",!0),o.change=n,o.plan_id=r,1===r?(o.current_plan=e.plans[2].title,o.new_plan=e.plans[1].title):(o.current_plan=e.plans[1].title,o.new_plan=e.plans[2].title),a.renderChangeConfirm(o),r?(e.savePaymentConfig("plan",r),t.showStep("change_confirm")):t.showStep("plans"),e.saveLocalItem("payment_change","current_plan",n),e.saveLocalItem("payment_change","new_plan",o.new_plan),e.saveLocalItem("payment_change","change",o.current_plan),$("body").css("overflow","hidden")},close:function(){t.container.removeClass("subscription-modal-active"),$("body").css("overflow","auto"),e.friends=[]},loader:function(e){return e===!1?(t.container.removeClass("subscription-modal-loading"),!0):(t.container.addClass("subscription-modal-loading"),!1)},renderNextStep:function(e){var n;switch(e){case"personal_data":n=a.renderPersonalData();break;case"address":n=a.renderAddress();break;case"card_data":n=a.renderCardData();break;case"confirm":n=a.renderConfirm();break;case"billet":n=a.renderBillet();break;case"success":n=a.renderSuccessCard();break;case"change_confirm":n=a.renderChangeConfirm();break;case"change_success":n=a.renderChangeSuccess();break;case"fatal_error":n=a.renderFatalError();break;case"recoverable_error":n=a.renderRecoverableError();break;case"select_team":n=a.renderSelectTeam();break;case"players":n=a.renderPlayers();break;case"friends_list":case"plans":case"payment_method":n=!0;break;default:t.logError("Etapa inexistente "+e)}return n?(t.hideStepError(),!0):(t.logError("Não foi possível ir para etapa "+e),!1)},updateBreadcrumb:function(t){var n={isBillet:"boleto"===e.payment_method};a.renderBreadcrumb(n,t)},showStep:function(a,n){t.current_step=a,n!==!0&&e.loadStepData(a),t.container.attr("data-current-step",a),t.updateBreadcrumb(a);var r=$("#paymentModal [payment-step="+a+"]");$("#paymentModal .subscription-modal-step-active").removeClass("subscription-modal-step-active"),r.addClass("subscription-modal-step-active"),t.container.scrollTop(0)},showStepError:function(e){var a=document.getElementById("stepErrorMessage");return!("undefined"==typeof a||!a.classList)&&(a.innerHTML=e,a.classList.remove("hidden"),void t.loader(!1))},showFatalError:function(e,n){var r={title:e,message:n};a.renderFatalError(r),t.showStep("fatal_error"),t.processing(!1)},showRecoverableError:function(e,n,r,o){var s={title:e,message:n};r&&(s.step=r),o?s.step_text=o:s.step_text="Editar informações do cartão",a.renderRecoverableError(s),t.showStep("recoverable_error"),t.processing(!1)},hideStepError:function(){document.getElementById("stepErrorMessage").classList.add("hidden")},showErrors:function(e){$.each(e,function(e,a){var t=$('#paymentModal [name="'+a.name+'"]');t.length>0&&t.siblings(".subscription-error-message").text(a.message).addClass("subscription-error-active")}),t.loader(!1)},gotoCreditCard:function(a,n){t.loader();var r=a.errors;return $.ajax({method:"POST",data:{card_holder_name:$("#paymentCardData [name=card_holder_name]").val(),document_number:$("#paymentCardData [name=document_number]").val(),email:$("#paymentCardData [name=email]").val(),ddd:$("#paymentCardData [name=ddd]").val(),number:$("#paymentCardData [name=number]").val()},url:"/assinatura/saveStep/card_data",fail:function(e){var a=e.responseJSON;r=r.concat(a.errors)},complete:function(){return r&&r.length>0?(t.showErrors(r),t.loader(!1),
!1):void a.promisse.then(function(r){return r.security?void r.security.encrypt(a.card).then(function(a){a?(t.loader(!1),e.saveLocalItem("card_data","card_hash",a),t.renderNextStep(n)||t.logError("Erro ao renderizar  "+n+" partindo de "+t.current_step),t.showStep(n)):(t.loader(!1),t.logError("Não foi possível criptografar cartão"))}):(t.loader(!1),t.logError("Erro ao recuperar promessa do pagarme"),!1)})}}),!1},processing:function(e){return e===!1?(t.container.removeClass("subscription-modal-process"),!0):(t.container.addClass("subscription-modal-process"),!1)},cardPaymentProcess:function(e){return e?(t.processing(!1),!1):($("#paypayment").unbind("click"),t.processing(),!0)},paypayment:function(){t.cardPaymentProcess();var n=(e.getPlan(),e.buffer);if(e.friends.length>0)return console.log("pagando para amigos..."),t.paypaymentForFriends(n),!0;var r=e.getSelectedPlayers();$.ajax({url:"/TournamentPayment/generatePayment/card",method:"post",dataType:"json",data:{tournament_id:t.tournament_id,players:r,customer:n,team_id:e.team_id},success:function(e){a.renderSuccessCard(),t.showStep("success",!0),t.cardPaymentProcess(!0)},error:function(e){var a=e.responseJSON;return t.cardPaymentProcess(!0),a.step?(t.showRecoverableError("Não foi possível processar o pagamento",a.message,a.step),!1):(t.showFatalError("Não foi possível processar o pagamento",a.message),!1)}})},changepayment:function(e){t.processing(),$.ajax({url:"/assinatura/updatepayment",method:"post",data:[],success:function(e){if(e.boleto){e.plan={price:e.boleto.valor};var n=Mustache.render(window[t.steps.billet],e);$("#paymentBillet").html(n),t.showStep("billet")}else a.renderChangeSuccess(),t.showStep("change_success");t.processing(!1)},error:function(e){var a=e.responseJSON;return t.showFatalError("Não foi possível atualizar sua assinatura",a.message),!1}})},gotoStep:function(a,n){if(!a&&"undefined"!=typeof a)return t.logError("Etapa não encontrada "+a),!1;$("#paymentModal .subscription-error-active").removeClass("subscription-error-active");var r=e.saveData(t.current_step,n);if(r.card)return t.gotoCreditCard(r,a),!1;var o=paymentConvertJSON(r.errors);if(o&&o.length>0)return t.showErrors(o),!1;if("form"===o.name)return"friends_list"==t.current_step&&$(".select2").after('<div class="subscription-error-message subscription-error-active">Nenhum amigo selecionado</div>'),!1;if("players"==t.current_step){var s=e.getSelectedPlayers();if(s.length<1)return $(".unique-payment-players-error").addClass("subscription-error-active"),!1;$(".unique-payment-players-error").removeClass("subscription-error-active")}"object"==typeof r&&r.done?(t.processing(),r.done(function(e){var n=paymentConvertJSON(e.errors);return n&&n.length>0?(t.showErrors(n),!1):(t.hideStepError(),t.processing(!1),t.renderNextStep(a)||t.logError("Erro ao renderizar  "+a+" partindo de "+t.current_step),void t.showStep(a))}).fail(function(e){var a=e.responseJSON;if(t.processing(!1),a.success===!1)return t.showStepError(a.message),!1}),r.error(function(){t.logError("Erro no servidor ao salvar dados "+a)})):r===!0?(t.renderNextStep(a)||t.logError("Erro ao renderizar  "+a+" partindo de "+t.current_step),t.showStep(a)):t.logError("Erro ao trocar etapa "+a)},logError:function(e,a){console.error("[SMODAL] "+e),a&&console.error(a)},maskInputs:function(){$("[name=zipcode]").mask("00000-000"),$("[name=ddd]").mask("000"),$("[name=number]").mask("000000000"),$("[name=card_cvv]").mask("0000"),$("[name=card_expiration_date]").mask("00/00"),$("[name=card_number]").mask("0000 0000 0000 0000 000");var e={onKeyPress:function(e,a,t,n){var r=["000.000.000-000","00.000.000/0000-00"],o=e.length>14?r[1]:r[0];t.mask(o,n)}};$("[name=document_number]").mask("000.000.000-000",e)},loadDataFromAjax:function(){return e.loadDataFromAjax()},goToPendingPayment:function(a){if(a.boleto){var n={boleto:{boleto_url:a.boleto.boleto_url,boleto_codigo:a.boleto.boleto_codigo,boleto_barcode:a.boleto.boleto_barcode,valor:a.boleto.amount},plan:{price:a.boleto.amount}},r=Mustache.render(window[t.steps.billet],n);return $("#paymentBillet").html(r),t.showStep("billet"),t.processing(!1),!0}e.hasPendingPayment=!0,t.showFatalError("Assinatura com pagamento pendente","Identificamos que você possúi uma assinatura com pagamento pendente, verifique em seu perfil ou e-mail as instruções para pagamento. Em caso de dúvidas, favor entrar em contato com nosso suporte pelo site.")},paypaymentForFriends:function(n){var r=e.getPlan(),o=e.friends;$.ajax({url:"/assinatura/generatePayment/card",method:"post",dataType:"json",data:{plan:r.plan_id,customer:n,friends:o},success:function(e){a.renderSuccessCard(),t.showStep("success",!0),t.cardPaymentProcess(!0)},error:function(e){var a=e.responseJSON;return t.cardPaymentProcess(!0),a.step?(t.showRecoverableError("Não foi possível processar o pagamento",a.message,a.step),!1):(t.showFatalError("Não foi possível processar o pagamento",a.message),!1)}})},addPlayerToPlayerList:function(a){e.addPlayerToPlayerList(a)}};window.paymentModal=t});var paymentConvertJSON=function(e){if("undefined"==typeof e)return!1;if("object"==typeof e)return e;var a={};try{return a=JSON.parse(e)}catch(t){return paymentModal.logError("Impossível parsear json ".input),!1}},loadPaymentModalHtmlAndInit=function(e,a,t){t||(t={}),window.paymentModalModifiers=t,$.ajax({method:"get",url:"/tournamentPayment/modal/"+e,success:function(e){$("#modal-assinaturas").html(e),paymentModal.init(),openPaymentModal()},error:function(){paymentModal.showFatalError("Falha ao carregar modal")},complete:function(){a.attr("disabled",!1)}})},openPaymentModal=function(e,a){paymentModalModifiers.jump_to?paymentModal.open(e,paymentModalModifiers.jump_to):paymentModal.open(e)};window.openTournamentModal=function(e){if($(this).attr("disabled"))return!1;$(this).attr("disabled",!0);var a=$(this).data("tournament");$(this).data("tournament")||(a=e.tournament_id);var t=$(this).data("player");t?$.ajax({type:"post",url:"/TournamentPayment/searchPlayers/"+t+"/"+a,success:function(e){if(e.player){payment_data.addPlayerToPlayerList(e.player,!0);var t={exclude_steps:["select_team","players"],jump_to:"payment_method"};loadPaymentModalHtmlAndInit(a,$(this),t)}},fail:function(e){alert("Erro ao selecionar player"),console.error(e)}}):loadPaymentModalHtmlAndInit(a,$(this))},$(function(){function e(e){$(this).attr("disabled",!0);e.detail.plano,e.detail.plano;paymentModal.container?openPaymentModal(tournament):loadPaymentModalHtmlAndInit(tournament,$(this))}$(document).on("click","[data-jsaction=payPlanBtn]",openTournamentModal),window.document.addEventListener("openpaymentModal",e,!1)});var chosenPaymentScript=function(){jQuery("#tournament-friends-list").select2({tags:!0,placeholder:"Busque pelo ID do jogador",width:"100%",data:[],templateResult:addUserPic,templateSelection:addUserPic,createTag:function(e){var a=$.trim(e.term),t=/^\d+$/.test(a);return""===a||t===!1?null:{id:e.term,text:e.term,isNew:!0}},insertTag:function(e,a){e.push(a)}}).on("select2:select",function(e){$(".subscription-error-message").removeClass("subscription-error-active");var a=e.params.data.id;if($(".select2-selection__choice[title="+a+"]").addClass("user-searching"),e.params.data.isNew)$.ajax({type:"post",url:"/TournamentPayment/searchPlayers/"+a+"/"+paymentModal.tournament_id,success:function(e){e.player&&paymentModal.addPlayerToPlayerList(e.player),$("#tournament-friends-list").select2("destroy"),$("#tournament-friends-list").off(),$("#tournament-friends-list").find("option").remove(),chosenPaymentScript(amigosArray)},error:function(e){alert("Usuário inválido"),$("#tournament-friends-list").select2("destroy"),$("#tournament-friends-list").off(),$("#tournament-friends-list").find("option").remove(),chosenPaymentScript(amigosArray)}});else for(var t in amigosArray)amigosArray[t].id==a&&(amigosArray[t].selected=!0)}).on("select2:unselect",function(e){var a=e.params.data.id;for(var t in amigosArray)amigosArray[t].id==a&&(amigosArray[t].selected=!1)}),$("#tournament-friends-list").on("change",function(){var e,a=$(this).val();e=null!==a?a.length:0})};$(function(){var e={parse:function(e){var a=!1;window[e]&&"object"!=typeof window[e]||!(a=document.getElementById(e))?window[e]||console.error("Não foi possível renderizar",e):(window[e]=a.innerHTML,Mustache.parse(window[e]))},parseMultiple:function(e){for(var a,t=e.length,n=0;n<t;n++)window[e[n]]&&"object"!=typeof window[e[n]]||!(a=document.getElementById(e[n]))?window[e[n]]||console.error("Não foi possível renderizar",e[n]):(window[e[n]]=a.innerHTML,Mustache.parse(window[e[n]]))}},a={self:{1:"personal_30",2:"personal_60",3:"personal_90",4:"team_30",5:"team_60",6:"team_90",7:"position_30",8:"position_60",9:"position_90"},friends:{1:"friend_personal_30",2:"friend_personal_60",3:"friend_personal_90"}},t=function(e,t,n){if(a.hasOwnProperty(t)&&a[t].hasOwnProperty(e)){var n="undefined"!=typeof n?n+"_":"";dataLayer.push({event:"discover_"+n+a[t][e]})}},n=function(e,t,n){if(a.hasOwnProperty(t)&&a[t].hasOwnProperty(e)){var n="billet"===n?"_boleto":"_credit_card";dataLayer.push({event:"discover_"+a[t][e]+n})}},r={pagarMeToken:"ek_live_srfbBrRo8RPqRVNKDLy6haHdiR8KDh",paymentMethod:null,paymentType:null,paymentClientMeta:{},hasPendingPayment:!1,forFriends:!1,friends:[],buffer:{},saveLocal:function(e,a,t){return t===!1||this.validateForm(e)},saveLocalItem:function(e,a,t){return"card_cvv"!==a&&(this.buffer[e]||(this.buffer[e]={}),this.buffer[e][a]=t,!0)},loadStepData:function(e){var a=this.buffer.hasOwnProperty(e);"confirm"!==e&&a&&$.each(this.buffer[e],function(a,t){$('#gcPaymentsModal [name="'+a+'"]').val(t),"card_data"===e&&"card_holder_name"===a&&$('#gcPaymentsModal [name="'+a+'"]').trigger("keyup")})},loadBillingInfo:function(){var e,a=this;$.getJSON("/payments/billing-info").done(function(t){"undefined"!=typeof t&&t.success===!0&&(r.forFriends||(e=r.paymentClientMeta.paymentItem.id,t.isWaitingPayment&&Object.keys(t.billet).length>0&&e==t.billet.billetItem?s.goToPendingPaymentBillet(t):Object.keys(t.card).length>0&&e==t.card.cardItem&&s.showFatalError("Você já pagou por este item","Identificamos que você já solicitou este item e efetuou o pagamento do mesmo, aguarde alguns instantes que estará disponível na sua conta. Caso isso não aconteça, entre em contato com nosso suporte.")),s.processing(!1),a.buffer=t)})},loadPaymentClientMeta:function(e){r.paymentClientMeta=e,$.ajax({type:"POST",url:"/payments/payment-item",data:{paymentItem:e.paymentItem},dataType:"json"}).done(function(e){e.success&&(r.paymentClientMeta.paymentItem=e.paymentItem,r.loadBillingInfo())}).fail(function(){s.showFatalError("Item para Pagamento Inválido!","Não foi possível carregar o item que você está tentando pagar")})},setStepData:function(e,a){switch(e){case"payment_method":return this.paymentType=a,!0;case"card_data":switch(s.language){case"pt-br":case"english":return this.pagarMeValidateCardData(e,a)}default:var t=this.saveLocal(e,$("#form_"+e).serialize());return t!==!0?{errors:t}:$.ajax({type:"POST",dataType:"json",data:$("#form_"+e).serialize(),url:"/payments/modal-step/"+encodeURIComponent(e)})}},validateForm:function(e){var a=document.getElementById("form_"+e);return a&&a.classList?(a.classList.add("has-submited"),!!a.checkValidity()||{name:"form",message:"Erro no html5."}):(s.logError("Formulário para validar inexistente: #form_"+e),!1)},saveCardDataToDB:function(e,a){s.loader();var t=e.errors;$.ajax({method:"POST",data:{card_holder_name:$("#gcPaymentsCardData [name=card_holder_name]").val(),document_number:$("#gcPaymentsCardData [name=document_number]").val(),email:$("#gcPaymentsCardData [name=email]").val(),ddd:$("#gcPaymentsCardData [name=ddd]").val(),number:$("#gcPaymentsCardData [name=number]").val()},url:"/payments/modal-step/card_data",fail:function(e){var a=e.responseJSON;t=t.concat(a.errors)},complete:function(){return t&&t.length>0?(s.showFormErrors(t),s.loader(!1),!1):void a.call(this)}})},pagarMeError:function(e){return s.logError("Erro ao validar cartão Pagar.me: "+e),{errors:[{name:"card_number",message:"Cartão em formato incorreto."}],card:{},promisse:null}},pagarMeValidateCardData:function(){s.loader();var e={};e.card_holder_name=$("#gcPaymentsCardData [name=card_holder_name]").val(),e.card_expiration_date=$("#gcPaymentsCardData [name=card_expiration_date]").val(),e.card_number=$("#gcPaymentsCardData [name=card_number]").val(),e.card_cvv=$("#gcPaymentsCardData [name=card_cvv]").val();var a=[],t={};try{t=pagarme.validate({card:e})}catch(n){return this.pagarMeError(n)}(!t.card.card_holder_name||e.card_holder_name.length<=2)&&a.push({name:"card_holder_name",message:"Nome obrigatório."}),t.card.card_expiration_date||a.push({name:"card_expiration_date",message:"Validade incorreta."}),t.card.card_number||a.push({name:"card_number",message:"Cartão em formato incorreto."}),t.card.card_cvv||a.push({name:"card_cvv",message:"CVV incorreto."}),t.card.brand&&this.saveLocalItem("card_data","card_brand",t.card.brand);var r=this.validateForm("card_data");return r!==!0&&a.push(r),{errors:a,card:e,promisse:pagarme.client.connect({encryption_key:this.pagarMeToken})}},pagarMeFetchCreditCard:function(e,a){return s.loader(),this.saveCardDataToDB(e,function(){e.promisse.then(function(t){return t.security?void t.security.encrypt(e.card).then(function(e){e?(s.loader(!1),r.saveLocalItem("card_data","card_hash",e),s.renderNextStep(a)||s.logError("Erro ao renderizar  "+a+" partindo de "+s.currentStep),s.showStep(a)):(s.loader(!1),s.logError("Não foi possível obter o hash do cartão"))}):(s.loader(!1),s.logError("Erro ao recuperar promessa do Pagar.me"),!1)})}),!1},postCodeSearch:function(e){$("#subscriptionAddress [name=zipcode]").addClass("zipcode-searching"),$("#subscriptionAddress [name=street]").attr("disabled",!0),$("#subscriptionAddress [name=neighborhood]").attr("disabled",!0),$("#subscriptionAddress [name=city]").attr("disabled",!0),$("#subscriptionAddress [name=state]").attr("disabled",!0);var a,t,n=Math.floor(2*Math.random()+1)-1;switch(n){case 0:a="https://viacep.com.br/ws/"+e+"/json/",t={street:"logradouro",neighborhood:"bairro",city:"localidade",state:"uf"};break;case 1:a="https://api.postmon.com.br/v1/cep/"+e,t={street:"logradouro",neighborhood:"bairro",city:"cidade",state:"estado"}}$.ajax({url:a,method:"GET",dataType:"json",timeout:1500}).done(function(e){var a={};for(var n in t)a[n]=e[t[n]];r.postCodeComplete(a)}).fail(function(a,t){"timeout"===t&&r.postCodeSearch(e),s.logError("Impossível recuperar dados do CEP fornecido")})},postCodeComplete:function(e){e.street&&($("#gcPaymentsAddress [name=street]").val(e.street),$("#gcPaymentsAddress [name=street_number]").focus()),e.neighborhood&&$("#gcPaymentsAddress [name=neighborhood]").val(e.neighborhood),e.city&&$("#gcPaymentsAddress [name=city]").val(e.city),e.state&&$("#gcPaymentsAddress [name=state]").val(e.state),$("#gcPaymentsAddress [name=zipcode]").removeClass("zipcode-searching"),$("#gcPaymentsAddress [name=street]").attr("disabled",!1).change(),$("#gcPaymentsAddress [name=neighborhood]").attr("disabled",!1).change(),$("#gcPaymentsAddress [name=city]").attr("disabled",!1).change(),$("#gcPaymentsAddress [name=state]").attr("disabled",!1).change()}},o={renderPaymentMethods:function(){var e=Mustache.render(window[s.steps.payment_method],{canBillet:"pt-br"==s.language});return $("#gcPaymentsPaymentMethod").html(e),!0},renderPersonalData:function(){var e={},a=Mustache.render(window[s.steps.personal_data],e);return $("#gcPaymentsPersonalData").html(a),s.maskInputs(),!0},renderAddress:function(){var e={};r.paymentType&&(e.isBillet="billet"===r.paymentType);var a=Mustache.render(window[s.steps.address],e);return $("#gcPaymentsAddress").html(a),s.maskInputs(),!0},renderCardData:function(){var e={},a=Mustache.render(window[s.steps.card_data],e);return $("#gcPaymentsCardData").html(a),s.maskInputs(),!0},renderConfirm:function(){var e,a,t={buffer:Object.assign({},r.buffer),friends:r.friends,paymentItem:r.paymentClientMeta.paymentItem};return t.buffer.payment={},friends_count=r.friends.length,0==friends_count&&(friends_count=1),e=(friends_count*t.paymentItem.amount).toFixed(2),t.buffer.card_data.card_snippet=r.buffer.card_data.card_number.substr(0,4),t.buffer.payment.id=t.paymentItem.id,t.buffer.payment.name=t.paymentItem.name,t.buffer.payment.price=e,t.buffer.payment.currency_symbol=r.paymentClientMeta.paymentItem.currency_symbol,a=Mustache.render(window[s.steps.confirm],t),$("#gcPaymentsConfirm").html(a),$("#gcPaymentsConfirm friends-list").scrollbar(),!0},renderBillet:function(){return s.processing(),r.friends.length>0?(s.generateBilletForFriends(),!0):($.ajax({url:"/payments/pay/billet",method:"post",data:{metadata:r.paymentClientMeta},success:function(e){var a=Mustache.render(window[s.steps.billet],e);s.updateOnClose=!0,$("#gcPaymentsBillet").html(a),s.processing(!1),s.stepTagger("finish"),n(r.paymentClientMeta.paymentItem.id,r.paymentMethod,r.paymentType)},error:function(e){var a=e.responseJSON;return s.showFatalError("Não foi possível gerar o boleto",a.message),!1}}),!0)},renderFatalError:function(e){var a=Mustache.render(window[s.steps.fatal_error],e);return $("#gcPaymentsFatalError").html(a),!0},renderRecoverableError:function(e){var a=Mustache.render(window[s.steps.recoverable_error],e);return $("#gcPaymentsRecoverableError").html(a),!0},renderSuccessCard:function(){var e={};e.friends=r.friends,s.updateOnClose=!0;var a=Mustache.render(window[s.steps.success],e);return $("#gcPaymentsSuccess").html(a),$(".subscription-play-now").click(function(e){e.preventDefault(),s.close()}),!0},renderFriends:function(){var e={};e.total_currency_symbol=r.paymentClientMeta.paymentItem.currency_symbol;var a=Mustache.render(window[s.steps.friends_list],e);return $("#gcPaymentsFriends").html(a),window.requestAnimationFrame(function(){i(amigosArray)}),!0},renderBreadcrumb:function(e,a){var t={friends_list:{index:0,step:"friends_list",name:i18n.sub_step_one_b,isEnabled:!1,isActive:!1},payment_method:{index:1,step:"payment_method",name:i18n.sub_step_two,isEnabled:!1,isActive:!1},card_data:{index:2,step:"card_data",name:i18n.sub_step_three,isEnabled:!1,isActive:!1},personal_data:{index:2,step:"personal_data",name:i18n.sub_step_three_b,isEnabled:!1,isActive:!1},address:{index:3,step:"address",name:i18n.sub_step_four,isEnabled:!1,isActive:!1},confirm:{index:4,step:"confirm",name:i18n.sub_step_five,isEnabled:!1,isActive:!1}};r.forFriends||delete t.friends_list,e.isBillet?(delete t.card_data,delete t.confirm):delete t.personal_data;var n=0;t[a]&&(t[a].isActive=!0,n=t[a].index),e.steps=[],$.each(t,function(a,r){r.index<n&&(t[a].isEnabled=!0),e.steps.push(t[a])});var o=Mustache.render(gcPaymentsBreadcrumbTemplate,e);return $("#gcPaymentsModalBreadcrumb").html(o),!0},updateBreadcrumb:function(e){var a={isBillet:"billet"===r.paymentType};return o.renderBreadcrumb(a,e)}},s={language:"pt-br",container:null,currentStep:null,validZipCode:null,updateOnClose:!1,steps:{friends_list:"gcPaymentsFriendsListTemplate",payment_method:"gcPaymentsPaymentMethodTemplate",personal_data:"gcPaymentsPersonalDataTemplate",address:"gcPaymentsAddressTemplate",card_data:"gcPaymentsCardDataTemplate",confirm:"gcPaymentsConfirmTemplate",billet:"gcPaymentsBilletTemplate",fatal_error:"gcPaymentsFatalErrorTemplate",recoverable_error:"gcPaymentsRecoverableErrorTemplate",success:"gcPaymentsSuccessTemplate"},templates:["gcPaymentsBreadcrumbTemplate","gcPaymentsFriendsListTemplate","gcPaymentsPaymentMethodTemplate","gcPaymentsCardDataTemplate","gcPaymentsPersonalDataTemplate","gcPaymentsAddressTemplate","gcPaymentsBilletTemplate","gcPaymentsFatalErrorTemplate","gcPaymentsRecoverableErrorTemplate","gcPaymentsSuccessTemplate","gcPaymentsConfirmTemplate"],init:function(a,t,n){var i=this;this.language=n,r.paymentMethod=t,"friends"===t&&(r.forFriends=!0),$(document).off("click","#gcPaymentsModal [data-jsaction=gotoStep]").on("click","#gcPaymentsModal [data-jsaction=gotoStep]",function(e){i.gotoStep($(this).data("target-step"),$(this).data("value"))}),$(document).off("click","#gcPaymentsConfirm .pay-subscription").on("click","#gcPaymentsConfirm .pay-subscription",function(e){i.pay()}),$(document).off("keypress","#gcPaymentsModal [data-jsaction=gotoStep]").on("keypress","#gcPaymentsModal [data-jsaction=gotoStep]",function(e){0!==e.charCode&&32!==e.keyCode||i.gotoStep($(this).data("target-step"),$(this).data("value"))}),$(document).off("click","#gcPaymentsModal [data-jsaction=backStep]").on("click","#gcPaymentsModal [data-jsaction=backStep]",function(e){i.showStep($(this).data("target-step"))}),$(document).off("click","#gcPaymentsModal [data-jsaction=gcPaymentsModalClose]").on("click","#gcPaymentsModal [data-jsaction=gcPaymentsModalClose]",function(){i.close(),s.updateOnClose===!0&&window.location.reload()}),$(document).off("change","#gcPaymentsAddress .zipcode").on("change","#gcPaymentsAddress .zipcode",function(){var e=$(this).val().replace(/\D/g,"");8==e.length&&r.postCodeSearch(e)}),$(document).off("focusin","#gcPaymentsCardData .card-cvv").on("focusin","#gcPaymentsCardData .card-cvv",function(){$("#gcPaymentsCardData .gc-payments-modal-card-back").addClass("gc-payments-modal-card-back-active")}),$(document).off("focusout","#gcPaymentsCardData .card-cvv").on("focusout","#gcPaymentsCardData .card-cvv",function(){return $(this).val().length>0||void $("#gcPaymentsCardData .gc-payments-modal-card-back").removeClass("gc-payments-modal-card-back-active")}),$(document).off("keyup","#gcPaymentsCardData [data-jsaction=bindCardInput]").on("keyup","#gcPaymentsCardData [data-jsaction=bindCardInput]",function(){var e=$(this).val(),a=$("#gcPaymentsCardData [data-card-image="+$(this).attr("name")+"]");e.length>0?a.text(e):a.text(a.data("card-placeholder"))}),$(document).off("change","#gcPaymentsModal input").on("change","#gcPaymentsModal input",function(){r.saveLocalItem(i.currentStep,$(this).attr("name"),$(this).val())}),$(document).off("focusout","#gcPaymentsModal input").on("focusout","#gcPaymentsModal input",function(){$(this).val().length>0&&$(this).addClass("has-changed")}),$(document).off("submit","#gcPaymentsModal form").on("submit","#gcPaymentsModal form",function(e){return e.preventDefault(),!1}),this.container=$("#gcPaymentsModal"),this.processing(),e.parseMultiple(this.templates),o.renderPaymentMethods(),r.loadPaymentClientMeta(a),o.renderFriends()},open:function(){return this.container.addClass("gc-payments-modal-active"),r.forFriends?this.showStep("friends_list"):this.showStep("payment_method"),r.hasPendingPayment&&!r.forFriends?(this.showFatalError("Item com pagamento pendente","Identificamos que você já solicitou este item, porém está com pagamento pendente, verifique em seu perfil (Gerenciar Conta -> Compras) ou e-mail as instruções para pagamento. Em caso de dúvidas, favor entrar em contato com nosso suporte pelo site."),!1):void $("body").css("overflow","hidden")},close:function(){this.container.removeClass("gc-payments-modal-active"),$("body").css("overflow","auto"),this.resetModalState()},resetModalState:function(){r.container=null,r.currentStep=null,r.paymentMethod=null,r.paymentType=null,r.paymentItem={},r.hasPendingPayment=!1,r.forFriends=!1,r.friends=[],r.buffer={},r.update_on_close=!0,window.amigosArray.forEach(function(e){e.selected=!1})},processing:function(e){return e===!1?(this.container.removeClass("gc-payments-modal-process"),!0):(this.container.addClass("gc-payments-modal-process"),!1)},loader:function(e){return e===!1?(this.container.removeClass("gc-payments-modal-loading"),!0):(this.container.addClass("gc-payments-modal-loading"),!1)},isCardPaymentProcessing:function(e){return e?(this.processing(),!0):(this.processing(!1),!1)},maskInputs:function(){$("[name=ddd]").mask("000"),$("[name=number]").mask("000000000"),$("[name=card_cvv]").mask("0000"),$("[name=card_expiration_date]").mask("00/00"),$("[name=card_number]").mask("0000 0000 0000 0000");var e={onKeyPress:function(a,t,n,r){var o=["000.000.000-000","00.000.000/0000-00"],s=a.length>14?o[1]:o[0];$("[name=document_number]").mask(s,e)}};$("[name=document_number]").mask("000.000.000-000",e),$("[name=zipcode]").mask("00000-000")},stepTagger:function(e,a){if("undefined"==typeof dataLayer)return!1;switch(e){case"payment_method":"billet"===a?dataLayer.push({event:"boleto_init"}):dataLayer.push({event:"cartao_init"});break;case"personal_data":case"card_data":"billet"===r.paymentType?dataLayer.push({event:"boleto_info"}):dataLayer.push({event:"cartao_info"});break;case"address":"billet"===r.paymentType?dataLayer.push({event:"boleto_address"}):dataLayer.push({event:"cartao_address"});break;case"finish":"billet"===r.paymentType?dataLayer.push({event:"boleto_finish"}):dataLayer.push({event:"cartao_success"});break;default:return!1}},gotoStep:function(e,a){if(!e&&"undefined"!=typeof e)return this.logError("Etapa não encontrada "+e),!1;this.stepTagger(this.currentStep,a),$("#gcPaymentsModal .gc-payments-modal-error-active").removeClass("gc-payments-modal-error-active");var t=r.setStepData(this.currentStep,a);if("card_data"===this.currentStep&&0!==Object.keys(t.card).length)return void r.pagarMeFetchCreditCard(t,e);"friends_list"==this.currentStep&&(r.friends=[],$(".select2-selection__choice").each(function(e,a){friendData=$(a).find(".userName"),r.friends.push({nick:$(friendData).data("user-nick"),avatar:$(friendData).data("user-avatar"),id:$(friendData).data("user-id")})}));var n=c(t.errors);return n&&n.length>0?(s.showFormErrors(n),!1):"form"===n.name?("friends_list"==s.currentStep&&$("#gcPaymentsFriends .select2").after('<div class="gc-payments-modal-error-message gc-payments-modal-error-active">Nenhum amigo selecionado</div>'),!1):void("object"==typeof t&&t.done?(t.done(function(a){var t=c(a.errors);return t&&t.length>0?(s.showFormErrors(t),!1):(s.hideStepError(),s.loader(!1),s.renderNextStep(e)||s.logError("Erro ao renderizar  "+e+" partindo de "+s.currentStep),void("billet"===e?s.showStep(e,!0):s.showStep(e)))}).fail(function(e){var a=e.responseJSON;if(a.success===!1)return s.showStepError(a.message),!1}),t.error(function(){s.logError("Erro no servidor ao salvar dados "+e)})):t===!0?(s.renderNextStep(e)||s.logError("Erro ao renderizar  "+e+" partindo de "+s.currentStep),s.showStep(e)):s.logError("Erro ao trocar etapa "+e))},showStep:function(e,a){this.currentStep=e,a!==!0&&r.loadStepData(e),this.container.attr("data-current-step",e),o.updateBreadcrumb(e),$("#gcPaymentsModal .gc-payments-modal-step-active").removeClass("gc-payments-modal-step-active"),$("#gcPaymentsModal [gc-payments-step="+e+"]").addClass("gc-payments-modal-step-active"),this.container.scrollTop(0)},renderNextStep:function(e){var a;switch(e){case"personal_data":a=o.renderPersonalData();break;case"address":a=o.renderAddress();break;case"card_data":a=o.renderCardData();break;case"confirm":a=o.renderConfirm();break;case"billet":a=o.renderBillet();break;case"success":a=o.renderSuccessCard();break;case"fatal_error":a=o.renderFatalError();break;case"recoverable_error":a=o.renderRecoverableError();break;case"friends_list":case"payment_method":a=!0;break;default:this.logError("Etapa inexistente "+e)}return a?(this.hideStepError(),!0):(this.logError("Não foi possível ir para etapa "+e),!1)},goToPendingPaymentBillet:function(e){if(e.billet){var a={billet:{billetUrl:e.billet.billetUrl,billetCode:e.billet.billetCode,billetBarcode:e.billet.billetBarcode,billetAmount:e.billet.billetAmountFormatted}},t=Mustache.render(window[this.steps.billet],a);return $("#gcPaymentsBillet").html(t),this.showStep("billet"),this.processing(!1),!0}r.hasPendingPayment=!0,this.showFatalError("Item com pagamento pendente","Identificamos que você já solicitou este item, porém está com pagamento pendente, verifique em seu perfil (Gerenciar Conta -> Compras) ou e-mail as instruções para pagamento. Em caso de dúvidas, favor entrar em contato com nosso suporte pelo site.")},showStepError:function(e){var a=document.getElementById("stepErrorMessage");return!("undefined"==typeof a||!a.classList)&&(a.innerHTML=e,a.classList.remove("hidden"),void this.loader(!1))},showFatalError:function(e,a){var t={title:e,message:a};return o.renderFatalError(t),this.showStep("fatal_error"),this.processing(!1),!0},showRecoverableError:function(e,a,t){var n={title:e,message:a};t&&(n.step=t),o.renderRecoverableError(n),this.showStep("recoverable_error"),this.processing(!1)},hideStepError:function(){document.getElementById("stepErrorMessage").classList.add("hidden")},showFormErrors:function(e){$.each(e,function(e,a){var t=$('#gcPaymentsModal [name="'+a.name+'"]');t.length>0&&t.siblings(".gc-payments-modal-error-message").text(a.message).addClass("subscription-error-active")}),this.loader(!1)},logError:function(e,a){console.error("[MODAL] "+e),a&&console.error(a)},generateBilletForFriends:function(){var e=this,a=r.friends;$.ajax({url:"/payments/pay/billet",method:"post",data:{metadata:r.paymentClientMeta,friends:a},success:function(a){var t=Mustache.render(window[e.steps.billet],a);e.update_on_close=!0,$("#gcPaymentsBillet").html(t),e.processing(!1),e.stepTagger("finish"),n(r.paymentClientMeta.paymentItem.id,r.paymentMethod,r.paymentType)},error:function(a){var t=a.responseJSON;return e.showFatalError("Não foi possível gerar o boleto",t.message),!1}})},pay:function(){var e=this,a=r.friends,t=r.buffer;this.isCardPaymentProcessing(!0),$.ajax({url:"/payments/pay/card",method:"post",dataType:"json",data:{metadata:r.paymentClientMeta,payment:t,friends:a},success:function(a){o.renderSuccessCard(),e.showStep("success",!0),e.stepTagger("finish"),e.isCardPaymentProcessing(!1),n(r.paymentClientMeta.paymentItem.id,r.paymentMethod,r.paymentType)},error:function(a){var t=a.responseJSON;return e.isCardPaymentProcessing(!1),t.step?(e.showRecoverableError("Não foi possível processar o pagamento",t.message,t.step),!1):(e.showFatalError("Não foi possível processar o pagamento",t.message),!1)}})}},i=function(e){var a=$("#gcPaymentsFriends .select-friends");a.select2({tags:!0,placeholder:i18n.sub_friends_click_to_see_your_friends,width:"100%",data:e,templateResult:this.addUserPic,templateSelection:this.addUserPic,createTag:function(e){var a=$.trim(e.term),t=/^\d+$/.test(a);return""===a||t===!1?null:{id:e.term,text:e.term,isNew:!0}},insertTag:function(e,a){e.push(a)}}).on("select2:select",function(e){$("#gcPaymentsFriends .subscription-error-message").removeClass("subscription-error-active");var t=e.params.data.id;if($("#gcPaymentsFriends .select2-selection__choice[title="+t+"]").addClass("user-searching"),e.params.data.isNew)$.ajax({type:"post",url:"/players/find/"+t,success:function(e){var t=amigosArray.filter(function(a){return a.id==e.player.id}).length;if(1==t){var n=amigosArray.map(function(e){return e.id}).indexOf(parseInt(e.player.id));amigosArray[n];amigosArray[n].selected=!0}else amigosArray.push({id:parseInt(e.player.id),text:e.player.nick,avatar:e.player.avatar,selected:!0});a.select2("destroy"),a.off(),a.find("option").remove(),i(amigosArray)},error:function(e){alert("Usuário inválido"),a.select2("destroy"),a.off(),a.find("option").remove(),i(amigosArray)}});else for(var n in amigosArray)amigosArray[n].id==t&&(amigosArray[n].selected=!0)}).on("select2:unselect",function(e){var a=e.params.data.id;for(var t in amigosArray)amigosArray[t].id==a&&(amigosArray[t].selected=!1)}),a.on("change",function(e){var a,t=Array.from(new Set($(this).val()));a=null!==t?t.length:0,total_currency_symbol=r.paymentClientMeta.paymentItem.currency_symbol,total=(r.paymentClientMeta.paymentItem.amount*a*1).toFixed(2),$("#gcPaymentsFriends .total .total-currency-symbol").html(total_currency_symbol),$("#gcPaymentsFriends .total .total-value").html(total)})},c=function(e){if("undefined"==typeof e)return!1;if("object"==typeof e)return e;var a={};try{return a=JSON.parse(e)}catch(t){return s.logError("Impossível fazer parse json ".data),!1}},l=function(e,a,t,n){return null!==s.container?(s.init(e,a,t),s.open(),n.attr("disabled",!1),!0):void $.ajax({method:"get",data:{},
url:"/payments/modal",success:function(n){$("#gc-payments").html(n),s.init(e,a,t),s.open()},error:function(){s.showFatalError("Falha ao carregar modal")},complete:function(){n.attr("disabled",!1)}})},d=function(e){if(e.preventDefault(),$(this).attr("disabled"))return!1;$(this).attr("disabled",!0);var a=$(this).data(),n=$(this);t($(this).data("item"),$(this).data("method"),$(this).data("origin"));var r={paymentItem:a.item,paymentEntity:a.entity},o=a.method,s=a.language;l(r,o,s,n)};$(document).on("click","[data-jsaction=paymentBtn]",d)});var chosenScript,randomString=function(){for(var e="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;t<22;t++)e+=a.charAt(Math.floor(Math.random()*a.length));return e},dialogHTML='<div class="waiting-dialog">   <div class="content">      <div id="loader-spin"></div>      <p>{message}</p>   </div></div>',waitingDialog=waitingDialog||function(e){"use strict";return{show:function(a,t){e(".waiting-dialog").remove(),e("body").append(dialogHTML.replace("{message}",a)),e(".waiting-dialog").fadeIn("fast")},hide:function(){e(".waiting-dialog").fadeOut("fast"),setTimeout(function(){e(".waiting-dialog").remove()},500)}}}(jQuery),noty=function(e){notice(e.text)};!function(e){e.ajaxSetup({async:!0});var a={common:{init:function(){function a(){var a=e(window).width()-140,t=1170,n=(a-t)/2;e(".bglink").css("width",n)}function t(e){e.find(".form-error-message").text("")}function n(a,t){e.each(t,function(t,n){e(".form-error-message."+t).length?e(".form-error-message."+t).text(n):a.find('[name="'+t+'"]').siblings(".form-error-message").text(n)})}function r(){e(".tabs-principal").each(function(){var a=e(this),t=0,n=0,r=a.find(".tabs").outerWidth()-a.find(".select_tabs").outerWidth();a.find(".select_tabs ul li").remove(),a.find(".tabs > .tab-title").each(function(){var a=e(this);a.removeClass("show-item-tab"),a.removeClass("hide-item-tab"),a.outerWidth()+t<=r?(t=a.outerWidth()+t,a.addClass("show-item-tab")):a.addClass("hide-item-tab")}),a.find(".tabs > li.hide-item-tab").each(function(){var a=e(this),t=a.find("a").attr("data-name");e(this).siblings("li").find(".content_select_tabs").append('<li><a data-href="'+a.find("a").attr("href")+'" class="button_select_tabs">'+t+"</a></li>"),n++,e(this).siblings("li").find(".count-tabs").text(n)}),n>0?a.find(".select_tabs").show():a.find(".select_tabs").hide()})}function o(){e("input[name=zipcode]").mask("00000-000"),e("input[name=ddd]").mask("000"),e("input[name=number]").mask("000000000"),e("input[name=card_cvv]").mask("0000"),e("input[name=card_expiration_date]").mask("00/00"),e("input[name=card_number]").mask("0000 0000 0000 0000 000");var a={onKeyPress:function(e,a,t,n){s(e,n)}};s(e("input[name=document_number]").val(),a)}function s(a,t){a&&(a=a.replace(/[\W_]/g,""));var n=["000.000.000-000","00.000.000/0000-00"],r=a&&a.length>11?n[1]:n[0];e("input[name=document_number]").mask(r,t)}function i(){e("#gcProfileSidebarActions .gc-friend-actions").removeClass("active")}var c=navigator.platform;c.indexOf("Win")===-1&&e("body").addClass("text-fix"),e("#btn-assinatura-slider").slick({vertical:!0,autoplay:!0,arrows:!1,autoplaySpeed:3500,pauseOnFocus:!1,pauseOnHover:!1,speed:700}),e(".alert-dismissible button.close").click(function(a){e(this).parent().hide()}),e(document).ready(a),e(window).resize(a),e(".idiomas .btn").click(function(){e(".dropdown-menu").toggleClass("show")});var l=new Clipboard(document.querySelectorAll(".btn-copy-url"));l.on("success",function(a){alert(e(a.trigger).data("alert"))}),l.on("error",function(e){alert("Error. Could not copy url.")}),e(".icon-dropdown, .icon-subdropdown").click(function(){var a="dropdown";if(e(this).hasClass("icon-subdropdown")&&(a="subdropdown"),e(this).hasClass("active"))e(this).removeClass("active"),e(".menu-"+a).removeClass("show");else{var t=e(this).data("target");e(".menu-"+a+"[data-dropdown="+t+"] .loader-spin").show();var n=e(this).data("load-url"),r=e(this).data("load-id"),o=e(this).data("callback");n&&r&&(e(r).html(""),o?d(r,n):e(r).load(n)),e(".menu-"+a).removeClass("show"),e(".menu-"+a+"[data-dropdown="+t+"]").toggleClass("show"),e(".icon-"+a).removeClass("active"),e(this).addClass("active"),e(".menu-"+a+"[data-dropdown="+t+"] .loader-spin").hide()}});var d=function(e,a){"undefined"!=typeof common[callback]&&common[callback](e,a),"undefined"!=typeof window[callback]&&window[callback](e,a)};e(document).on("click",function(a){e(a.target).closest(".interaction-item").length||(e(".icon-dropdown").removeClass("active"),e(".menu-dropdown").removeClass("show")),e(a.target).closest(".pl-stats-actions").length||e(".pl-stats-submenu").hide()});var m=!1;e("body").on("submit","form[data-remote=true]",function(a){a.preventDefault();e(this);if(t(e(this)),m)return alert("Aguarde..."),!1;m=!0;var r=e(this),o=e(this).prop("action"),s=e(this).prop("method");e(this).data("error-callback");$data=e(this).serialize(),serverStatus=e(this).find("button[type=submit]").next(".server-status"),button=e(this).find("button[type=submit]"),button.find(".initial").css("display","none"),button.find(".load").css("display","block"),e.ajax({type:s,url:o,data:$data,dataType:"json",success:function(e){button.addClass("btn-green"),button.find(".load").css("display","none"),button.find(".success").css("display","block"),void 0!=e.responseJSON&&e.responseJSON.message&&serverStatus.html(e.responseJSON.message),void 0!=e.message&&serverStatus.html(e.message),setTimeout(function(){button.removeClass("btn-green"),button.find(".success").css("display","none"),button.find(".initial").css("display","block")},4e3)},error:function(e){button.addClass("btn-red"),button.find(".load").css("display","none"),button.find(".error").css("display","block"),serverStatus.css("color","red");var a=e.responseJSON;if("undefined"==typeof a)return alert("Erro interno, tente novamente mais tarde"),!1;void 0!=a.message&&alert(a.message),a.errors&&n(r,a.errors);if(a.data){a.data}setTimeout(function(){button.removeClass("btn-red"),button.find(".error").css("display","none"),button.find(".initial").css("display","block")},4e3)},complete:function(e){setTimeout(function(){m=!1},2500)}})});e(".toggle-container").click(function(){var a=e(this).find(".toggle-circle");a.data("position");a.toggleClass("on")}),window.zerarNotificacoes=function(){return!!confirm("Deseja realmente zerar todas as notificações?")&&void e.ajax({url:"/notificacoes/zerarNotificacoes",type:"GET",success:function(a){console.log(a),e(".tournament-notification").css("display","none")},error:function(e){alert(e.responseJSON.message)}})},window.paceOptions={ajax:!1,restartOnRequestAfter:!1},e(".scroll").each(function(a,t){$disableBodyScroll=!1,e(this).hasClass("block-scroll")&&($disableBodyScroll=!0),$height=e(t).data("height"),e(t).scrollbar({height:$height,disableBodyScroll:$disableBodyScroll})}),new Blazy,Noty.overrideDefaults({progressBar:!0,timeout:5500,layout:"topRight",closeWith:["click","button"],animation:{open:"animated flipInX",close:"animated flipOutX"}}),window.notice=function(e){new Noty({type:"info",text:e}).show()},window.success=function(e){new Noty({type:"success",text:e}).show()},window.alert=function(e){new Noty({type:"error",text:e}).show()},window.warning=function(e){new Noty({type:"warning",text:e}).show()},e.ajax({type:"GET",url:"/statusGC/getStatusGC.json",async:!0,dataType:"json",contentType:"application/json; charset=utf-8",cache:!0,success:function(a){var t="Todos os sistemas estão operacionais",n="Alguns sistemas estão com problemas",r="Alguns sistemas estão com falha geral",o="Todos sistemas estão com falha geral";1==a.status?(e(".status").removeClass("s1 s2 s3 s4").addClass("s1"),e(".status a").html(t)):2==a.status?(e(".status").removeClass("s1 s2 s3 s4").addClass("s2"),e(".status a").html(n)):3==a.status?(e(".status").removeClass("s1 s2 s3 s4").addClass("s3"),e(".status a").html(r)):4==a.status?(e(".status").removeClass("s1 s2 s3 s4").addClass("s4"),e(".status a").html(o)):(e(".status").addClass("s1"),e(".status a").html(t))},error:function(){e(".status").removeClass("s1 s2 s3 s4").addClass("s1"),e(".status a").html("Todos os sistemas estão operacionais")}}),e(document).on("click",".showForm",function(a){a.preventDefault(),e("[data-auto-form]").slideUp("fast"),formId=e(this).data("form-id"),e("#"+formId).find(".error").slideUp("fast"),e("#"+formId).find(".success").slideUp("fast"),e("#"+formId).is(":visible")?e("#"+formId).slideUp("fast"):e("#"+formId).slideDown("fast"),e("#"+e(this).data("focus")).focus()}),e(document).on("click",".hideForm",function(a){a.preventDefault(),formId=e(this).data("form-id"),e("#"+formId).find(".error").slideUp("fast"),e("#"+formId).find(".success").slideUp("fast"),e("#"+formId).slideUp("fast")}),e(".lista-mensagens .mensagem").click(function(){e(this).addClass("lida")}),e(document).on("submit","#enviarMensagem",function(a){a.preventDefault(),window.enviarMensagemModalTimeout&&clearTimeout(window.enviarMensagemModalTimeout),self=e(this),parent=self.parent(),$actionUrl=e(this).prop("action"),$method=e(this).prop("method"),$data=e(this).serialize(),$clearOnSuccess=e(this).data("form-clear"),parent.removeClass("enviar-mensagem-success"),parent.addClass("enviar-mensagem-loading"),e(self).find(".server-status").slideUp("fast"),e(self).find(".server-status").addClass("hidden"),e.ajax({type:$method,url:$actionUrl,data:$data,dataType:"json",success:function(a){serverStatus=e(self).find(".server-status"),"undefined"==typeof a.status||"success"===a.status?(parent.addClass("enviar-mensagem-success"),serverStatus.hide(),window.enviarMensagemModalTimeout=window.setTimeout(function(){e("#modal-enviar-mensagem .close-button").click(),e("#modal-enviar-mensagem .enviar-mensagem-success").removeClass("enviar-mensagem-success")},3e3),$clearOnSuccess&&self[0].reset()):(serverStatus.text(a.message),e(serverStatus).addClass("alert-danger"),e(serverStatus).slideDown("fast")),e(self).data("reload")===!0&&location.reload(!0)},error:function(a){serverStatus=e(self).find(".server-status"),serverStatus.text(a.responseJSON.message),serverStatus.append(a.responseJSON.errors),e(serverStatus).addClass("alert-danger"),e(serverStatus).slideDown("fast")},complete:function(){parent.removeClass("enviar-mensagem-loading")}})}),setTimeout(function(){e(".lazy-link").removeClass("lazy-link")},500),e("body").on("click","li.tab-title a",function(a){a.preventDefault(),a.stopImmediatePropagation();var t=e(this).closest("ul").attr("tab-group"),n=e(this).attr("href");window.location.hash=n,e(".tabs-content[tab-group="+t+"] .content").hide(),e(n).show(),e("ul[tab-group="+t+"]").find("li.tab-title").removeClass("active"),documentTitle=e(this).data("document-title"),documentTitle&&(document.title=documentTitle+" | Gamers Club. O clube para quem joga sério."),e(this).closest("li").addClass("active")}),e("#menu li").find("a").hover(function(){$el=e(this),leftPos=$el.position().left,newWidth=$el.parent().width(),$magicLine.stop().animate({left:leftPos,width:newWidth})},function(){$magicLine.stop().animate({left:$magicLine.data("origLeft"),width:$magicLine.data("origWidth")})}),e(".fa-info-circle").on("click",function(a){e(".player-statistics").each(function(a,t){e(this).hasClass("show-info-player sou-eu")===!1?e(this).removeClass("show-info-player sou-eu"):e(this).removeClass("show-info-player")}),e(this).siblings(".player-statistics").hasClass("sou-eu")?e(this).siblings(".player-statistics").removeClass("show-info-player sou-eu"):e(this).siblings(".player-statistics").addClass("show-info-player sou-eu")}),e("#events").slick({infinite:!0,slidesToShow:3,slidesToScroll:3,speed:300,dots:!0,arrows:!0,responsive:[{breakpoint:900,settings:{slidesToShow:2,slidesToScroll:2,infinite:!0,dots:!0}},{breakpoint:750,settings:{slidesToShow:1,slidesToScroll:1}}]}),e(document).keyup(function(a){27==a.keyCode&&e(".close-button").trigger("click")}),e("body").on("click",".close-button",function(a){var t=e(this);t.closest(".modal").addClass("fadeOutDown").removeClass("fadeInUp").css({top:0}),setTimeout(function(){e(".overlay").fadeOut("fast"),t.closest(".modal").hide()},250),e(".overlay").removeClass("no-opacity-modal "),e(".overlay").removeClass("zindex49"),e(document).unbind("keyup.escclosemodal")}),e("div[data-type=modal], a[data-type=modal]").on("click",function(a){var t=e(this).attr("data-modal");e(".overlay").fadeIn("fast",function(){var a=e(window).scrollTop();e("#"+t).removeClass("fadeOutDown"),e("#"+t).css({top:a}).show().addClass("fadeInUp"),r()}),e(document).on("keyup.escclosemodal",function(a){27==a.keyCode&&(e(".close-button").click(),e(".icon-dropdown").removeClass("active"),e(".menu-dropdown, .dropdown-menu").removeClass("show"),e(".pl-stats-submenu").hide())})}),e(".ranked-cta .btn").click(function(){e(".menu-dropdown, .dropdown-menu").removeClass("show")}),e(".show-menu").click(function(){var a=e(this).data("target"),t=e(a);t.find(".menu-notifications-list").scrollbar(),clearInterval(animMenu),t.hasClass("fadeInUp")?t.addClass("fadeOutDown").removeClass("fadeInUp").fadeOut(250):(t.show().addClass("fadeInUp").removeClass("fadeOutDown"),animMenu=setTimeout(function(){t.addClass("fadeOutDown").removeClass("fadeInUp").hide()},1e6))}),e(".icon-menu-mobile").on("click",function(a){e(".mobile-menu").toggleClass("show-mobile-menu"),e(".icon-menu-mobile i").toggleClass("fa-bars fa-close")}),e(window).resize(function(){r();try{updateTableEvents&&"function"==typeof updateTableEvents&&updateTableEvents()}catch(e){}}),e(document.body).on("click",".button_select_tabs",function(){var a=e(this).attr("data-href");e(".tab-title").each(function(){var t=e(this).find("a").attr("href");t==a&&e(this).find("a").click()})}),e(".select_tabs").on("click",function(){clearInterval(animSelectTabs),e(this).find("ul").hasClass("fadeInUp")?(e(this).find("ul").addClass("fadeOutDown").removeClass("fadeInUp"),animSelectTabs=setTimeout(function(){e(".content_select_tabs").hide()},1e3)):e(this).find("ul").removeClass("fadeOutDown").addClass("fadeInUp").show()}),r(),window.location.hash.length>0&&setTimeout(function(){e('.tab-title a[href="'+window.location.hash+'"]')&&e('.tab-title a[href="'+window.location.hash+'"]').click()},700),"undefined"!=typeof gcDynamicTooltip&&(e.debounce_tooltip_leave=gcDynamicTooltip.close,e(document).on("mouseenter","[data-jsaction=gcDynamicTooltip]",gcDynamicTooltip.open),e(document).on("mouseleave","[data-jsaction=gcDynamicTooltip]",gcDynamicTooltip.close),e(document).on("mouseleave","#gc-dynamic-tooltip",gcDynamicTooltip.close));var u=function(a){"modal-play-now"==a&&e(".overlay").addClass("no-opacity-modal"),e(".overlay").fadeIn("fast",function(){var t=e(window).scrollTop();e("#"+a).removeClass("fadeOutDown"),e("#"+a).css({top:t}).show().addClass("fadeInUp")})},p={container:null,search:function(a,t,n){p.container=t,p.searching();var n=void 0!==n&&n,r=p.postcodeChooseGateway(a,n);e.ajax({url:r.zipGatewayUrl,method:"GET",dataType:"json",timeout:1500}).done(function(e){if(e.erro)return p.search(a,t,!0),!1;var n={};for(var o in r.zipGatewayFields)n[o]=e[r.zipGatewayFields[o]];p.done(n)}).fail(function(e,n){"error"===n&&"pagarme"!==r.zipGatewayName&&p.search(a,t,!0),"timeout"===n&&p.search(a,t),p.done(),console.error("Impossível recuperar dados do CEP fornecido")})},postcodeChooseGateway:function(e,a){var t,n=Math.floor(2*Math.random()+1)-1,r=[{zipGatewayName:"viacep",zipGatewayUrl:"https://viacep.com.br/ws/"+e+"/json/",zipGatewayFields:{street:"logradouro",neighborhood:"bairro",city:"localidade",state:"uf"},run:0},{zipGatewayName:"postmon",zipGatewayUrl:"https://api.postmon.com.br/v1/cep/"+e,zipGatewayFields:{street:"logradouro",neighborhood:"bairro",city:"cidade",state:"estado"},run:0}],o={zipGatewayName:"pagarme",zipGatewayUrl:"https://api.pagar.me/1/zipcodes/"+e,zipGatewayFields:{street:"street",neighborhood:"neighborhood",city:"city",state:"state"},run:0};return a===!0?(t=o,t.run=o.run+1):(t=r[n],t.run=o.run+1),t},searching:function(e){p.container.find("[name=zipcode]").addClass("zipcode-searching"),p.container.find("[name=street]").attr("disabled",!0),p.container.find("[name=neighborhood]").attr("disabled",!0),p.container.find("[name=city]").attr("disabled",!0),p.container.find("[name=state]").attr("disabled",!0)},done:function(e){e&&(e.street&&(p.container.find("[name=street]").val(e.street),p.container.find("[name=street_number]").focus()),e.neighborhood&&p.container.find("[name=neighborhood]").val(e.neighborhood),e.city&&p.container.find("[name=city]").val(e.city),e.state&&p.container.find("[name=state]").val(e.state)),p.container.find("[name=zipcode]").removeClass("zipcode-searching"),p.container.find("[name=street]").attr("disabled",!1).change(),p.container.find("[name=neighborhood]").attr("disabled",!1).change(),p.container.find("[name=city]").attr("disabled",!1).change(),p.container.find("[name=state]").attr("disabled",!1).change()}};e(document).on("change",".postcode-search",function(){var a=e(this).val().replace(/\D/g,""),t=e(e(this).data("container"));8==a.length&&p.search(a,t)});var f=function(a){e.ajax({type:"post",url:"/campeonatos/fazerCheckinCamp/"+a,data:{gtmp:"x"},success:function(a){e(".checkin-content").hide(),e(".checkin-loader-content").show(),"Ok"==a?(e(".checkin-loader-content").hide(),e(".checkin-success-content").show()):(e(".checkin-loader-content").hide(),e(".checkin-error-content").html(a).show())},error:function(e){alert("error, try again.")}})},h=function(){e.getJSON("/discord/unlink",function(e){}).done(function(e){window.location.reload(!0)}).fail(function(e){alert("Problema ao remover o vínculo, já está desvinculado?")})},v=function(e){e=parseInt(e);var a=null;if(a=document.getElementById("openTournamentModalShadow"),null==a){var t=document.createElement("div");t.id="openTournamentModalShadow",t.dataset.jsaction="payPlanBtn",t.dataset.tournament=e,document.body.appendChild(t)}document.getElementById("openTournamentModalShadow").click()},g=function(a){a=parseInt(a);var t=null;if(t=document.getElementById("openTournamentModalShadow"),null==t){var n=document.createElement("div");n.id="openTournamentModalShadow",n.dataset.jsaction="payPlanBtn",document.body.appendChild(n)}e.ajax({url:"/modal/gamersClubExclusives/",success:function(a){var t={modalContainer:"#buyExclusivesMedal",modalClass:"simple-modal",classes:[]},n=new SimpleModal(t);n.show(a),document.getElementById("buyExclusiveMedalPresent").addEventListener("click",function(){"undefined"!=typeof dataLayer&&dataLayer.push({event:"comprar_exclusive_goto_escolher_medalha"}),document.getElementById("buyExclusiveMedalPresent").classList.remove("buy-exclusive-medal-content-enabled"),document.getElementById("buyExclusiveMedalList").classList.add("buy-exclusive-medal-content-enabled")}),e("#buyExclusiveMedalList .buy-medal-item-wrapper").click(function(){"undefined"!=typeof dataLayer&&dataLayer.push({event:"comprar_exclusive_escolheu_medalha"});var a=e(this).data("medal");e("#openTournamentModalShadow").data("tournament",a),e("#openTournamentModalShadow").data("jsaction","payPlanBtn"),e("#openTournamentModalShadow").click(),n.hide()})}})};if(window.location.hash.match(/comprar-medalha(=\d+)?/)){var y=window.location.hash.match(/comprar-medalha(=\d+)?/);if("undefined"!=typeof y&&y.length>0){var b=y[0].match(/\d+/);"undefined"!=typeof dataLayer&&(window.subscriptionPage="hash_comprar_exclusive_finalizado",dataLayer.push({event:"hash_comprar_exclusive"})),null===b?g():"undefined"!=typeof b&&b.length>0&&parseInt(b[0])>0&&v(b[0])}}var _=function(a,t){i(),e("#gcProfileSidebarActions .js-gc-friend-waiting").addClass("active"),FriendsApp.addFriend(a)},w=function(a,t){i(),e("#gcProfileSidebarActions .js-gc-friend-add").addClass("active"),FriendsApp.undoFriendship(a)};e(document).on("click",'[data-jsaction="openExclusivesBtn"]',function(){"undefined"!=typeof dataLayer&&(window.subscriptionPage="btn_camp_comprar_exclusive_finalizado",dataLayer.push({event:"btn_camp_comprar_exclusive"})),g()}),window.common={addFriend:_,undoFriendship:w,openGamersClubExclusivesModal:g,modal:{abrirModal:function(a,t,n,r,o,s,i){e(".modal").hide(),r===!1&&e("#"+a).html("");var c=!e.trim(e("#"+a).html()),l=void 0!=t&&void 0!=n;c&&l?"undefined"!=typeof s?this.abrirModalPost(a,t,n,s):this.abrirModalGet(a,t,n,o):u(a),i&&e(".overlay").addClass("zindex49")},abrirModalPost:function(a,t,n,r,o){e.post(t,{postData:r},function(t){e(n).html(t),u(a),"function"==typeof o&&o()})},abrirModalGet:function(a,t,n,r){0==e(n).length&&console.error('ajaxTarget target "',n,"\" doesn't exist"),e(n).load(t,function(e,t,n){"function"==typeof r&&r(),u(a)})},openContractPlayNow:function(e){lobbyModals.setNamespace("ranked"+e+"Modal"),lobbyModals.showModal().showContract(e)}},bindToolTipsToContainer:bindToolTipsToContainer,bindToolTips:bindToolTips,postcodeSearch:p,maskPaymentData:o,fazerCheckin:f,unlinkDiscord:h,mensagens:{marcarComoLidas:function(){e.ajax({type:"post",url:"/mensagens",data:{marcarLido:1},success:function(a){"ok"==a&&e("li.mensagem").addClass("lida")},error:function(e){alert("Ocorreu um erro, tente novamente.")}})}}};try{"suporte"==window.location.hash.substring(1).toLowerCase()&&$crisp.push(["do","chat:open"])}catch(C){}window.intercomHelp={container:null,wasOpened:!1,init:function(){intercomHelp.container=document.getElementById("help-center-intercom")},show:function(){intercomHelp.wasOpened||(intercomHelp.container.classList.add("help-center-intercom-active"),e("#intercom-container").css("z-index",5e3),intercomHelp.wasOpened=!0)},hide:function(){intercomHelp.container.classList.remove("help-center-intercom-active")}},intercomHelp.init(),$crisp.push(["on","chat:opened",function(){intercomHelp.show()}]),$crisp.push(["on","chat:closed",function(){intercomHelp.hide()}]),$crisp.push(["on","message:sent",function(){intercomHelp.hide()}]),e(".close-crisp").click(function(){$crisp.push(["do","chat:close"])}),function(e){e.fn.GC_Dropdown=function(){var a=this.find(".js-DropdownToggle"),t=this.find(".js-DropdownWindow"),n={active:"is-active"};a.click(function(){var r=e(this),o=e(r.data("dropdown"));a.hasClass(n.active)&&!r.hasClass(n.active)&&a.removeClass(n.active),t.hasClass(n.active)&&!o.hasClass(n.active)&&t.removeClass(n.active),r.toggleClass(n.active),o.toggleClass(n.active)}),e(document).click(function(r){e(r.target).closest(".interaction-item").length||(a.removeClass(n.active),t.removeClass(n.active))})},e(".js-Dropdown").GC_Dropdown()}(jQuery),function(e){e.fn.GC_TabNav=function(){var a=this.find(".js-TabItem"),t=this.find(".js-TabContent"),n={active:"is-active"};a.hasClass(n.active)||a.first().addClass(n.active),t.hasClass(n.active)||t.first().addClass(n.active),a.click(function(r){r.preventDefault();var o=e(this),s=e('[data-content="'+o.data("tab")+'"]');!o.hasClass(n.active)&&a.hasClass(n.active)&&a.removeClass(n.active),!s.hasClass(n.active)&&t.hasClass(n.active)&&t.removeClass(n.active),o.hasClass(n.active)||o.addClass(n.active),s.hasClass(n.active)||s.addClass(n.active)})},e(".js-TabNav").GC_TabNav()}(jQuery),e(function(){$fixedBar=e(".js-ShopSingle__fixedBar"),$distance=e(".ShopSingle__hero").height(),$fixedClass="ShopSingle__fixedBar--active",e(document).scroll(function(){var a=e(document).scrollTop();a>$distance?$fixedBar.hasClass($fixedClass)||$fixedBar.addClass($fixedClass):$fixedBar.removeClass($fixedClass)})}),function(e){var a=e("[data-custom-scroll]"),t=a.data("custom-scroll-height");a.mCustomScrollbar({setHeight:t?t:300,scrollInertia:0})}(jQuery),e("body").on("click",".filtro-select",function(){var a=e(this).data("target");e(".filtro-select-options[data-filtro="+a+"]").show(),e(".overlay-casuais").addClass("show")}),e("body").on("click",".filtro-select-option",function(){var a=e(this).data("option"),t=e(this).closest(".filtro-select-options").data("filtro");e(".filtro-select[data-target="+t+"] span").text(a),e(this).closest(".filtro-select-options").hide(),e(".overlay-casuais").removeClass("show"),e(".filtro-select-options[data-filtro="+t+"] .selected").removeClass("selected"),e(this).addClass("selected")}),e(document).mouseup(function(a){var t=e(".filtro-select-options");t.is(a.target)||0!==t.has(a.target).length||(t.hide(),e(".overlay-casuais").removeClass("show"))}),e("body").on("click",".filtro-inline-select span",function(){e(this).data("value");e(".filtro-inline-select span").removeClass("selected"),e(this).addClass("selected")})}},home:{init:function(){e("#main-slider").slick({arrows:!0,dots:!0,autoplay:!0,autoplaySpeed:5e3,responsive:[{breakpoint:1024,settings:{infinite:!0,dots:!1}},{breakpoint:600,settings:{dots:!1,infinite:!0,arrows:!1}}]});for(var a=document.getElementsByClassName("sliderVideo"),t=0;t<a.length;t++)a[t].play();e("#featured-matches").slick({arrows:!0,dots:!0,autoplay:!0,autoplaySpeed:4e5,responsive:[{breakpoint:1024,settings:{infinite:!0,dots:!1}},{breakpoint:600,settings:{dots:!1,infinite:!0,arrows:!1}}]}),e("#section-noticias-lists").slick({arrows:!1,dots:!1,autoplay:!1}),e('[data-jsaction="change-home-news"]').click(function(){var a=e(this).data("home-news");e(this).siblings().removeClass("section-noticias-filter-active"),e(this).addClass("section-noticias-filter-active"),e("#section-noticias-lists").slick("slickGoTo",a)}),e("#section-noticias-lists").on("afterChange",function(a,t,n){e(".section-noticias-filter-active").removeClass("section-noticias-filter-active"),e('.section-noticias-filter[data-home-news="'+n+'"]').addClass("section-noticias-filter-active")})}},gerenciamento:{init:function(){e(".remover-amigo").on("click",function(){self=this,amigoId=e(this).data("amigo-id"),FriendsApp||alert("Não foi possível remover amizade, tente novamente mais tarde."),confirm("Gostaria de desfazer amizade com o jogador?")&&(FriendsApp.undoFriendship(amigoId),this.closest("tr").remove())})}},editarClan:{init:function(){e("#excluir-clan").on("click",function(){if(confirm(REMOVE_TEAM_CONFIRM_TEXT)){var a=e(this).data("id");e.ajax({type:"post",url:"/time/"+a+"/excluirClan",success:function(e){"Ok"==e?window.location.href="/conta/gerenciamento":alert(e)},error:function(e){alert("error, try again.")}})}})}},gerenciarMembros:{init:function(){e("[data-toggle]").on("click",function(a){a.preventDefault(),e("[data-type]").addClass("hidden"),e("[data-toggle-parent]").removeClass("hidden"),type=e(this).data("toggle-type"),memberId=e(this).data("toggle"),row=e("[data-membro-id="+memberId+"][data-type="+type+"]"),e(row).toggleClass("hidden"),e(row).is(":visible")?("kick"==type&&e("input[name=sMotivo]").focus(),e("[data-toggle-parent="+memberId+"]").addClass("hidden")):e("[data-toggle-parent="+memberId+"]").removeClass("hidden")}),e(".cancel").on("click",function(a){a.preventDefault(),e("[data-type]").addClass("hidden"),e("[data-toggle-parent]").removeClass("hidden")}),e(".gerenciar-membros a.opcao").on("click",function(a){a.preventDefault();var t=e(this).data("posicao"),n=e(this).data("id"),r=e(this).data("player-id");return!!confirm(PROMOTE_PLAYER_TEXT)&&void e.ajax({type:"post",url:"/times/posicoes",data:{clanId:n,playerId:r,posicao:t},success:function(e){notice(e.message),location.reload(!0)},error:function(e){alert(e.message)}})})}},teamManagement:{init:function(){window.teamManagement={teamId:null,vacancyListTemplate:null,vacancyTemplate:null,candidatesTemplate:null,skillLevelsTemplate:null,modalRemoveVacancyTemplate:null,modalVacancyCandidateActionTemplate:null,roleSelect2Options:null,levelMaxRange:4,initTabs:function(){teamManagement.teamId=e("#teamId").val(),teamManagement.roleSelect2Options={placeholder:"Selecione uma função",width:"100%",tags:!1,multiple:!1,templateResult:teamManagement.roleTemplateResult,templateSelection:teamManagement.roleTemplateSelecion,minimumResultsForSearch:-1},teamManagement.initProfileClanTab(),teamManagement.initMembersTab(),teamManagement.initVacanciesTab()},initProfileClanTab:function(){e("#formProfileClan").on("submit",function(){e(document).ajaxComplete(function(a,t,n){201==t.status&&(window.location.href=t.responseJSON.data.redirect_to),e(a.currentTarget).unbind("ajaxComplete")})});new SimpleMDE({element:e(".descricao-time")[0],toolbar:["heading-bigger","heading-smaller","|","bold","italic","strikethrough","quote","|","unordered-list","ordered-list","horizontal-rule","|","link","image","preview"],status:!1})},initMembersTab:function(){e(document).on("submit",".kick-player-form",function(a){a.preventDefault(),a.stopPropagation();var t=e(this).prop("action");e.ajax({type:"POST",url:t,data:e(".kick-player-form").serialize(),success:function(a){e("#modal-kick-player .close-button").trigger("click");var t="#membro-"+e("#kickMembroId").val();e(t).fadeOut("slow"),notice(a.message)},error:function(e,a,t){var n=e.responseJSON;alert(n.message)}})}),e(document).on("change",".staff-role",function(a){var t=e(this).parent().parent().find("td .gaming-role");t.prop("disabled",!1),t.select2("destroy"),t.select2(teamManagement.roleSelect2Options)}),e(".gaming-role").select2(teamManagement.roleSelect2Options)},roleTemplateResult:function(a){return e(a.id&&0!=a.id?'<label><img class="select2-role-icon" src="/assets/images/gaming_roles/icon-'+a.text+'.svg" width="30" /><span class="select2-option select2-role-label">'+roles_translation[a.text].label+"</span></label>":'<span class="select2-option select2-role-empty-option">'+a.text+"</span>")},roleTemplateSelecion:function(a){if(a.id&&0!=a.id)return e('<span class="select2-option"><img src="/assets/images/gaming_roles/icon-'+a.text+'.svg" width="25" />'+roles_translation[a.text].label+"</span>");var t=e(a.element).parent().prop("id");return e(e(a.element).parent().prop("disabled")&&"primaryRole"!=t&&"secondaryRole"!=t&&"tertiaryRole"!=t?'<span class="select2-option"><img src="/assets/images/gaming_roles/icon-coach.svg" width="25" />'+roles_translation.coach.label+"</span>":'<span class="select2-option">'+a.text+"</span>")},getVacancies:function(){var a="/time/"+teamManagement.teamId+"/vagas";e.getJSON(a,function(a){a.hasVacancies=a.data.length>0,e.each(a.data,function(a,t){t.hasCandidates=t.total_enrolled>0,t.uniqueLevel=t.gc_level_min==t.gc_level_max,t.uniqueAge=t.age_min==t.age_max,e.each(t.roles,function(e,a){a.label=roles_translation[a.role].label})}),e(".vacancies-list-container").html(Mustache.render(teamManagement.vacancyListTemplate,a))})},getVacancy:function(a){var t="/time/"+teamManagement.teamId+"/vagas/"+a;e.getJSON(t,function(a){e("#vacancy-form-container").html(Mustache.render(teamManagement.vacancyTemplate,a.data,{teamId:teamManagement.teamId})),e.each(a.data.roles,function(a,t){e(".vacancy-role option[value="+t.role_id+"]").eq(a).attr("selected",!0)}),a.data.country&&e(".vacancy-country option[value="+a.data.country+"]").attr("selected",!0),teamManagement.initVacancyForm()})},getCandidates:function(a){e(".row.panel-content.vacancies:not([data-vacancy-id="+a+"])").hide();var t="/time/"+teamManagement.teamId+"/vagas/"+a+"/candidatos",n=[];e.getJSON(t,function(t){for(var r in t.data)e.each(t.data[r],function(a,t){t["isLevel"+t.level]=!0,t.approved=2==t.status,e.each(t.roles,function(e,a){a.label=roles_translation[a.role].label}),n.push(t)});t.data=n,t.data.length>0?(e(".candidate").html(Mustache.render(teamManagement.candidatesTemplate,t,{skillLevelsTemplate:teamManagement.skillLevelsTemplate})),e("#vacancy-candidates").attr("data-vacancy-id",a),e("#vacancy-candidates").show()):(teamManagement.getVacancies(),e("#vacancy-candidates").hide())})},initVacanciesTab:function(){e("#vacancy-form-container").hide(),e("#vacancy-candidates").hide(),teamManagement.vacanciesTabBinds(),teamManagement.parseTemplates(),teamManagement.getVacancies(),e(document).on("change","#primaryRole, #secondaryRole, #tertiaryRole",function(e){teamManagement.roleChanged(this)})},roleChanged:function(a){var t=e('select[name="roles[]"]').find(":selected");e('select[name="roles[]"]').find("option").removeAttr("disabled"),e.each(e('select[name="roles[]"]'),function(){var a=this,n=e(this).val();e.each(t,function(){n!==e(this).val()&&0!=e(this).val()?e(a).find('option[value="'+e(this).val()+'"]').attr("disabled",!0):e(a).find('option[value="'+e(this).val()+'"]').removeAttr("disabled");
})});var n;"primaryRole"==a.id?(a.value&&0!=a.value?e("#secondaryRole").prop("disabled",!1):(e("#secondaryRole").val(0),e("#tertiaryRole").val(0),e("#secondaryRole, #tertiaryRole").prop("disabled",!0)),n="#secondaryRole, #tertiaryRole"):"secondaryRole"==a.id?(a.value&&0!=a.value?e("#tertiaryRole").prop("disabled",!1):(e("#tertiaryRole").val(0),e("#tertiaryRole").prop("disabled",!0)),n="#primaryRole, #tertiaryRole"):n="#primaryRole, #secondaryRole",e(n).select2("destroy"),e(n).select2(teamManagement.roleSelect2Options)},validateRoles:function(){0==e("#primaryRole").val()?e("#primaryRole").addClass("invalid"):e("#primaryRole").removeClass("invalid"),0==e("#secondaryRole").val()?e("#secondaryRole").addClass("invalid"):e("#secondaryRole").removeClass("invalid"),0==e("#tertiaryRole").val()?e("#tertiaryRole").addClass("invalid"):e("#tertiaryRole").removeClass("invalid")},vacanciesTabBinds:function(){e(document).on("click","#new-vacancy",function(a){a.preventDefault(),a.stopPropagation();var t=teamManagement.levelMaxRange/2,n=window.PLAYER_LEVEL-t;window.PLAYER_LEVEL<=t&&(n=1),n>16&&(n=16);var r=n+teamManagement.levelMaxRange;e("#vacancy-form-container").html(Mustache.render(teamManagement.vacancyTemplate,{teamId:teamManagement.teamId,id:0,age_min:13,age_max:60,gc_level_min:n,gc_level_max:r,observations:""})),teamManagement.initVacancyForm()}),e(document).on("click",".toggle-candidates",function(a){a.preventDefault(),a.stopPropagation(),teamManagement.getCandidates(e(this).data("vacancy-id"))}),e(document).on("click",".remove-vacancy",function(a){a.preventDefault(),a.stopPropagation(),e("#container-modal-remove-vacancy").html(Mustache.render(teamManagement.modalRemoveVacancyTemplate,{vacancyId:e(this).data("vacancy-id"),teamId:teamManagement.teamId})),common.modal.abrirModal("modal-vacancy-remove")}),e(document).on("submit",".remove-vacancy-form",function(a){a.preventDefault(),a.stopPropagation();var t=e(this).prop("action");e.ajax({type:"POST",url:t,success:function(a){e("#modal-vacancy-remove .close-button").trigger("click"),e(".row.panel-content.vacancies[data-vacancy-id="+e("#vacancyId").val()+"]").remove(),e("#vacancy-candidates[data-vacancy-id="+e("#vacancyId").val()+"]").remove(),e(".row.panel-content.vacancies:not([data-vacancy-id="+e("#vacancyId").val()+"])").show(),0==e(".row.panel-content.vacancies").size()&&teamManagement.getVacancies(),notice(a.message)},error:function(e,a,t){var n=e.responseJSON;alert(n.message)}})}),e(document).on("click",".update-vacancy",function(a){a.preventDefault(),a.stopPropagation(),teamManagement.getVacancy(e(this).data("vacancy-id"))}),e(document).on("click","#hide-candidates",function(a){a.preventDefault(),a.stopPropagation(),e("#vacancy-candidates").hide(),e(".vacancies-list-container").hide(),teamManagement.getVacancies(),e(".vacancies-list-container").show()}),e(document).on("click",".return-vacancies",function(a){a.preventDefault(),a.stopPropagation(),e("#vacancy-form-container").hide(),teamManagement.getVacancies(),e("#vacancies-list").show()}),e(document).on("submit","#vacancy-form",function(a){a.preventDefault(),a.stopPropagation();var t="/time/"+teamManagement.teamId+"/vagas";0!=e("#vacancy-form #vacancyId").val()&&(t+="/"+e("#vacancy-form #vacancyId").val()),teamManagement.validateRoles(),e.ajax({type:"POST",url:t,data:e("#vacancy-form :not(.invalid)").serialize(),success:function(a){notice(a.message),e("#vacancy-form-container").hide(),teamManagement.getVacancies(),e("#vacancies-list").show()},error:function(e,a,t){var n=e.responseJSON;alert(n.message)}})}),e(document).on("click",".btn-candidate-actions",function(a){a.preventDefault(),a.stopPropagation(),e("#container-modal-vacancy-candidate").html(Mustache.render(teamManagement.modalVacancyCandidateActionTemplate,{teamId:teamManagement.teamId,vacancyId:e("#vacancy-candidates").data("vacancy-id"),candidateId:e(this).data("candidate-id"),nick:e(this).data("candidate-nick"),approved:e(this).data("candidate-approved"),message:e(this).data("candidate-message")})),common.modal.abrirModal("modal-vacancy-candidate-action")}),e(document).on("click",".btn-candidate-action",function(a){a.preventDefault(),a.stopPropagation();var t=e(this).data("candidate-id"),n=e(this).data("vacancy-id"),r="/time/"+teamManagement.teamId+"/vagas/"+n+"/candidatos/"+t+"/"+e(this).data("action");e.ajax({type:"POST",url:r,success:function(a){e("#modal-vacancy-candidate-action .close-button").trigger("click"),teamManagement.getCandidates(n),notice(a.message)},error:function(e,a,t){var n=e.responseJSON;alert(n.message)}})})},initVacancyForm:function(){e("#vacancies-list").hide(),e("#vacancy-candidates").hide(),e("#vacancy-form-container").show(),teamManagement.initSlider("Age",[13,60],1),teamManagement.initSlider("Level",[1,20],1,teamManagement.levelMaxRange),e(".vacancy-role").select2(teamManagement.roleSelect2Options),0==e("#primaryRole").val()?e("#secondaryRole, #tertiaryRole").prop("disabled",!0):(e("#secondaryRole option[value="+e("#primaryRole").val()+"]").attr("disabled",!0),e("#tertiaryRole option[value="+e("#primaryRole").val()+"]").attr("disabled",!0)),0==e("#secondaryRole").val()?e("#tertiaryRole").prop("disabled",!0):(e("#primaryRole option[value="+e("#secondaryRole").val()+"]").attr("disabled",!0),e("#tertiaryRole option[value="+e("#secondaryRole").val()+"]").attr("disabled",!0)),0!=e("#tertiaryRole").val()&&(e("#primaryRole option[value="+e("#tertiaryRole").val()+"]").attr("disabled",!0),e("#secondaryRole option[value="+e("#tertiaryRole").val()+"]").attr("disabled",!0))},initSlider:function(a,t,n,r){var o=e("#sliderRange"+a),s=e("#sliderRange"+a+"MinInput"),i=e("#sliderRange"+a+"MaxInput"),c="#label"+a;o.slider({range:!0,min:t[0],max:t[1],step:n,values:[s.val(),i.val()],slide:function(a,t){var n=e(this).slider("option","maxRange"),r=t.values[0],o=t.values[1];n&&o-r>n&&(r!=s.val()?(o=r+n,i.val(o),e(this).slider("values",1,o)):o!=i.val()&&(r=o-n,s.val(r),e(this).slider("values",0,r))),teamManagement.sliderRangeUpdateLabel(c,r,o)},change:function(e,a){s.val(a.values[0]),i.val(a.values[1]),teamManagement.sliderRangeUpdateLabel(c,s.val(),i.val())},create:function(e,a){teamManagement.sliderRangeUpdateLabel(c,s.val(),i.val())}}),r&&e(o).slider("option","maxRange",r)},sliderRangeUpdateLabel:function(a,t,n){"#labelAge"==a&&60==n&&(n+="+"),"#labelLevel"==a&&(e(a+"Min").removeClass(),e(a+"Min").addClass("badge level-"+t),e(a+"Max").removeClass(),e(a+"Max").addClass("badge level-"+n)),e(a+"Min").text(t),e(a+"Max").text(n)},parseTemplates:function(){teamManagement.vacancyListTemplate=e("#vacancyListTemplate").html(),teamManagement.vacancyTemplate=e("#vacancyTemplate").html(),teamManagement.candidatesTemplate=e("#vacancyCandidatesTemplate").html(),teamManagement.skillLevelsTemplate=e("#skillLevelsTemplate").html(),teamManagement.modalRemoveVacancyTemplate=e("#vacancyRemoveTemplate").html(),teamManagement.modalVacancyCandidateActionTemplate=e("#vacancyCandidateActionTemplate").html(),Mustache.parse(teamManagement.vacancyListTemplate),Mustache.parse(teamManagement.vacancyTemplate),Mustache.parse(teamManagement.candidatesTemplate),Mustache.parse(teamManagement.skillLevelsTemplate),Mustache.parse(teamManagement.modalRemoveVacancyTemplate),Mustache.parse(teamManagement.modalVacancyCandidateActionTemplate)}},teamManagement.initTabs()}},perfilClan:{init:function(){function a(a){var t=e(a);e.get("/times/getTeamsPaymentSituation/"+team_id,function(e){t.html(e)})}e("#editarCapa").on("click",function(){return e("#editarCapaFile").click(),!1}),e("#editarCapaFile").on("change",function(){var a=new FormData(e("#editarCapaForm")[0]),t=e(this).data("id");return e.ajax({url:"/conta/times/"+t+"/atualizarCapa",type:"POST",data:a,success:function(e){success(e),setTimeout(function(){location.reload(!0)},1e3)},error:function(e){console.error(e),alert("Ocorreu um erro ao atualizar capa. Verifique o tamanho e extensão da imagem!")},cache:!1,contentType:!1,processData:!1}),!1}),e("#editarAvatar").on("click",function(){return e("#editarAvatarFile").click(),!1}),e("#editarAvatarFile").on("change",function(){var a=new FormData(e("#editarAvatarForm")[0]),t=e(this).data("id");return e.ajax({url:"/conta/times/"+t+"/atualizarAvatar",type:"POST",data:a,success:function(e){success(e),setTimeout(function(){location.reload(!0)},1e3)},error:function(e){console.error(e),alert("Ocorreu um erro ao atualizar avatar do time. Verifique a imagem e tente novamente.")},cache:!1,contentType:!1,processData:!1}),!1}),e("#entrarForm").submit(function(a){a.preventDefault();var t=e(this).data("id"),n=e(this).serialize();e.ajax({type:"post",url:"/time/"+t+"/entrar",data:n,success:function(e){"Ok"==e?location.reload(!0):alert(e)},error:function(e){console.error(data),alert("error, try again.")}})}),e("#select-campeonato").on("change",function(){e("#estatisticas").html('<div class="loader-spin" title="Carregando..."></div>'),e("#estatisticas").html();var a=e(this).data("clan-id"),t=e(this).val();e.ajax({url:"/time/estatisticas/"+a+"/"+t,type:"GET",success:function(a){if(a.ok&&"csgo"==a.game){var t="";t='<tr> <td><strong>Jogador</strong></td> <td><span class="bold" title="Kills">K</span></td> <td><span class="bold" title="Assists">A</span></td> <td><span class="bold" title="Deaths">D</span></td> <td><span class="bold" title="Headshots">HS</span></td> <td><span class="bold" title="Porcentagem de Headshots">HS%</span></td> <td><span class="bold" title="Kill/Death Ratio">KDR</span></td> <td><span class="bold" title="Pontos">P</span></td> <td><span class="bold" title="Bombas Defusadas">BD</span></td> <td><span class="bold" title="Bombas Plantadas">BP</span></td> <td><span class="bold" title="Team Kills">TK</span></td> <td><span class="bold" title="Rounds com 1 Kill">1K</span></td> <td><span class="bold" title="Rounds com 2 Kills">2K</span></td> <td><span class="bold" title="Rounds com 3 Kills">3K</span></td> <td><span class="bold" title="Rounds com 4 Kills">4K</span></td> <td><span class="bold" title="Rounds com 5 Kills">5K</span></td> <td><span class="bold" title="First Kill do Round">FK</span></td> <td><span class="bold" title="Clutches">1vsX</span></td></tr>',e.each(a.estatisticas,function(e,a){t+='<tr><td><a class="bold warning-color" href="/jogador/'+a.pID+'">'+a.pNick+"</a></td><td>"+a.kills+"</td><td>"+a.assist+"</td><td>"+a.death+"</td><td>"+a.hs+"</td><td>"+a.pcHS+"</td><td>"+a.kdr+"</td><td>"+a.pontos+"</td><td>"+a.defuse+"</td><td>"+a.bomb+"</td><td>"+a.tk+"</td><td>"+a.k1+"</td><td>"+a.k2+"</td><td>"+a.k3+"</td><td>"+a.k4+"</td><td>"+a.k5+"</td><td>"+a.fk+"</td><td>"+a.clutchs+"</td></tr>"}),e("#estatisticas").html(t)}}})}),window.clan_api={getPendingSubscriptions:a}}},perfil:{init:function(){function a(){e("#AtualizarAvatarSteam").on("click",t)}function t(t){t.preventDefault(),e(this).off("click"),e.ajax({type:"get",url:"/conta/perfil/atualizarAvatarSteam",success:function(e){success(e),setTimeout(function(){location.reload(!0)},800)},error:function(e){alert(ERROR_AVATAR),a()}})}e("#playerUrlCopy").click(function(){var a=new Clipboard("#playerUrlCopy"),t=this;a.on("success",function(a){alert(e(t).data("alert"))})}),e(".tabs-amigos li").click(function(){var a=e(this).data("target");e(".tabs-amigos li").removeClass("active"),e(this).addClass("active"),e(".lista").hide(),e(".lista[data-tab="+a+"]").show()}),e(".gc-profile-featured-box-discover-stats-tab").click(function(){var a=e(this).data("target");e(".gc-profile-featured-box-discover-stats-tab-content, .gc-profile-featured-box-discover-stats-tab").removeClass("active"),e(".gc-profile-featured-box-discover-stats-tab-content[data-tab="+a+"]").addClass("active"),e(this).addClass("active")}),e("#resetTS").click(function(){url=e("#resetTS").data("url"),e.ajax({type:"post",url:url,success:function(e){"Ok"==e?(alert("Resetado com Sucesso!"),location.reload(!0)):alert(e)},error:function(e){alert("error, try again.")}})}),e("#formEmail").submit(function(a){a.preventDefault(),e.ajax({type:"post",url:e("#formEmail").prop("action"),data:e("#formEmail").serialize(),success:function(e){"Ok"==e?location.reload(!0):alert(e)},error:function(e){alert("error, try again.")}})}),e(".getPlayersByIP").on("click",function(a){a.preventDefault(),phId=e(this).data("ph-id"),ip=e(this).data("ip"),e.getJSON("/players/getPlayersByIP/"+ip,function(a){a&&(content="",selector="#ip-"+phId,e.each(a,function(e,a){var t="",n="";1==a.banido&&(t="(conta banida)"),1==a.plVAC&&(n="(conta com VAC)"),content+='<a href="/jogador/'+a.plID+'">'+a.plNick+"</a>",content+=t+" "+n+"<br/>"}),e(selector).empty(),e(selector).append("<p>").append(content).append("</p>"))})}),e(".getIp").on("click",function(a){a.preventDefault(),phId=e(this).data("ph-id"),ip=e(this).data("ip"),e.getJSON("/players/getIPCountry/"+ip,function(a){a&&e("#ip-"+phId).html(a.city+", "+a.country)})});var n=!1;e("#formAtivarMedalha").submit(function(a){a.preventDefault(),self=this,e(self).find(".error").slideUp("fast"),e(self).find(".success").slideUp("fast");var t=e(self).find("input[name=chave]").val();return""===e.trim(t)?(e(self).find(".error").text(INSERT_KEY),e(self).find(".error").slideDown("fast"),void e(self).find("input[name=chave]").focus()):!n&&(!!confirm(KEY_MEDAL_WARNING)&&void e.ajax({type:"POST",url:e(self).prop("action"),data:e(self).serialize(),beforeSend:function(){e("#formAtivarMedalha").attr("disabled","disabled"),n=!0},complete:function(){e("#formAtivarMedalha").removeAttr("disabled"),setTimeout(function(){n=!1},2500)},success:function(a){"Ok"==a?(result='<strong><a href="javascript:location.reload(true);">'+CLICK_TO_CONTINUE+"</a></strong>",e(self).find(".success").html(MEDAL_SUCCESS+" "+result),e(self).find(".success").slideDown("fast")):(e(self).find(".error").html(a),e(self).find(".error").slideDown("fast"))},error:function(e){alert("error, try again.")}}))}),e("#formBanir").submit(function(a){a.preventDefault(),self=this,e(self).find(".error").slideUp("fast"),e(self).find(".success").slideUp("fast");var t=e(self).serialize(),n=e(self).prop("action");e.post(n,t,function(a,t,n){result=' <strong><a href="javascript:location.reload(true);">Clique aqui para recarregar a página</a></strong>',e(self).find(".success").html("O membro foi banido!"+result),e(self).find(".success").slideDown("fast"),e(self).find(".row").slideUp("fast"),setTimeout(function(){location.reload(!0)},2e3)}).fail(function(e){alert(e.responseJSON.message)})}),e("#formHealing").submit(function(a){a.preventDefault(),self=this,e(self).find(".error").slideUp("fast"),e(self).find(".success").slideUp("fast");var t=e(self).serialize(),n=e(self).prop("action");e.post(n,t,function(a,t,n){result=' <strong><a href="javascript:location.reload(true);">Clique aqui para recarregar a página</a></strong>',e(self).find(".success").html("O healing foi adicionado e estará disponível em breve. "+result),e(self).find(".success").slideDown("fast"),e(self).find(".row").slideUp("fast")}).fail(function(e){alert(e.responseJSON.message)})}),e("#formResetReputation").submit(function(a){a.preventDefault(),self=this,e(self).find(".error").slideUp("fast"),e(self).find(".success").slideUp("fast");var t=e(self).serialize(),n=e(self).prop("action");e.post(n,t,function(a,t,n){result=' <strong><a href="javascript:location.reload(true);">Clique aqui para recarregar a página</a></strong>',e(self).find(".success").html("A nova reputação do player estará disponível em alguns minutos."+result),e(self).find(".success").slideDown("fast"),e(self).find(".row").slideUp("fast")}).fail(function(e){alert(e.responseJSON.message)})}),e("#unBan").on("click",function(a){a.preventDefault(),playerId=e(this).data("id"),e.post("/players/gerBan/0/"+playerId,function(e){alert("O ban foi removido! Recarregando a página..."),setTimeout(function(){location.reload(!0)},2e3)}).fail(function(e){alert(e.responseJSON.message)})}),e("#removeLobbyBan").on("click",function(a){a.preventDefault(),playerId=e(this).data("player-id"),banId=e(this).data("ban-id"),e.post("/players/removerBanLobby",{playerId:playerId,banId:banId},function(e,a,t){e.success?alert(e.message):alert("Erro ao remover ban."),setTimeout(function(){location.reload(!0)},1500)})}),e('#gcCoverMenubar [data-jsaction="editarCapa"]').on("click",function(a){a.preventDefault(),e("#editarCapaI").trigger("click")}),e("#editarCapaI").change(function(){e("#editarCapaForm").submit()}),e("#editarCapaForm").submit(function(a){a.preventDefault();var t=new FormData(this);return e.ajax({url:"/conta/perfil/atualizarCapa",type:"POST",data:t,beforeSend:function(){e("#perfilCover").addClass("perfil-cover-loading")},success:function(e){success(e),setTimeout(function(){location.reload(!0)},1e3)},error:function(a){e("#perfilCover").removeClass("perfil-cover-loading");var t=a.responseJSON?a.responseJSON.message:"Ocorreu um erro ao enviar o avatar. Verifique o tamanho da imagem. Limite 1MB";alert(t)},cache:!1,contentType:!1,processData:!1}),!1}),e("#editarAvatar").on("click",function(a){a.preventDefault(),e("#editarAvatarI").trigger("click")}),e("#editarAvatarI").change(function(){e("#editarAvatarForm").submit()}),e("#editarAvatarForm").submit(function(a){a.preventDefault();var t=new FormData(e("#editarAvatarForm")[0]);return e.ajax({url:"/conta/perfil/atualizarAvatarPC",type:"POST",data:t,beforeSend:function(){e("#perfilAvatar").addClass("perfil-avatar-loading")},success:function(e){success(e),setTimeout(function(){location.reload(!0)},800)},error:function(a){e("#perfilAvatar").removeClass("perfil-avatar-loading");var t=a.responseJSON?a.responseJSON.message:"Ocorreu um erro ao enviar o avatar. Verifique o tamanho da imagem. Limite 1MB";alert(t)},cache:!1,contentType:!1,processData:!1}),!1}),a(),e(document).on("click",".download-config",function(a){a.preventDefault(),a.stopPropagation();var t=e(this).data("id"),n="/players/"+t+"/configs/"+e(this).data("config-id");e.ajax({url:n,type:"GET",success:function(e){window.location=e.data.download_link},error:function(e){alert(e.responseJSON.message)}})})}},campeonatos:{init:function(){function a(){e(".campeonato-box").each(function(){var a=e(this).index(),t=e(this).attr("data-campid");ordenar(t,a)}),notice("Processando..."),setTimeout(function(){notice("A ordem dos campeonatos foram alteradas :)")},2500)}staff===!0?(e("div.campeonatos").sortable({appendTo:"campeonatos",containment:"parent",cursor:"move",distance:10,forcePlaceholderSize:!0,forceHelperSize:!0,scroll:!0,opacity:.5,placeholder:"campeonato-box",update:function(e,t){a()}}),e("div.campeonatos").disableSelection()):staff=!1}},assinaturas:{init:function(){}},lobbynova:{init:function(){for(var a=document.getElementById("sidebar-desafios-salas"),t=a.querySelectorAll(".sidebar-item"),n=document.getElementById("sidebar-desafios-team"),r=document.getElementById("lobby-scroll-recomendada"),o={over:function(){var a=document.querySelector(".sidebar-desafios-item-team");if(null===a)return!1;var t=e(this).offset().top-312,r=a.innerHTML,s=a.getAttribute("data-modifiers");n.style.top=t+"px",n.innerHTML=r,o.showTooltip(s)},leave:function(){console.log("leave"),o.hideTooltip()},showTooltip:function(a){n.classList=n.classList=a;var t=n.querySelector(".sala-lineup-players");e(t).scrollbar(),t.addEventListener("scroll",function(e){console.log("scroll"),e.preventDefault()})},hideTooltip:function(){n.classList=n.classList.value.replace("sidebar-desafios-team-active","sidebar-desafios-team-inactive")}},s=t.length-1;s>=0;s--)t[s].addEventListener("mouseenter",o.over),t[s].addEventListener("mouseleave",o.leave);window.lobbynova={partidasRecomendadas:{next:function(){lobbynova.partidasRecomendadas.moveScroll(232)},prev:function(){lobbynova.partidasRecomendadas.moveScroll(-232)},moveScroll:function(e,a){var t=r.querySelector(".sala-card"),n=window.getComputedStyle(t).marginRight.replace(/\D/g,"");e<0&&(n=-n);var o=r.scrollLeft+e+Number(n);return o<0?(r.scrollLeft=0,!1):void(r.scrollLeft=o)},esconder:function(){var e=document.getElementById("lobby-recomendadas-container");e.classList.value.indexOf("lobby-recomendadas-disabled")===-1?e.classList.value+=" lobby-recomendadas-disabled":e.classList.value.replace("lobby-recomendadas-disabled","")}}},e(function(){document.querySelector("[data-jsaction=recomendadasPrev]").addEventListener("click",lobbynova.partidasRecomendadas.prev),document.querySelector("[data-jsaction=recomendadasNext]").addEventListener("click",lobbynova.partidasRecomendadas.next),document.querySelector("[data-jsaction=recomendadasEsconder]").addEventListener("click",lobbynova.partidasRecomendadas.esconder)})}},my_matches:{init:function(){function a(a,s){r||(r=e("#lobbyGameResultsTemplate").html(),Mustache.parse(r)),o||(o=e("#lobbyGameResultsPaginationTemplate").html(),Mustache.parse(o)),a||(a="latest"),s||(s=1),e.getJSON("/players/get_playerLobbyResults/"+a+"/"+s,function(a){for(a.pagination=n(a.pagination,s),a.hasDates=a.selectDates.length>0,i=0;i<a.lista.length;i++){var c=a.lista[i].ranked;"Lobby"!=c?(a.lista[i].ranked="Ranked "+c,a.lista[i].ranked_icon="/ranked/ranked-"+c.toLowerCase()+"-icon@2x.svg"):a.lista[i].ranked_icon="/jogueagora/lobby-icon@2x.svg"}var l=Mustache.render(r,a,{pagination_partial:o});e("#resultados .content-itens-em-lobby").html(l),e("#resultados .mensagem-lobby").hide(),t()}).fail(function(a,t,n){var r="<p class='center'>"+a.responseJSON.message+"</p>";e("#resultados .content-itens-em-lobby").html(r)})}function t(){e("html, body").animate({scrollTop:e("#resultados").offset().top-250},300),e("#dateFilterMatches").change(function(){var t=e(this).val();a(t)})}function n(e,a){var t=+e.pages_total,n=0,r=[];for(n=0;n<t;n++)r.push({page:n+1,on:a===n+1});return e.first=1,e.last=t,e.pages=r,e.hasPagination=t>1,e}var r,o;e("body").on("click","#myMatchesPagination [data-page]",function(){var t=e(this).data("date"),n=e(this).data("page");a(t,n)}),a()}},match:{init:function(){function a(a,t){null==t&&(t=""),e.getJSON("/lobby/demoDownload/"+a+"/"+t,function(e){0==e.success?alert(e.message):window.location.href=e.demo})}window.match={downloadDemo:a},e(function(){e.ajaxPrefilter(function(e,a,t){e.async=!0}),e(document).on("click",".btn-vote .karma-sub-menu li:not(.karma-menu-description), .btn-vote.single-option",function(){e(this).closest(".karma-card").removeClass("thumbs-up thumbs-down"),e(this).closest(".karma-card").addClass(e(this).data("class")),e(this).closest(".karma-card").addClass("selected"),e(this).closest(".karma-card").find("a").removeClass("selected-option"),e(this).closest("a.btn-vote").addClass("selected-option"),e(this).closest(".karma-card").find(".motivo").text(""),e(this).closest(".karma-card").find(".motivo").text(e(this).data("label")),$id=e(this).closest(".karma-card").data("id"),e("#player-"+$id).val(e(this).data("value")),e(this).closest(".karma-sub-menu").css("display","none");var a=e("input.karma-values").filter(function(){return""!=e(this).val()});0==a.length?(e(".karmas-confirmation .btn").removeClass("btn-info"),e(".karmas-confirmation .btn").addClass("btn-grey")):(e(".karmas-confirmation .btn").removeClass("btn-grey"),e(".karmas-confirmation .btn").addClass("btn-info")),a.length>0?(e(".karmas-confirmation").addClass("enabled"),e(".karmas-confirmation span.reports").text(a.length),a.length>1?e(".karmas-confirmation span.plural").show():e(".karmas-confirmation span.plural").hide()):e(".karmas-confirmation span.plural").show()}),e(document).on("click",".limpar-karma",function(a){a.preventDefault(),e("input.karma-values").val(""),e(".karma-description").text(""),e(".btn-vote").removeClass("selected-option"),e(".btn-vote").removeClass("selected-option"),e(".karma-card").removeClass("selected thumbs-down thumbs-up"),e(".karmas-confirmation span.reports").text(0),e(".karmas-confirmation").removeClass("enabled")}),e("#submit-karma-votes").on("click",function(a){a.preventDefault(),e("#karma-report").submit()}),e("#karma-report").submit(function(a){a.preventDefault();var t=e(this),n=t.attr("action"),r=[],o=e("input.karma-values").filter(function(){return""!=e(this).val()});for(i=0;i<o.length;i++)field=o[i],r.push({player_id:e(field).data("id"),karma_type_id:e(field).val()});params={partida_id:e(this).data("partida-id"),votos:r},e.ajax({type:"POST",url:n,contentType:"application/json",data:JSON.stringify(params),success:function(a){success(a),e("#karma-report").remove(),e(".add-friends").show()},error:function(e){alert("Erro ao processar requisição. Verifique os dados e tente novamente.")}})})})}},busca:{init:function(){function a(){var a;skillLevel=e("#skillLevel").text(),skillLevel1=e("#skillLevel1").text(),skillLevel2=e("#skillLevel2").text(),f_jogadores="",f_times="",f_skillLevel="",f_medalha=s.value,f_patente=i.value,n.checked?(e(".search-filters-players").show(),c.checked?f_jogadores=".jogador":f_jogadores=".jogador:not(.banido)"):(e(".search-filters-players").hide(),f_jogadores=".mix:not(.jogador)"),r.checked?f_times=", .time":f_times=".mix:not(.time)"+f_jogadores,".mix"==s.value&&(f_medalha=""),".mix"==i.value&&(f_patente="");var a,t=", ";if(skillLevel1==skillLevel2)f_skillLevel=f_jogadores+".lvl-"+skillLevel+f_medalha+f_patente+" ",a=f_skillLevel;else{skillLevel1=parseInt(skillLevel1),skillLevel2=parseInt(skillLevel2);for(var o=skillLevel1;o<=skillLevel2;o++)o==skillLevel2&&(t=""),f_skillLevel+=f_jogadores+".lvl-"+o+f_medalha+f_patente+t;a=r.checked?f_skillLevel+f_times:f_skillLevel}mixer.filter(a)}function t(a){var t;return t=e(a.url?'<span class="select2-option"><img src="'+a.url+'" width="20" /> '+a.text+"</span>":'<span class="select2-option">'+a.text+"</span>")}var n=document.getElementById("search-filters-players"),r=document.getElementById("search-filters-teams"),o=document.getElementById("current-level-filter"),s=document.querySelector("#medalhas"),i=document.querySelector("#patentes"),c=document.getElementById("search-filters-banned");n.addEventListener("change",a,!1),r.addEventListener("change",a,!1),c.addEventListener("change",a,!1),o.addEventListener("change",a,!1),e(s).on("change",a),e(i).on("change",a),e("#slider-range").slider({range:!0,min:1,max:20,values:[1,20],create:function(e,a){},slide:function(a,t){t.values[0]==t.values[1]?e("#current-level-filter").html("<span id='skillLevel'>"+t.values[0]+"</span>"):e("#current-level-filter").html("<span id='skillLevel1'>"+t.values[0]+"</span> - <span id='skillLevel2'>"+t.values[1]+"</span>")},stop:function(){a()}});var l=[{id:".mix",text:"Todas",selected:!0},{id:".medalha-1",text:"Staff Gamers Club",url:"/images/medalhas/1.png"},{id:".medalha-12",text:"Staff Games Academy",url:"/images/medalhas/12.png"},{id:".medalha-11",text:"Assinante Premium",url:"/images/medalhas/11.png",value:".blue"},{id:".medalha-19",text:"Assinante Plus",url:"/images/medalhas/19.png",value:".blue"},{id:".medalha-17",text:"Assinante Argentina",url:"/images/medalhas/17.png",value:".blue"}];e("#medalhas").select2({placeholder:"Escolha uma medalha",width:"100%",tags:!1,multiple:!1,data:l,templateResult:t,templateSelection:t,containerCssClass:"search-filter-select2",minimumResultsForSearch:-1});var d=[{id:".mix",text:"Todas",selected:!0},{id:".sem-patente",text:"Sem patente",url:"/assets/images/patentes/patenteless.png"},{id:".patente-2",text:"Bronze 3",url:"/assets/images/patentes/bronze_3.png"},{id:".patente-3",text:"Bronze 2",url:"/assets/images/patentes/bronze_2.png"},{id:".patente-4",text:"Bronze 1",url:"/assets/images/patentes/bronze_1.png"},{id:".patente-5",text:"Prata 3",url:"/assets/images/patentes/prata_3.png"},{id:".patente-6",text:"Prata 2",url:"/assets/images/patentes/prata_2.png"},{id:".patente-7",text:"Prata 1",url:"/assets/images/patentes/prata_1.png"},{id:".patente-8",text:"Ouro 3",url:"/assets/images/patentes/ouro_3.png"},{id:".patente-9",text:"Ouro 2",url:"/assets/images/patentes/ouro_2.png"},{id:".patente-10",text:"Ouro 1",url:"/assets/images/patentes/ouro_1.png"},{id:".patente-11",text:"Diamante",url:"/assets/images/patentes/diamante.png"},{id:".patente-12",text:"Lenda",url:"/assets/images/patentes/pro.png"}];e("#patentes").select2({placeholder:"Escolha uma patente",width:"100%",tags:!1,multiple:!1,data:d,templateResult:t,templateSelection:t,containerCssClass:"search-filter-select2",minimumResultsForSearch:-1})}},premios:{init:function(){function a(a){var t;return t=e(a.url?'<span class="select2-option"><img src="'+a.url+'" width="35" /> '+a.text+"</span>":'<span class="select2-option">'+a.text+"</span>")}function t(e){return e==yearSelected}var n=e("#filterTournament").data("select-itens");e("#filterTournament").select2({placeholder:"Escolha uma liga",width:"100%",tags:!1,multiple:!1,data:n,templateResult:a,templateSelection:a,minimumResultsForSearch:-1}),e("#filterTournament").on("change",function(){var a=e(this).val().split("_");a.length>1?(e("#filterEventId").val(a[1]),e("#filterType").val(a[0])):(e("#filterEventId").val(0),e("#filterType").val("todos"))}),e("#filterTournament").change(),e("#filterMonth").select2({placeholder:"Escolha um mês",width:"100%",tags:!1,multiple:!1,data:months,minimumResultsForSearch:-1});for(var r=e("#filterYear").data("select-itens"),o=0;o<r.length;o++)r[o].selected=t(r[o].id);e("#filterYear").select2({placeholder:"Escolha um ano",width:"100%",tags:!1,multiple:!1,data:r,minimumResultsForSearch:-1})}},accountSettings:{init:function(){subscriptions={getSubscriptionDetail:function(a){var t="#subscription-"+a,n="/assinatura/getTransactions/"+a;e(t).slideToggle("fast",function(){invoiceTemplate=e("#invoiceTemplate").html(),Mustache.parse(invoiceTemplate),e(t).is(":hidden")||e.getJSON(n,function(a){0==a.length?e(t).html('<div class="columns medium-12 content-div carregando"><label class="warning">'+i18n.subs_no_data_invoice+"</label></div>"):(e.each(a,function(e,a){a.payment_method="credit_card"==a.payment_method?"Cartão de Crédito":"Boleto","canceled"===a.subscriptionStatus?(a.isPaid=!0,"paid"!==a.status&&"refunded"!==a.status?a.status=a.statusLabels.canceled:a.status=a.statusLabels[a.status]):a.status=a.statusLabels[a.status],a.invoiceAvailable=a.invoice&&(1==a.invoice.status||4==a.invoice.status||5==a.invoice.status),a.date_created&&(a.date_created=new Date(a.date_created).toLocaleString("pt-BR"))}),e(t).html(Mustache.render(invoiceTemplate,{items:a})))})})},getItemsDetails:function(a){var t="#purchased-item-detail-"+a,n="payments/payment-item-transactions/"+a;e(t).slideToggle("fast",function(){invoiceTemplate=e("#purchasedItemDetailTemplate").html(),Mustache.parse(invoiceTemplate),e(t).is(":hidden")||e.getJSON(n,function(a){0===a.length?e(t).html('<div class="columns medium-12 content-div carregando"><label class="warning">'+i18n.subs_no_data_invoice+"</label></div>"):(e.each(a,function(e,a){switch(a.isPaymentCard="card"===a.payment_method,a.isPaymentBillet="billet"===a.payment_method,a.canPrintBillet=!1,a.operation_status){case"paid":a.operation_status="Pago";break;case"refunded":a.operation_status="Estornado";break;case"refused":a.operation_status="Recusado";break;default:a.canPrintBillet=!0,a.operation_status="Pendente"}a.invoiceAvailable=a.invoice&&(1==a.invoice.status||4==a.invoice.status||5==a.invoice.status),a.date_created&&(a.date_created=new Date(a.date_created).toLocaleString("pt-BR"))}),e(t).html(Mustache.render(invoiceTemplate,{items:a})))}).fail(function(a,n,r){e(t).html('<div class="columns medium-12 content-div carregando"><label class="warning">'+i18n.subs_no_permission+"</label></div>")})})},cancelSubscriptionStep1:function(){subscriptions.toogleSubscriptionCancellation(),subscriptions.scrollTopScreen()},talkSupportCancellation:function(){$crisp.push(["do","chat:open"]),intercomHelp.hide(),this.toogleSubscriptionCancellation(),subscriptions.scrollTopScreen()},cancellationWithFeedback:function(){window.open("https://cancelamento.gamersclub.com.br/","_blank"),this.toogleSubscriptionCancellationStep(),subscriptions.scrollTopScreen()},cancellationWithoutFeedback:function(){this.toogleSubscriptionCancellationStep(),subscriptions.scrollTopScreen()},giveUpCancelation:function(){this.toogleSubscriptionCancellation(),this.toogleSubscriptionCancellationStep(),
subscriptions.scrollTopScreen(),e(".feedback-cancellation").hide()},confirmCancelSubscription:function(a){e.post("/assinatura/cancel",{id:a},function(a){a.success?(e(".feedback-header").text(i18n.subscription_cancelement_success),e(".feedback-text").text(i18n.goodbye_message),e(".feedback-cancellation").show(),subscriptions.toogleSubscriptionCancellation(),subscriptions.scrollTopScreen()):(e(".feedback-header").text(i18n.ops_problem),e(".feedback-text").text(i18n.subscription_cancelement_fail),e(".feedback-cancellation").show())},"json").fail(function(){e(".feedback-header").text(i18n.ops_problem),e(".feedback-text").text(i18n.subscription_cancelement_fail),e(".feedback-cancellation").show()})},toogleSubscriptionCancellation:function(){e(".subscription-cancel").toggle(),e(".current-sub").toggle(),e(".without-sub").toggle(),e(".history-subs").toggle()},toogleSubscriptionCancellationStep:function(){e(".subscription-cancel-content-step-1").toggle(),e(".subscription-cancel-content-step-2").toggle()},scrollTopScreen:function(){var a=e("html, body"),t=e("#account-subscriptions").position().top-90;a.stop().animate({scrollTop:t},300,"swing")}};var a={init:function(){e("#languageSelect").select2({placeholder:"Selecione uma função",width:"100%",tags:!1,multiple:!1,templateResult:a.flagsTemplateResult,templateSelection:a.flagsTemplateResult,minimumResultsForSearch:-1}),e("#languageSelect").on("select2:select",function(e){var a=e.params.data.id,t=window.location.hash,n="/gerenciar?lang="+a+t;console.log(n),window.location.replace(n)})},flagsTemplateResult:function(a){return e('<img src="/assets/images/flags/traducao/'+a.id+'.png" width="25" style="margin-right: 5px" /><span class="select2-option select2-role-label">'+a.text+"</span>")}};a.init()}},discover:{init:function(){e("#discoverTabs .big-tabs-tab[data-tab]").click(function(){e("#discoverTabs .big-tabs-tab-enabled").removeClass("big-tabs-tab-enabled"),e(this).addClass("big-tabs-tab-enabled")})}}},t={fire:function(e,t,n){var r=a;t=void 0===t?"init":t,""!==e&&r[e]&&"function"==typeof r[e][t]&&r[e][t](n)},loadEvents:function(){t.fire("common"),e.each(document.body.className.replace(/-/g,"_").split(/\s+/),function(e,a){t.fire(a)})}};e(document).ready(t.loadEvents)}(jQuery);
//# sourceMappingURL=maps/main.min.js.map
