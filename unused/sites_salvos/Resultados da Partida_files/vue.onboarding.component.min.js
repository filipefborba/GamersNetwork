Vue.component("onboarding",{template:"#vue-onboarding-component-template",components:{"gc-loader":{name:"gc-loader",template:"#vue-loader-component-template"}},data:function(){return{playerOnboarding:null,isOpen:!1,currentStep:null,currentStepIndex:null,showCloseOptions:!1,steps:[],showPendingStep:!1}},watch:{isOpen:{handler:function(t){this.setLocalStorage("onboardingIsOpen",t)}},currentStepIndex:{handler:function(t){this.currentStep=this.steps[t];var n=this.getLocalStorage("onboardingTempPending");return n?(this.showPendingStep=!0,this.currentStep.status=n,void this.removeLocalStorage("onboardingTempPending")):("finished"===this.currentStep.id&&this.setFinishedOnboarding(),void this.updateCurrentStep())}}},created:function(){this.ONBOARDING_STEP_STATUS_PENDING="pending",this.ONBOARDING_STEP_STATUS_SUCCESS="success",this.ONBOARDING_STEP_STATUS_ERROR="error",this.DAYS_TO_REMEMBER_ONBOARDING=2,this.steps=[{id:"intro",canNext:!0},{id:"profile",status:null,canNext:!1,video:"/assets/videos/onboarding/profile.webm"},{id:"steam",canNext:!0,video:"/assets/videos/onboarding/steam.webm"},{id:"ac",status:null,canNext:!1,video:"/assets/videos/onboarding/ac.webm"},{id:"cs",canNext:!0,video:"/assets/videos/onboarding/cs.webm"},{id:"tournaments",canNext:!0,video:"/assets/videos/onboarding/tournaments.webm"},{id:"ga",canNext:!0,video:"/assets/videos/onboarding/ga.webm"},{id:"casual",status:null,canNext:!1,video:"/assets/videos/onboarding/casual.webm"},{id:"lobby",status:null,canNext:!1,video:"/assets/videos/onboarding/lobby.webm"},{id:"subscription",canNext:!0,video:"/assets/videos/onboarding/subscription.webm"},{id:"finished",canNext:!1,video:"/assets/videos/onboarding/finished.webm"}]},mounted:function(){this.$parent.bus.$on("openOnboardingByNav",this.setUnhideOnboarding),this.$parent.bus.$on("openOnboardingByLocalStorage",this.open)},methods:{getOnboardingPlayer:function(){var t="/onboarding/player";axios.post(t).then(function(t){this.playerOnboarding=t.data,this.currentStepIndex=parseInt(this.playerOnboarding.current_step,10),this.updateStepsStatus(),"1"===this.playerOnboarding.hide_onboarding&&this.hide()}.bind(this))["catch"](function(){this.playerOnboarding=null}.bind(this))},updateStepsStatus:function(){this.steps.forEach(function(t,n){"undefined"!=typeof t.status&&"0"!==this.playerOnboarding[t.id+"_checked"]&&(this.steps[n].canNext=!0,this.steps[n].status=this.ONBOARDING_STEP_STATUS_SUCCESS)}.bind(this))},updateCurrentStep:function(){if(this.playerOnboarding.current_step!==this.currentStepIndex.toString()){this.playerOnboarding.current_step=this.currentStepIndex.toString();var t="/onboarding/step";axios.post(t,{step:this.currentStepIndex})}},setFinishedOnboarding:function(){if(this.playerOnboarding&&null===this.playerOnboarding.finished_at){var t="/onboarding/finish";axios.post(t).then(function(){this.playerOnboarding.finished_at=new Date})}},setHideOnboarding:function(){this.setLocalStorage("onboardingIsOpen","false");var t="/onboarding/hide";axios.post(t)},setHideTemporarilyOnboard:function(){var t=this.DAYS_TO_REMEMBER_ONBOARDING,n=(new Date).getTime()+864e5*t;this.setLocalStorage("onboardingHideUntil",n)},setUnhideOnboarding:function(){this.onboardingEventWithoutStep("unhide");var t="/onboarding/unhide";axios.post(t).then(function(){this.open()}.bind(this))},open:function(){this.isOpen=!0,this.showCloseOptions=!1,this.playerOnboarding||(this.getOnboardingPlayer(),this.onboardingEventWithoutStep("open")),window.addEventListener("keydown",this.closeOnEsc)},hide:function(t){this.isOpen=!1;var n="hide";"undefined"!=typeof t&&("not_show_anymore"===t?this.setHideOnboarding():"remember_later"===t&&(this.setHideTemporarilyOnboard(),n+="_"+t)),this.onboardingEventWithoutStep(n),window.removeEventListener("keydown",this.closeOnEsc)},closeOnEsc:function(t){27===t.keyCode&&this.hide("remember_later")},nextStep:function(){this.currentStepIndex+2>this.steps.length||(this.onboardingEvent("next"),this.currentStepIndex+=1)},nextStepWithEvent:function(t){this.onboardingEvent(t),this.nextStep()},prevStep:function(){0!==this.currentStepIndex&&(this.onboardingEvent("prev"),this.currentStepIndex-=1)},inProgressStatusAndRedirect:function(t){this.setLocalStorage("onboardingTempPending",this.ONBOARDING_STEP_STATUS_PENDING),this.onboardingEvent("progress"),window.location.href=t},updateStepStatusOnArray:function(t,n){this.steps.map(function(e,i){return e.id===t&&(this.steps[i].canNext=!0,this.steps[i].status=n),e}.bind(this))},verifyProfile:function(){var t="/onboarding/verify-profile";this.onboardingEvent("verify"),axios.post(t).then(function(){this.showPendingStep=!1,this.updateStepStatusOnArray("profile",this.ONBOARDING_STEP_STATUS_SUCCESS),this.nextStep()}.bind(this))},verifyCasual:function(){if(this.currentStep.locked)return void alert(i18n.onboarding_wait_to_retry);this.onboardingEvent("verify");var t="/onboarding/verify-casual";axios.post(t).then(function(){this.showPendingStep=!1,this.updateStepStatusOnArray("casual",this.ONBOARDING_STEP_STATUS_SUCCESS),this.nextStep()}.bind(this))["catch"](function(){alert(i18n.onboarding_error_validation_casual),Vue.set(this.currentStep,"locked",!0),setTimeout(function(){Vue["delete"](this.currentStep,"locked")}.bind(this),3e3)}.bind(this))},verifyLobby:function(){if(this.currentStep.locked)return void alert(i18n.onboarding_wait_to_retry);this.onboardingEvent("verify");var t="/onboarding/verify-lobby";axios.post(t).then(function(){this.showPendingStep=!1,this.updateStepStatusOnArray("lobby",this.ONBOARDING_STEP_STATUS_SUCCESS),this.nextStep()}.bind(this))["catch"](function(){alert(i18n.onboarding_error_validation_lobby),Vue.set(this.currentStep,"locked",!0),setTimeout(function(){Vue["delete"](this.currentStep,"locked")}.bind(this),3e3)}.bind(this))},verifyAntiCheat:function(){switch(this.currentStep.status){case this.ONBOARDING_STEP_STATUS_PENDING:return void alert(i18n.onboarding_wait_validation_ac);case this.ONBOARDING_STEP_STATUS_ERROR:return void alert(i18n.onboarding_wait_to_retry);case this.ONBOARDING_STEP_STATUS_SUCCESS||"1"===playerOnboarding.ac_checked:return void this.nextStep();default:this.currentStep.status=this.ONBOARDING_STEP_STATUS_PENDING}this.onboardingEvent("verify");var t="/onboarding/verify-ac";axios.post(t).then(function(){this.currentStep.canNext=!0,this.currentStep.status=this.ONBOARDING_STEP_STATUS_SUCCESS}.bind(this))["catch"](function(){alert(i18n.onboarding_error_validation_ac),this.currentStep.status=this.ONBOARDING_STEP_STATUS_ERROR,setTimeout(function(){this.currentStep.status=null}.bind(this),3e3)}.bind(this))},callSupport:function(){this.hide(),this.onboardingEvent("support"),$crisp.push(["do","chat:open"])},getLocalStorage:function(t){return localStorage.getItem(t+"_"+window.PLAYERID)},setLocalStorage:function(t,n){return localStorage.setItem(t+"_"+window.PLAYERID,n)},removeLocalStorage:function(t){return localStorage.removeItem(t+"_"+window.PLAYERID)},onboardingEvent:function(t){dataLayer.push({event:"onboarding_"+this.currentStep.id+"_"+t})},onboardingEventWithoutStep:function(t){dataLayer.push({event:"onboarding_"+t})}}}),$(function(){var t=new Vue({el:"#onboarding-widget",data:{bus:new Vue}});window.openOnboardingByNav=function(){localStorage.removeItem("onboardingHideUntil_"+window.PLAYERID),t.bus.$emit("openOnboardingByNav"),$(".icon-dropdown").removeClass("active"),$(".menu-dropdown").removeClass("show")};var n=localStorage.getItem("onboardingIsOpen_"+window.PLAYERID),e=localStorage.getItem("onboardingHideUntil_"+window.PLAYERID);if(null===n||"true"===n){if(window.location.hash&&"#onboarding"===window.location.hash)return;localStorage.removeItem("onboardingHideUntil_"+window.PLAYERID),t.bus.$emit("openOnboardingByLocalStorage")}else if("false"===n&&null!==e){var i=(new Date).getTime();e=parseInt(e,10),"Invalid Date"===new Date(e)||window.isNaN(new Date(e))||i>e&&(localStorage.removeItem("onboardingHideUntil_"+window.PLAYERID),t.bus.$emit("openOnboardingByLocalStorage"))}});
//# sourceMappingURL=maps/vue.onboarding.component.min.js.map
