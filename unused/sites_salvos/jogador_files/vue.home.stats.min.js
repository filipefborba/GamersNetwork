var plID,skillLevelChartWidget={max:0,min:0,total:0,levelUp:0,levelDown:0,ratingUp:0,ratingDown:0,levelAVG:0,currentLevel:0,usedMatches:[],unusedMatches:[],unusedPadding:[],colors:{level:"rgb(35, 125, 185)",black:"rgb(0, 0, 0)",green:"rgb(160, 190, 0)",gray:"rgb(80, 80, 80)",red:"rgb(250, 50, 60)"},colorsAlpha:{level:"rgba(35, 125, 185, 0.05)",black:"rgba(0, 0, 0, 0.05)",green:"rgba(160, 190, 0, 0.05)",gray:"rgba(80, 80, 80, 0.05)",red:"rgba(250, 50, 60, 0.05)",transparent:"rgba(0, 0, 0, 0)"},resetChart:function(){this.max=0,this.min=0,this.total=0,this.levelUp=0,this.currentLevel=0,this.levelDown=0,this.ratingUp=0,this.ratingDown=0,this.levelAVG=0,this.usedMatches=[],this.unusedMatches=[],this.unusedPadding=[]},setUsedMatches:function(t){for(i=0;i<t.length;i++)i<this.unusedMatches.length-1?(this.usedMatches.push(NaN),this.unusedPadding.push(NaN)):(this.total+=t[i],this.usedMatches.push(t[i]))},setUnusedMatches:function(t){12==t.length?this.unusedMatches=t.slice(0,5):t.length<=8?this.unusedMatches=[]:this.unusedMatches=t.slice(0,t.length-8)},setLimits:function(t){t.actual&&t.actual.level&&t.actual.level<0&&(t.next.level=t.actual.level,t.previous.level=t.actual.level),this.currentLevel=t.actual&&t.actual.level?t.actual.level:0,t.next.min_rating>0&&t.next.max_rating>0&&null!=t.next.level?(this.max=parseInt(t.next.min_rating+10),this.levelUp=parseInt(t.next.min_rating),this.ratingUp=parseInt(t.next.min_rating)):t.actual&&(this.max=parseInt(t.actual.rating+50),this.levelUp=NaN,this.ratingUp=parseInt(t.actual.rating+50)),t.previous.min_rating>0&&t.previous.max_rating>0&&null!=t.previous.level?(this.min=parseInt(t.previous.max_rating-10),this.levelDown=parseInt(t.previous.max_rating),this.ratingDown=parseInt(t.previous.max_rating)):(t.actual?(this.min=parseInt(t.actual.rating),this.ratingDown=parseInt(t.actual.rating)):(this.min=-20,this.ratingDown=-20),this.levelDown=0),0==this.currentLevel&&(this.max=Math.max.apply(Math,this.usedMatches),this.levelUp=this.max-300,this.levelDown=NaN,this.ratingDown=NaN),0==this.levelDown&&(this.min=Math.min.apply(Math,this.unusedMatches),this.levelDown=this.min,this.ratingDown=this.min,this.levelAVG=this.min)},roundMaxAndMin:function(t){for(i=0;i<t.length;i++)t[i]<this.min&&(t[i]=this.min),t[i]>this.max&&(t[i]=this.max)},debug:function(){for(var t in this)console.log(t,this[t])},render:function(t,e,i){function a(t){var e=t.getDatasetMeta(3),i=t.getDatasetMeta(4),a=t.getDatasetMeta(5),s=document.getElementById("currentLevelContainer"),r=document.getElementById("nextLevelContainer"),n=document.getElementById("prevLevelContainer"),o=e.data[e.data.length-1]._view.y+"px",l=i.data[i.data.length-1]._view.y/2+"px";if(n){var h=a.data[a.data.length-1]._view.y,d=a.dataset._chart.chartArea.bottom,c=d-20-h,p=h+c/2-n.children[0].clientHeight/2+"px";n.style.top=p}s.style.top=o,r.style.top=l}this.resetChart(),this.setUnusedMatches(t),this.setUsedMatches(t),this.setLimits(i),this.levelAVG=Math.floor(this.total/8),this.levelAVG>=this.ratingUp?this.levelAVG=this.ratingUp-1:this.levelAVG<=this.ratingDown&&(this.levelAVG=this.ratingDown+1),this.roundMaxAndMin(this.unusedMatches),this.roundMaxAndMin(this.usedMatches);var s=function(t){var e=document.getElementById("chartjs-tooltip");if(e||(e=document.createElement("div"),e.id="chartjs-tooltip",e.innerHTML="<div>Carregando. Por favor, espere...</div>",this._chart.canvas.parentNode.appendChild(e)),0===t.opacity)return e.style.opacity=0,void(e.innerHTML="<div>Carregando. Por favor, espere...</div>");if(e.classList.remove("above","below","no-transform"),t.yAlign?e.classList.add(t.yAlign):e.classList.add("no-transform"),t.body){var i,a,s,r,n,o=t.title||[],l="<div>",h=e.querySelector("div");o.forEach(function(t){""!==h.innerHTML&&"Carregando. Por favor, espere..."!==h.innerHTML||$.getJSON("/lobby/partida/"+t+"/1").success(function(t){teamAname=t.time_a,teamBname=t.time_b,i=parseInt(t.jogos.score_a),a=parseInt(t.jogos.score_b),teamAplayers=t.jogos.players.team_a,teamBplayers=t.jogos.players.team_b;for(var e=!1,o=0;o<teamAplayers.length&&!e;o++)if(teamAplayers[o]&&teamAplayers[o].player.id===plID){e=!0;break}for(var l=!1,h=0;h<teamAplayers.length&&!l;h++)if(teamBplayers[h]&&teamBplayers[h].player.id===plID){l=!0;break}i>a?(teamAcolor="green",teamBcolor="red"):(teamAcolor="red",teamBcolor="green"),e?(r='<span class="isonteam">'+teamAname+"</span>",n=teamBname):(n='<span class="isonteam">'+teamBname+"</span>",r=teamAname),s=r+' <span class="'+teamAcolor+'">'+i+'</span> <span class="versus">vs</span> <span class="'+teamBcolor+'">'+a+"</span> "+n}).then(function(){l+="<span>"+s+"</span>",l+="</div>",h.innerHTML=l})})}var d=this._chart.canvas.offsetTop,c=this._chart.canvas.offsetLeft;e.style.opacity=1,e.style.left=c+t.caretX+"px",e.style.top=d+t.caretY+"px",e.style.fontFamily=t._bodyFontFamily,e.style.fontSize="14px",e.style.fontStyle=t._bodyFontStyle,e.style.padding="20px",e.style.width="fit-content",e.style.textAlign="center"},r=document.getElementById("js-skill-level").getContext("2d"),n=new Chart(r,{type:"line",data:{labels:e,datasets:[{data:[NaN,NaN,NaN,this.ratingUp,this.ratingUp,this.ratingUp,this.ratingUp,this.ratingUp,this.ratingUp,this.ratingUp,this.ratingUp,this.ratingUp],fill:"top",backgroundColor:this.colorsAlpha.transparent,borderWidth:1,borderColor:this.colors.transparent,pointBorderWidth:0,pointRadius:0,pointHoverRadius:0},{data:[NaN,NaN,NaN,this.ratingDown,this.ratingDown,this.ratingDown,this.ratingDown,this.ratingDown,this.ratingDown,this.ratingDown,this.ratingDown,this.ratingDown],fill:"top",backgroundColor:this.colorsAlpha.transparent,borderWidth:1,borderColor:this.colors.transparent,pointBorderWidth:0,pointRadius:0,pointHoverRadius:0},{data:this.usedMatches,fill:!1,backgroundColor:this.colorsAlpha.green,borderColor:this.colors.green,borderWidth:1,pointBackgroundColor:this.colors.green,pointBorderWidth:0,pointRadius:3,pointHoverRadius:7},{data:this.unusedPadding.concat([this.levelAVG,this.levelAVG,this.levelAVG,this.levelAVG,this.levelAVG,this.levelAVG,this.levelAVG,this.levelAVG]),fill:!1,backgroundColor:this.colorsAlpha.level,borderColor:this.colors.level,borderWidth:2,pointBackgroundColor:this.colors.level,pointBorderWidth:0,pointRadius:0,pointHoverRadius:0},{data:this.unusedPadding.concat([this.levelUp,this.levelUp,this.levelUp,this.levelUp,this.levelUp,this.levelUp,this.levelUp,this.levelUp]),fill:"top",backgroundColor:this.colorsAlpha.green,borderWidth:2,borderColor:this.colors.green,pointBorderWidth:0,pointRadius:0,pointHoverRadius:0},{data:this.unusedPadding.concat([this.levelDown,this.levelDown,this.levelDown,this.levelDown,this.levelDown,this.levelDown,this.levelDown,this.levelDown]),backgroundColor:this.colorsAlpha.red,borderWidth:2,borderColor:this.colors.red,pointBorderWidth:0,pointRadius:0,pointHoverRadius:0},{data:this.unusedMatches,fill:!1,borderColor:this.colors.gray,borderWidth:1,pointBackgroundColor:this.colors.gray,pointBorderWidth:0,pointRadius:3,pointHoverRadius:7},{data:[this.max,this.max,this.max,this.max,this.max],backgroundColor:this.colorsAlpha.black,borderWidth:0,borderColor:this.colorsAlpha.transparent,pointBorderWidth:0,pointRadius:0,pointHoverRadius:0}]},options:{maintainAspectRatio:!1,legend:!1,tooltips:{enabled:!1,mode:"index",position:"nearest",custom:s},scales:{xAxes:[{gridLines:!1,ticks:{display:!1}}],yAxes:[{gridLines:!1,scaleLabel:!1,ticks:{display:!1,maxTicksLimit:4,min:this.min,max:this.max}}]},animation:{duration:0,onComplete:function(){a(this)}},layout:{padding:{top:15,left:15,right:15,bottom:15}},hover:{onHover:function(t){var e=this.getElementAtEvent(t);e.length?t.target.style.cursor="pointer":t.target.style.cursor="default"}}}});document.getElementById("js-skill-level").onclick=function(t){var e,i,a=n.getElementsAtEvent(t),s=a[0];n.data.labels[s._index]&&(e=n.data.labels[s._index],i=n.data.datasets[s._datasetIndex].data[s._index]),window.open("https://gamersclub.com.br/lobby/partida/"+e,"_blank")}}},chart_colors_ratio_1_2={0:"#FF0300",30:"#FF0300",40:"#EBD200",50:"#92AA00",60:"#92AA00",70:"#92AA00",80:"#92AA00",100:"#92AA00"},chart_colors_ratio_2_3={0:"#00BCD4",30:"#00BCD4",40:"#00BCD4",50:"#00BCD4",60:"#00BCD4",70:"#00BCD4",80:"#00BCD4",100:"#00BCD4"},chart_colors_ratio_3_4={0:"#2196F3",30:"#2196F3",40:"#2196F3",50:"#2196F3",60:"#2196F3",70:"#2196F3",80:"#2196F3",100:"#2196F3"},chart_colors_ratio_4_5={0:"#5C6BC0",30:"#5C6BC0",40:"#5C6BC0",50:"#5C6BC0",60:"#5C6BC0",70:"#5C6BC0",80:"#5C6BC0",100:"#5C6BC0"};Vue.component("player-stats-component",{props:["player_id","current_player_id","locale"],template:"#player-stats-component",data:function(){return{component_id:"widget-player-id-"+this.player_id,selectedServer:null,selectedPeriod:null,selectedPeriodValue:null,kd_ratio:0,kd_ratio_percent:0,ratings:[],matchIds:[],periods:[],servers:[],featured:[],secondary:[],hit_box_url:null,player:null,isSubscriber:!1,isLoading:!0,isPlus:!1,isCasual:!1,isLobby:!1,isLoaded:!1,isEmptyData:!0,hideComponent:!1,background:null,ratings_levels:null,dynamicComponent:{template:"#skill-level-template-vue",props:["level"]}}},created:function(){this.initComponent(),this.isLoading=!1,plID=this.player_id},watch:{selectedServer:{handler:function(t,e){this.selectedServer=t,this.isLobby=this.selectedServer.includes("COMPETITIVO")||!this.isSubscriber,this.selectedServer.includes("COMPETITIVO")||!this.isSubscriber?this.isCasual=!1:this.isCasual=!0,this.isLoading||e==t||this.filter()}},selectedPeriod:{handler:function(t,e){this.selectedPeriod=t,this.isLoading||e==t||this.filter()}}},methods:{initComponent:function(){var t="/api/statistics/"+this.player_id+"/search/"+this.current_player_id+"/"+this.locale;axios.post(t).then(function(t,e){this.parseSearchResponse(t.data),this.parsePlayerResponse(t.data),this.identifySubscriber(),this.rebuildChart(),this.isLoaded=!0}.bind(this))},rebuildChart:function(){this.createChart("#"+this.component_id+" .pl-stats-kd-chart",this.kd_ratio_percent),this.isLobby&&this.createRatingChart(this.ratings,this.matchIds,this.ratings_levels)},filter:function(){this.isLoading=!0;var t="/api/statistics/"+this.player_id+"/search/"+this.current_player_id+"/"+this.locale;axios.post(t,{server:this.selectedServer,period:this.selectedPeriod}).then(function(t){this.parseSearchResponse(t.data),this.rebuildChart(),this.isLoading=!1}.bind(this))},parseSearchResponse:function(t){null!=t.custom_background&&(this.background="background-image: url(/"+t.custom_background+") !important;"),this.isSubscriber=t.is_subscriber,this.periods=t.periods,this.servers=t.servers,this.featured=t.featured,this.secondary=t.secondary,this.kd_ratio=t.kd_ratio,this.kd_ratio_percent=t.kd_ratio_percent,this.hit_box_url=this.parseHitbox(t.hit_box),this.ratings=t.player_rating,this.matchIds=t.player_matches_ids,this.ratings_levels=t.player_info.previous_next_level,this.isEmptyData=0==this.servers.length&&0==this.periods.length;var e=this.selectedPeriod,a=this.periods,s=a.find(function(t){return t.key==e});if(this.current_player_id!=this.player_id&&this.isEmptyData&&(this.hideComponent=!0),s?this.selectedPeriodValue=s.value:!this.selectedPeriod&&this.periods.length&&(this.selectedPeriod=this.periods[0].key,this.selectedPeriodValue=this.periods[0].value),gameValues=this.servers.map(function(t,e){return t.key}),!this.selectedServer&&this.servers.length||!gameValues.contains(this.selectedServer)){for(i=0;i<this.servers.length;i++){var r=this.servers[i];if("key"in r&&void 0==this.selectedServer){this.selectedServer=r.key;break}this.selectedServer=null}this.servers.length&&(this.selectedServer=this.servers[0].key)}},calcHitBoxArea:function(t,e){return parseFloat(t)>0&&parseFloat(e)>0?(bodyHits=parseFloat(t).toFixed(2),bodyTotal=parseFloat(e/3).toFixed(2),(bodyHits/bodyTotal).toFixed(2)):0},parseHitbox:function(t){if(!this.isSubscriber)return null;var e="/assets/images/player_stats/boneco/boneco-cores.svg",i="";if(Object.keys(t).length>0){var a=parseFloat(t.headshots.value)+parseFloat(t.chest.value)+parseFloat(t.left_arm.value)+parseFloat(t.right_arm.value)+parseFloat(t.stomach.value)+parseFloat(t.left_leg.value)+parseFloat(t.right_leg.value);t.headshots=this.calcHitBoxArea(t.headshots.value,a),t.chest=this.calcHitBoxArea(t.chest.value,a),t.left_arm=this.calcHitBoxArea(t.left_arm.value,a),t.right_arm=this.calcHitBoxArea(t.right_arm.value,a),t.stomach=this.calcHitBoxArea(t.stomach.value,a),t.left_leg=this.calcHitBoxArea(t.left_leg.value,a),t.right_leg=this.calcHitBoxArea(t.right_leg.value,a),i="?hitHead="+t.headshots+"&hitChest="+t.chest+"&hitLeftArm="+t.left_arm+"&hitRightArm="+t.right_arm+"&hitStomach="+t.stomach+"&hitLeftLeg="+t.left_leg+"&hitRightLeg="+t.right_leg+"&"}return e+i},parsePlayerResponse:function(t){this.player=t.player_info,this.player.avatar=this.player.avatar_path,this.createReputationChart("#"+this.component_id+" .pl-stats-reputation",this.player.reputation),this.player["isLevel"+this.player.level]=!0,0!=this.player.subscription.length?this.player.isSubscriber=!0:this.player.isSubscriber=!1},identifySubscriber:function(){this.player&&this.player.subscription&&"Membro Plus"==this.player.subscription.type?this.isPlus=!0:this.isPlus=!1},canCustomize:function(){return this.isSubscriber&&this.current_player_id==this.player_id},openModalSettings:function(){this.canCustomize()?common.modal.abrirModal("modal-estatisticas","/modal/estatisticas","#modal-estatisticas-conteudo",!1):alert("Esta funcionalidade está disponível apenas para assinantes. Conheça os nossos planos!")},openDropDownMenu:function(t,e){var i=$(t+"[data-plID="+e+"]");i.is(":visible")?i.hide():(i.closest(".pl-stats-actions").find(".pl-stats-submenu").hide(),i.show())},createReputationChart:function(t,e){setTimeout(function(){var i=$(t);$(i).radialIndicator({barBgColor:"#1E2033",barColor:{0:"#FF0300",30:"#FF0300",40:"#FF0300",50:"#F1A000",60:"#F1A000",70:"#F1A000",80:"#EBD200",100:"#92AA00"},barWidth:6,initValue:e,radius:12,displayNumber:!1})},350)},createRatingChart:function(t,e,i,a){t&&t.length>0&&setTimeout(function(){skillLevelChartWidget.render(t,e,i,a)},500)},createChart:function(t,e){chartPercent=e/2,color_pallet=chart_colors_ratio_1_2,chartPercent>100&&(color_pallet=chart_colors_ratio_2_3),chartPercent>200&&(color_pallet=chart_colors_ratio_3_4),chartPercent>300&&(color_pallet=chart_colors_ratio_4_5),setTimeout(function(){var e=$(t),i=$(e).data("radialIndicator");if(void 0==i){var a=$(e).data("size");$(e).radialIndicator({barBgColor:"#1E2033",barColor:color_pallet,barWidth:6,initValue:0,radius:a,frameNum:70,frameTime:1,displayNumber:!1}),i=$(e).data("radialIndicator")}i&&i.animate(chartPercent)},350)},facebookShare:function(t){FB.ui({method:"feed",link:APP_BASE_URL+"/estatisticas/"+this.player_id,redirect_uri:APP_BASE_URL+"/jogador/"+this.player_id},function(t){})}}}),Vue.component("animated-integer",{template:"<span>{{ tweeningValue }}</span>",props:{value:{type:String,required:!0}},data:function(){return{tweeningValue:0,ignoreAnimation:!1}},watch:{value:function(t,e){this.tween(e,t)}},mounted:function(){this.ignoreAnimation=null!=this.value&&(this.value.indexOf("%")>0||this.value.indexOf(":")>0||"???"==this.value),this.ignoreAnimation?this.tweeningValue=this.value:this.tween(0,this.value)},methods:{tween:function(t,e){function i(){TWEEN.update()&&requestAnimationFrame(i)}var a=this;new TWEEN.Tween({tweeningValue:t}).to({tweeningValue:e},750).onUpdate(function(){a.tweeningValue=this.tweeningValue.toFixed(0)}).start(),i()}}}),new Vue({el:"#player-stats-widget"});
//# sourceMappingURL=maps/vue.home.stats.min.js.map
